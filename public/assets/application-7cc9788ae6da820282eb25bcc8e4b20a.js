/*!
 * jQuery JavaScript Library v1.9.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2012 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-2-4
 */
function RC4(t){this.s=new Array(256),this.i=0,this.j=0;for(var e=0;256>e;e++)this.s[e]=e;t&&this.mix(t)}function RNG(t){null==t?t=(Math.random()+Date.now()).toString():"function"==typeof t?(this.uniform=t,this.nextByte=function(){return~~(256*this.uniform())},t=null):"[object String]"!==Object.prototype.toString.call(t)&&(t=JSON.stringify(t)),this._normal=null,this._state=t?new RC4(t):null}(function(t,e){function i(t){var e=t.length,i=le.type(t);return le.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function o(t){var e=Ce[t]={};return le.each(t.match(me)||[],function(t,i){e[i]=!0}),e}function n(t,i,o,n){if(le.acceptData(t)){var s,r,a=le.expando,l="string"==typeof i,c=t.nodeType,m=c?le.cache:t,u=c?t[a]:t[a]&&a;if(u&&m[u]&&(n||m[u].data)||!l||o!==e)return u||(c?t[a]=u=Q.pop()||le.guid++:u=a),m[u]||(m[u]={},c||(m[u].toJSON=le.noop)),("object"==typeof i||"function"==typeof i)&&(n?m[u]=le.extend(m[u],i):m[u].data=le.extend(m[u].data,i)),s=m[u],n||(s.data||(s.data={}),s=s.data),o!==e&&(s[le.camelCase(i)]=o),l?(r=s[i],null==r&&(r=s[le.camelCase(i)])):r=s,r}}function s(t,e,i){if(le.acceptData(t)){var o,n,s,r=t.nodeType,l=r?le.cache:t,c=r?t[le.expando]:le.expando;if(l[c]){if(e&&(s=i?l[c]:l[c].data)){le.isArray(e)?e=e.concat(le.map(e,le.camelCase)):e in s?e=[e]:(e=le.camelCase(e),e=e in s?[e]:e.split(" "));for(o=0,n=e.length;n>o;o++)delete s[e[o]];if(!(i?a:le.isEmptyObject)(s))return}(i||(delete l[c].data,a(l[c])))&&(r?le.cleanData([t],!0):le.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}function r(t,i,o){if(o===e&&1===t.nodeType){var n="data-"+i.replace(De,"-$1").toLowerCase();if(o=t.getAttribute(n),"string"==typeof o){try{o="true"===o?!0:"false"===o?!1:"null"===o?null:+o+""===o?+o:Be.test(o)?le.parseJSON(o):o}catch(s){}le.data(t,i,o)}else o=e}return o}function a(t){var e;for(e in t)if(("data"!==e||!le.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function l(){return!0}function c(){return!1}function m(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function u(t,e,i){if(e=e||0,le.isFunction(e))return le.grep(t,function(t,o){var n=!!e.call(t,o,t);return n===i});if(e.nodeType)return le.grep(t,function(t){return t===e===i});if("string"==typeof e){var o=le.grep(t,function(t){return 1===t.nodeType});if(qe.test(e))return le.filter(e,o,!i);e=le.filter(e,o)}return le.grep(t,function(t){return le.inArray(t,e)>=0===i})}function h(t){var e=He.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function p(t,e){return t.getElementsByTagName(e)[0]||t.appendChild(t.ownerDocument.createElement(e))}function _(t){var e=t.getAttributeNode("type");return t.type=(e&&e.specified)+"/"+t.type,t}function y(t){var e=ni.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function f(t,e){for(var i,o=0;null!=(i=t[o]);o++)le._data(i,"globalEval",!e||le._data(e[o],"globalEval"))}function d(t,e){if(1===e.nodeType&&le.hasData(t)){var i,o,n,s=le._data(t),r=le._data(e,s),a=s.events;if(a){delete r.handle,r.events={};for(i in a)for(o=0,n=a[i].length;n>o;o++)le.event.add(e,i,a[i][o])}r.data&&(r.data=le.extend({},r.data))}}function x(t,e){var i,o,n;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!le.support.noCloneEvent&&e[le.expando]){n=le._data(e);for(o in n.events)le.removeEvent(e,o,n.handle);e.removeAttribute(le.expando)}"script"===i&&e.text!==t.text?(_(e).text=t.text,y(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),le.support.html5Clone&&t.innerHTML&&!le.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&ei.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function b(t,i){var o,n,s=0,r=typeof t.getElementsByTagName!==U?t.getElementsByTagName(i||"*"):typeof t.querySelectorAll!==U?t.querySelectorAll(i||"*"):e;if(!r)for(r=[],o=t.childNodes||t;null!=(n=o[s]);s++)!i||le.nodeName(n,i)?r.push(n):le.merge(r,b(n,i));return i===e||i&&le.nodeName(t,i)?le.merge([t],r):r}function g(t){ei.test(t.type)&&(t.defaultChecked=t.checked)}function v(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),o=e,n=Bi.length;n--;)if(e=Bi[n]+i,e in t)return e;return o}function w(t,e){return t=e||t,"none"===le.css(t,"display")||!le.contains(t.ownerDocument,t)}function C(t,e){for(var i,o,n,s=[],r=0,a=t.length;a>r;r++)o=t[r],o.style&&(s[r]=le._data(o,"olddisplay"),i=o.style.display,e?(s[r]||"none"!==i||(o.style.display=""),""===o.style.display&&w(o)&&(s[r]=le._data(o,"olddisplay",A(o.nodeName)))):s[r]||(n=w(o),(i&&"none"!==i||!n)&&le._data(o,"olddisplay",n?i:le.css(o,"display"))));for(r=0;a>r;r++)o=t[r],o.style&&(e&&"none"!==o.style.display&&""!==o.style.display||(o.style.display=e?s[r]||"":"none"));return t}function B(t,e,i){var o=di.exec(e);return o?Math.max(0,o[1]-(i||0))+(o[2]||"px"):e}function D(t,e,i,o,n){for(var s=i===(o?"border":"content")?4:"width"===e?1:0,r=0;4>s;s+=2)"margin"===i&&(r+=le.css(t,i+Ci[s],!0,n)),o?("content"===i&&(r-=le.css(t,"padding"+Ci[s],!0,n)),"margin"!==i&&(r-=le.css(t,"border"+Ci[s]+"Width",!0,n))):(r+=le.css(t,"padding"+Ci[s],!0,n),"padding"!==i&&(r+=le.css(t,"border"+Ci[s]+"Width",!0,n)));return r}function S(t,e,i){var o=!0,n="width"===e?t.offsetWidth:t.offsetHeight,s=mi(t),r=le.support.boxSizing&&"border-box"===le.css(t,"boxSizing",!1,s);if(0>=n||null==n){if(n=ui(t,e,s),(0>n||null==n)&&(n=t.style[e]),xi.test(n))return n;o=r&&(le.support.boxSizingReliable||n===t.style[e]),n=parseFloat(n)||0}return n+D(t,e,i||(r?"border":"content"),o,s)+"px"}function A(t){var e=X,i=gi[t];return i||(i=M(t,e),"none"!==i&&i||(ci=(ci||le("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(ci[0].contentWindow||ci[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),i=M(t,e),ci.detach()),gi[t]=i),i}function M(t,e){var i=le(e.createElement(t)).appendTo(e.body),o=le.css(i[0],"display");return i.remove(),o}function V(t,e,i,o){var n;if(le.isArray(e))le.each(e,function(e,n){i||Si.test(t)?o(t,n):V(t+"["+("object"==typeof n?e:"")+"]",n,i,o)});else if(i||"object"!==le.type(e))o(t,e);else for(n in e)V(t+"["+n+"]",e[n],i,o)}function I(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var o,n=0,s=e.toLowerCase().match(me)||[];if(le.isFunction(i))for(;o=s[n++];)"+"===o[0]?(o=o.slice(1)||"*",(t[o]=t[o]||[]).unshift(i)):(t[o]=t[o]||[]).push(i)}}function T(t,e,i,o){function n(a){var l;return s[a]=!0,le.each(t[a]||[],function(t,a){var c=a(e,i,o);return"string"!=typeof c||r||s[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),n(c),!1)}),l}var s={},r=t===qi;return n(e.dataTypes[0])||!s["*"]&&n("*")}function G(t,i){var o,n,s=le.ajaxSettings.flatOptions||{};for(n in i)i[n]!==e&&((s[n]?t:o||(o={}))[n]=i[n]);return o&&le.extend(!0,t,o),t}function L(t,i,o){var n,s,r,a,l=t.contents,c=t.dataTypes,m=t.responseFields;for(a in m)a in o&&(i[m[a]]=o[a]);for(;"*"===c[0];)c.shift(),s===e&&(s=t.mimeType||i.getResponseHeader("Content-Type"));if(s)for(a in l)if(l[a]&&l[a].test(s)){c.unshift(a);break}if(c[0]in o)r=c[0];else{for(a in o){if(!c[0]||t.converters[a+" "+c[0]]){r=a;break}n||(n=a)}r=r||n}return r?(r!==c[0]&&c.unshift(r),o[r]):void 0}function k(t,e){var i,o,n,s,r={},a=0,l=t.dataTypes.slice(),c=l[0];if(t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l[1])for(n in t.converters)r[n.toLowerCase()]=t.converters[n];for(;o=l[++a];)if("*"!==o){if("*"!==c&&c!==o){if(n=r[c+" "+o]||r["* "+o],!n)for(i in r)if(s=i.split(" "),s[1]===o&&(n=r[c+" "+s[0]]||r["* "+s[0]])){n===!0?n=r[i]:r[i]!==!0&&(o=s[0],l.splice(a--,0,o));break}if(n!==!0)if(n&&t["throws"])e=n(e);else try{e=n(e)}catch(m){return{state:"parsererror",error:n?m:"No conversion from "+c+" to "+o}}}c=o}return{state:"success",data:e}}function F(){try{return new t.XMLHttpRequest}catch(e){}}function R(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function P(){return setTimeout(function(){Zi=e}),Zi=le.now()}function N(t,e){le.each(e,function(e,i){for(var o=(no[e]||[]).concat(no["*"]),n=0,s=o.length;s>n;n++)if(o[n].call(t,e,i))return})}function J(t,e,i){var o,n,s=0,r=oo.length,a=le.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var e=Zi||P(),i=Math.max(0,c.startTime+c.duration-e),o=i/c.duration||0,s=1-o,r=0,l=c.tweens.length;l>r;r++)c.tweens[r].run(s);return a.notifyWith(t,[c,s,i]),1>s&&l?i:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:le.extend({},e),opts:le.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Zi||P(),duration:i.duration,tweens:[],createTween:function(e,i){var o=le.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(o),o},stop:function(e){var i=0,o=e?c.tweens.length:0;if(n)return this;for(n=!0;o>i;i++)c.tweens[i].run(1);return e?a.resolveWith(t,[c,e]):a.rejectWith(t,[c,e]),this}}),m=c.props;for(E(m,c.opts.specialEasing);r>s;s++)if(o=oo[s].call(c,t,m,c.opts))return o;return N(c,m),le.isFunction(c.opts.start)&&c.opts.start.call(t,c),le.fx.timer(le.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function E(t,e){var i,o,n,s,r;for(n in t)if(o=le.camelCase(n),s=e[o],i=t[n],le.isArray(i)&&(s=i[1],i=t[n]=i[0]),n!==o&&(t[o]=i,delete t[n]),r=le.cssHooks[o],r&&"expand"in r){i=r.expand(i),delete t[o];for(n in i)n in t||(t[n]=i[n],e[n]=s)}else e[o]=s}function j(t,e,i){var o,n,s,r,a,l,c,m,u,h=this,p=t.style,_={},y=[],f=t.nodeType&&w(t);i.queue||(m=le._queueHooks(t,"fx"),null==m.unqueued&&(m.unqueued=0,u=m.empty.fire,m.empty.fire=function(){m.unqueued||u()}),m.unqueued++,h.always(function(){h.always(function(){m.unqueued--,le.queue(t,"fx").length||m.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===le.css(t,"display")&&"none"===le.css(t,"float")&&(le.support.inlineBlockNeedsLayout&&"inline"!==A(t.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",le.support.shrinkWrapBlocks||h.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],to.exec(r)){if(delete e[n],l=l||"toggle"===r,r===(f?"hide":"show"))continue;y.push(n)}if(s=y.length){a=le._data(t,"fxshow")||le._data(t,"fxshow",{}),"hidden"in a&&(f=a.hidden),l&&(a.hidden=!f),f?le(t).show():h.done(function(){le(t).hide()}),h.done(function(){var e;le._removeData(t,"fxshow");for(e in _)le.style(t,e,_[e])});for(n=0;s>n;n++)o=y[n],c=h.createTween(o,f?a[o]:0),_[o]=a[o]||le.style(t,o),o in a||(a[o]=c.start,f&&(c.end=c.start,c.start="width"===o||"height"===o?1:0))}}function z(t,e,i,o,n){return new z.prototype.init(t,e,i,o,n)}function q(t,e){var i,o={height:t},n=0;for(e=e?1:0;4>n;n+=2-e)i=Ci[n],o["margin"+i]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function O(t){return le.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var W,H,U=typeof e,X=t.document,K=t.location,$=t.jQuery,Y=t.$,Z={},Q=[],te="1.9.1",ee=Q.concat,ie=Q.push,oe=Q.slice,ne=Q.indexOf,se=Z.toString,re=Z.hasOwnProperty,ae=te.trim,le=function(t,e){return new le.fn.init(t,e,H)},ce=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,me=/\S+/g,ue=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,he=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,pe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,_e=/^[\],:{}\s]*$/,ye=/(?:^|:|,)(?:\s*\[)+/g,fe=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,de=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,xe=/^-ms-/,be=/-([\da-z])/gi,ge=function(t,e){return e.toUpperCase()},ve=function(t){(X.addEventListener||"load"===t.type||"complete"===X.readyState)&&(we(),le.ready())},we=function(){X.addEventListener?(X.removeEventListener("DOMContentLoaded",ve,!1),t.removeEventListener("load",ve,!1)):(X.detachEvent("onreadystatechange",ve),t.detachEvent("onload",ve))};le.fn=le.prototype={jquery:te,constructor:le,init:function(t,i,o){var n,s;if(!t)return this;if("string"==typeof t){if(n="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:he.exec(t),!n||!n[1]&&i)return!i||i.jquery?(i||o).find(t):this.constructor(i).find(t);if(n[1]){if(i=i instanceof le?i[0]:i,le.merge(this,le.parseHTML(n[1],i&&i.nodeType?i.ownerDocument||i:X,!0)),pe.test(n[1])&&le.isPlainObject(i))for(n in i)le.isFunction(this[n])?this[n](i[n]):this.attr(n,i[n]);return this}if(s=X.getElementById(n[2]),s&&s.parentNode){if(s.id!==n[2])return o.find(t);this.length=1,this[0]=s}return this.context=X,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):le.isFunction(t)?o.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),le.makeArray(t,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return oe.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=le.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return le.each(this,t,e)},ready:function(t){return le.ready.promise().done(t),this},slice:function(){return this.pushStack(oe.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(le.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:ie,sort:[].sort,splice:[].splice},le.fn.init.prototype=le.fn,le.extend=le.fn.extend=function(){var t,i,o,n,s,r,a=arguments[0]||{},l=1,c=arguments.length,m=!1;for("boolean"==typeof a&&(m=a,a=arguments[1]||{},l=2),"object"==typeof a||le.isFunction(a)||(a={}),c===l&&(a=this,--l);c>l;l++)if(null!=(s=arguments[l]))for(n in s)t=a[n],o=s[n],a!==o&&(m&&o&&(le.isPlainObject(o)||(i=le.isArray(o)))?(i?(i=!1,r=t&&le.isArray(t)?t:[]):r=t&&le.isPlainObject(t)?t:{},a[n]=le.extend(m,r,o)):o!==e&&(a[n]=o));return a},le.extend({noConflict:function(e){return t.$===le&&(t.$=Y),e&&t.jQuery===le&&(t.jQuery=$),le},isReady:!1,readyWait:1,holdReady:function(t){t?le.readyWait++:le.ready(!0)},ready:function(t){if(t===!0?!--le.readyWait:!le.isReady){if(!X.body)return setTimeout(le.ready);le.isReady=!0,t!==!0&&--le.readyWait>0||(W.resolveWith(X,[le]),le.fn.trigger&&le(X).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===le.type(t)},isArray:Array.isArray||function(t){return"array"===le.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Z[se.call(t)]||"object":typeof t},isPlainObject:function(t){if(!t||"object"!==le.type(t)||t.nodeType||le.isWindow(t))return!1;try{if(t.constructor&&!re.call(t,"constructor")&&!re.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var o;for(o in t);return o===e||re.call(t,o)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||X;var o=pe.exec(t),n=!i&&[];return o?[e.createElement(o[1])]:(o=le.buildFragment([t],e,n),n&&le(n).remove(),le.merge([],o.childNodes))},parseJSON:function(e){return t.JSON&&t.JSON.parse?t.JSON.parse(e):null===e?e:"string"==typeof e&&(e=le.trim(e),e&&_e.test(e.replace(fe,"@").replace(de,"]").replace(ye,"")))?new Function("return "+e)():(le.error("Invalid JSON: "+e),void 0)},parseXML:function(i){var o,n;if(!i||"string"!=typeof i)return null;try{t.DOMParser?(n=new DOMParser,o=n.parseFromString(i,"text/xml")):(o=new ActiveXObject("Microsoft.XMLDOM"),o.async="false",o.loadXML(i))}catch(s){o=e}return o&&o.documentElement&&!o.getElementsByTagName("parsererror").length||le.error("Invalid XML: "+i),o},noop:function(){},globalEval:function(e){e&&le.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(xe,"ms-").replace(be,ge)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,o){var n,s=0,r=t.length,a=i(t);if(o){if(a)for(;r>s&&(n=e.apply(t[s],o),n!==!1);s++);else for(s in t)if(n=e.apply(t[s],o),n===!1)break}else if(a)for(;r>s&&(n=e.call(t[s],s,t[s]),n!==!1);s++);else for(s in t)if(n=e.call(t[s],s,t[s]),n===!1)break;return t},trim:ae&&!ae.call("﻿ ")?function(t){return null==t?"":ae.call(t)}:function(t){return null==t?"":(t+"").replace(ue,"")},makeArray:function(t,e){var o=e||[];return null!=t&&(i(Object(t))?le.merge(o,"string"==typeof t?[t]:t):ie.call(o,t)),o},inArray:function(t,e,i){var o;if(e){if(ne)return ne.call(e,t,i);for(o=e.length,i=i?0>i?Math.max(0,o+i):i:0;o>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,i){var o=i.length,n=t.length,s=0;if("number"==typeof o)for(;o>s;s++)t[n++]=i[s];else for(;i[s]!==e;)t[n++]=i[s++];return t.length=n,t},grep:function(t,e,i){var o,n=[],s=0,r=t.length;for(i=!!i;r>s;s++)o=!!e(t[s],s),i!==o&&n.push(t[s]);return n},map:function(t,e,o){var n,s=0,r=t.length,a=i(t),l=[];if(a)for(;r>s;s++)n=e(t[s],s,o),null!=n&&(l[l.length]=n);else for(s in t)n=e(t[s],s,o),null!=n&&(l[l.length]=n);return ee.apply([],l)},guid:1,proxy:function(t,i){var o,n,s;return"string"==typeof i&&(s=t[i],i=t,t=s),le.isFunction(t)?(o=oe.call(arguments,2),n=function(){return t.apply(i||this,o.concat(oe.call(arguments)))},n.guid=t.guid=t.guid||le.guid++,n):e},access:function(t,i,o,n,s,r,a){var l=0,c=t.length,m=null==o;if("object"===le.type(o)){s=!0;for(l in o)le.access(t,i,l,o[l],!0,r,a)}else if(n!==e&&(s=!0,le.isFunction(n)||(a=!0),m&&(a?(i.call(t,n),i=null):(m=i,i=function(t,e,i){return m.call(le(t),i)})),i))for(;c>l;l++)i(t[l],o,a?n:n.call(t[l],l,i(t[l],o)));return s?t:m?i.call(t):c?i(t[0],o):r},now:function(){return(new Date).getTime()}}),le.ready.promise=function(e){if(!W)if(W=le.Deferred(),"complete"===X.readyState)setTimeout(le.ready);else if(X.addEventListener)X.addEventListener("DOMContentLoaded",ve,!1),t.addEventListener("load",ve,!1);else{X.attachEvent("onreadystatechange",ve),t.attachEvent("onload",ve);var i=!1;try{i=null==t.frameElement&&X.documentElement}catch(o){}i&&i.doScroll&&function n(){if(!le.isReady){try{i.doScroll("left")}catch(t){return setTimeout(n,50)}we(),le.ready()}}()}return W.promise(e)},le.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Z["[object "+e+"]"]=e.toLowerCase()}),H=le(X);var Ce={};le.Callbacks=function(t){t="string"==typeof t?Ce[t]||o(t):le.extend({},t);var i,n,s,r,a,l,c=[],m=!t.once&&[],u=function(e){for(n=t.memory&&e,s=!0,a=l||0,l=0,r=c.length,i=!0;c&&r>a;a++)if(c[a].apply(e[0],e[1])===!1&&t.stopOnFalse){n=!1;break}i=!1,c&&(m?m.length&&u(m.shift()):n?c=[]:h.disable())},h={add:function(){if(c){var e=c.length;(function o(e){le.each(e,function(e,i){var n=le.type(i);"function"===n?t.unique&&h.has(i)||c.push(i):i&&i.length&&"string"!==n&&o(i)})})(arguments),i?r=c.length:n&&(l=e,u(n))}return this},remove:function(){return c&&le.each(arguments,function(t,e){for(var o;(o=le.inArray(e,c,o))>-1;)c.splice(o,1),i&&(r>=o&&r--,a>=o&&a--)}),this},has:function(t){return t?le.inArray(t,c)>-1:!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=m=n=e,this},disabled:function(){return!c},lock:function(){return m=e,n||h.disable(),this},locked:function(){return!m},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!c||s&&!m||(i?m.push(e):u(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!s}};return h},le.extend({Deferred:function(t){var e=[["resolve","done",le.Callbacks("once memory"),"resolved"],["reject","fail",le.Callbacks("once memory"),"rejected"],["notify","progress",le.Callbacks("memory")]],i="pending",o={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var t=arguments;return le.Deferred(function(i){le.each(e,function(e,s){var r=s[0],a=le.isFunction(t[e])&&t[e];n[s[1]](function(){var t=a&&a.apply(this,arguments);t&&le.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r+"With"](this===o?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?le.extend(t,o):o}},n={};return o.pipe=o.then,le.each(e,function(t,s){var r=s[2],a=s[3];o[s[1]]=r.add,a&&r.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),n[s[0]]=function(){return n[s[0]+"With"](this===n?o:this,arguments),this},n[s[0]+"With"]=r.fireWith}),o.promise(n),t&&t.call(n,n),n},when:function(t){var e,i,o,n=0,s=oe.call(arguments),r=s.length,a=1!==r||t&&le.isFunction(t.promise)?r:0,l=1===a?t:le.Deferred(),c=function(t,i,o){return function(n){i[t]=this,o[t]=arguments.length>1?oe.call(arguments):n,o===e?l.notifyWith(i,o):--a||l.resolveWith(i,o)}};if(r>1)for(e=new Array(r),i=new Array(r),o=new Array(r);r>n;n++)s[n]&&le.isFunction(s[n].promise)?s[n].promise().done(c(n,o,s)).fail(l.reject).progress(c(n,i,e)):--a;return a||l.resolveWith(o,s),l.promise()}}),le.support=function(){var e,i,o,n,s,r,a,l,c,m,u=X.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=u.getElementsByTagName("*"),o=u.getElementsByTagName("a")[0],!i||!o||!i.length)return{};s=X.createElement("select"),a=s.appendChild(X.createElement("option")),n=u.getElementsByTagName("input")[0],o.style.cssText="top:1px;float:left;opacity:.5",e={getSetAttribute:"t"!==u.className,leadingWhitespace:3===u.firstChild.nodeType,tbody:!u.getElementsByTagName("tbody").length,htmlSerialize:!!u.getElementsByTagName("link").length,style:/top/.test(o.getAttribute("style")),hrefNormalized:"/a"===o.getAttribute("href"),opacity:/^0.5/.test(o.style.opacity),cssFloat:!!o.style.cssFloat,checkOn:!!n.value,optSelected:a.selected,enctype:!!X.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==X.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===X.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},n.checked=!0,e.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,e.optDisabled=!a.disabled;try{delete u.test}catch(h){e.deleteExpando=!1}n=X.createElement("input"),n.setAttribute("value",""),e.input=""===n.getAttribute("value"),n.value="t",n.setAttribute("type","radio"),e.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r=X.createDocumentFragment(),r.appendChild(n),e.appendChecked=n.checked,e.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){e.noCloneEvent=!1}),u.cloneNode(!0).click());for(m in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+m,"t"),e[m+"Bubbles"]=l in t||u.attributes[l].expando===!1;return u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===u.style.backgroundClip,le(function(){var i,o,n,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",r=X.getElementsByTagName("body")[0];r&&(i=X.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",r.appendChild(i).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=u.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",e.reliableHiddenOffsets=c&&0===n[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",e.boxSizing=4===u.offsetWidth,e.doesNotIncludeMarginInBodyOffset=1!==r.offsetTop,t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(u,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(u,null)||{width:"4px"}).width,o=u.appendChild(X.createElement("div")),o.style.cssText=u.style.cssText=s,o.style.marginRight=o.style.width="0",u.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(o,null)||{}).marginRight)),typeof u.style.zoom!==U&&(u.innerHTML="",u.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==u.offsetWidth,e.inlineBlockNeedsLayout&&(r.style.zoom=1)),r.removeChild(i),i=u=n=o=null)}),i=s=r=a=o=n=null,e}();var Be=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,De=/([A-Z])/g;le.extend({cache:{},expando:"jQuery"+(te+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?le.cache[t[le.expando]]:t[le.expando],!!t&&!a(t)},data:function(t,e,i){return n(t,e,i)},removeData:function(t,e){return s(t,e)},_data:function(t,e,i){return n(t,e,i,!0)},_removeData:function(t,e){return s(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&le.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),le.fn.extend({data:function(t,i){var o,n,s=this[0],a=0,l=null;if(t===e){if(this.length&&(l=le.data(s),1===s.nodeType&&!le._data(s,"parsedAttrs"))){for(o=s.attributes;o.length>a;a++)n=o[a].name,n.indexOf("data-")||(n=le.camelCase(n.slice(5)),r(s,n,l[n]));le._data(s,"parsedAttrs",!0)}return l}return"object"==typeof t?this.each(function(){le.data(this,t)}):le.access(this,function(i){return i===e?s?r(s,t,le.data(s,t)):null:(this.each(function(){le.data(this,t,i)}),void 0)},null,i,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){le.removeData(this,t)})}}),le.extend({queue:function(t,e,i){var o;return t?(e=(e||"fx")+"queue",o=le._data(t,e),i&&(!o||le.isArray(i)?o=le._data(t,e,le.makeArray(i)):o.push(i)),o||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=le.queue(t,e),o=i.length,n=i.shift(),s=le._queueHooks(t,e),r=function(){le.dequeue(t,e)};"inprogress"===n&&(n=i.shift(),o--),s.cur=n,n&&("fx"===e&&i.unshift("inprogress"),delete s.stop,n.call(t,r,s)),!o&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return le._data(t,i)||le._data(t,i,{empty:le.Callbacks("once memory").add(function(){le._removeData(t,e+"queue"),le._removeData(t,i)})})}}),le.fn.extend({queue:function(t,i){var o=2;return"string"!=typeof t&&(i=t,t="fx",o--),o>arguments.length?le.queue(this[0],t):i===e?this:this.each(function(){var e=le.queue(this,t,i);le._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&le.dequeue(this,t)})},dequeue:function(t){return this.each(function(){le.dequeue(this,t)})},delay:function(t,e){return t=le.fx?le.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var o=setTimeout(e,t);i.stop=function(){clearTimeout(o)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var o,n=1,s=le.Deferred(),r=this,a=this.length,l=function(){--n||s.resolveWith(r,[r])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";a--;)o=le._data(r[a],t+"queueHooks"),o&&o.empty&&(n++,o.empty.add(l));return l(),s.promise(i)}});var Se,Ae,Me=/[\t\r\n]/g,Ve=/\r/g,Ie=/^(?:input|select|textarea|button|object)$/i,Te=/^(?:a|area)$/i,Ge=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Le=/^(?:checked|selected)$/i,ke=le.support.getSetAttribute,Fe=le.support.input;le.fn.extend({attr:function(t,e){return le.access(this,le.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){le.removeAttr(this,t)})},prop:function(t,e){return le.access(this,le.prop,t,e,arguments.length>1)},removeProp:function(t){return t=le.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(i){}})},addClass:function(t){var e,i,o,n,s,r=0,a=this.length,l="string"==typeof t&&t;if(le.isFunction(t))return this.each(function(e){le(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(me)||[];a>r;r++)if(i=this[r],o=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Me," "):" ")){for(s=0;n=e[s++];)0>o.indexOf(" "+n+" ")&&(o+=n+" ");i.className=le.trim(o)}return this},removeClass:function(t){var e,i,o,n,s,r=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(le.isFunction(t))return this.each(function(e){le(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(me)||[];a>r;r++)if(i=this[r],o=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Me," "):"")){for(s=0;n=e[s++];)for(;o.indexOf(" "+n+" ")>=0;)o=o.replace(" "+n+" "," ");i.className=t?le.trim(o):""}return this},toggleClass:function(t,e){var i=typeof t,o="boolean"==typeof e;return le.isFunction(t)?this.each(function(i){le(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var n,s=0,r=le(this),a=e,l=t.match(me)||[];n=l[s++];)a=o?a:!r.hasClass(n),r[a?"addClass":"removeClass"](n);else(i===U||"boolean"===i)&&(this.className&&le._data(this,"__className__",this.className),this.className=this.className||t===!1?"":le._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,o=this.length;o>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Me," ").indexOf(e)>=0)return!0;return!1},val:function(t){var i,o,n,s=this[0];{if(arguments.length)return n=le.isFunction(t),this.each(function(i){var s,r=le(this);1===this.nodeType&&(s=n?t.call(this,i,r.val()):t,null==s?s="":"number"==typeof s?s+="":le.isArray(s)&&(s=le.map(s,function(t){return null==t?"":t+""})),o=le.valHooks[this.type]||le.valHooks[this.nodeName.toLowerCase()],o&&"set"in o&&o.set(this,s,"value")!==e||(this.value=s))});if(s)return o=le.valHooks[s.type]||le.valHooks[s.nodeName.toLowerCase()],o&&"get"in o&&(i=o.get(s,"value"))!==e?i:(i=s.value,"string"==typeof i?i.replace(Ve,""):null==i?"":i)}}}),le.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,i,o=t.options,n=t.selectedIndex,s="select-one"===t.type||0>n,r=s?null:[],a=s?n+1:o.length,l=0>n?a:s?n:0;a>l;l++)if(i=o[l],!(!i.selected&&l!==n||(le.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&le.nodeName(i.parentNode,"optgroup"))){if(e=le(i).val(),s)return e;r.push(e)}return r},set:function(t,e){var i=le.makeArray(e);return le(t).find("option").each(function(){this.selected=le.inArray(le(this).val(),i)>=0}),i.length||(t.selectedIndex=-1),i}}},attr:function(t,i,o){var n,s,r,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===U?le.prop(t,i,o):(s=1!==a||!le.isXMLDoc(t),s&&(i=i.toLowerCase(),n=le.attrHooks[i]||(Ge.test(i)?Ae:Se)),o===e?n&&s&&"get"in n&&null!==(r=n.get(t,i))?r:(typeof t.getAttribute!==U&&(r=t.getAttribute(i)),null==r?e:r):null!==o?n&&s&&"set"in n&&(r=n.set(t,o,i))!==e?r:(t.setAttribute(i,o+""),o):(le.removeAttr(t,i),void 0))},removeAttr:function(t,e){var i,o,n=0,s=e&&e.match(me);if(s&&1===t.nodeType)for(;i=s[n++];)o=le.propFix[i]||i,Ge.test(i)?!ke&&Le.test(i)?t[le.camelCase("default-"+i)]=t[o]=!1:t[o]=!1:le.attr(t,i,""),t.removeAttribute(ke?i:o)},attrHooks:{type:{set:function(t,e){if(!le.support.radioValue&&"radio"===e&&le.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,i,o){var n,s,r,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return r=1!==a||!le.isXMLDoc(t),r&&(i=le.propFix[i]||i,s=le.propHooks[i]),o!==e?s&&"set"in s&&(n=s.set(t,o,i))!==e?n:t[i]=o:s&&"get"in s&&null!==(n=s.get(t,i))?n:t[i]},propHooks:{tabIndex:{get:function(t){var i=t.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):Ie.test(t.nodeName)||Te.test(t.nodeName)&&t.href?0:e}}}}),Ae={get:function(t,i){var o=le.prop(t,i),n="boolean"==typeof o&&t.getAttribute(i),s="boolean"==typeof o?Fe&&ke?null!=n:Le.test(i)?t[le.camelCase("default-"+i)]:!!n:t.getAttributeNode(i);return s&&s.value!==!1?i.toLowerCase():e},set:function(t,e,i){return e===!1?le.removeAttr(t,i):Fe&&ke||!Le.test(i)?t.setAttribute(!ke&&le.propFix[i]||i,i):t[le.camelCase("default-"+i)]=t[i]=!0,i}},Fe&&ke||(le.attrHooks.value={get:function(t,i){var o=t.getAttributeNode(i);return le.nodeName(t,"input")?t.defaultValue:o&&o.specified?o.value:e},set:function(t,e,i){return le.nodeName(t,"input")?(t.defaultValue=e,void 0):Se&&Se.set(t,e,i)
}}),ke||(Se=le.valHooks.button={get:function(t,i){var o=t.getAttributeNode(i);return o&&("id"===i||"name"===i||"coords"===i?""!==o.value:o.specified)?o.value:e},set:function(t,i,o){var n=t.getAttributeNode(o);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(o)),n.value=i+="","value"===o||i===t.getAttribute(o)?i:e}},le.attrHooks.contenteditable={get:Se.get,set:function(t,e,i){Se.set(t,""===e?!1:e,i)}},le.each(["width","height"],function(t,e){le.attrHooks[e]=le.extend(le.attrHooks[e],{set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}})})),le.support.hrefNormalized||(le.each(["href","src","width","height"],function(t,i){le.attrHooks[i]=le.extend(le.attrHooks[i],{get:function(t){var o=t.getAttribute(i,2);return null==o?e:o}})}),le.each(["href","src"],function(t,e){le.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}})),le.support.style||(le.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),le.support.optSelected||(le.propHooks.selected=le.extend(le.propHooks.selected,{get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),le.support.enctype||(le.propFix.enctype="encoding"),le.support.checkOn||le.each(["radio","checkbox"],function(){le.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),le.each(["radio","checkbox"],function(){le.valHooks[this]=le.extend(le.valHooks[this],{set:function(t,e){return le.isArray(e)?t.checked=le.inArray(le(t).val(),e)>=0:void 0}})});var Re=/^(?:input|select|textarea)$/i,Pe=/^key/,Ne=/^(?:mouse|contextmenu)|click/,Je=/^(?:focusinfocus|focusoutblur)$/,Ee=/^([^.]*)(?:\.(.+)|)$/;le.event={global:{},add:function(t,i,o,n,s){var r,a,l,c,m,u,h,p,_,y,f,d=le._data(t);if(d){for(o.handler&&(c=o,o=c.handler,s=c.selector),o.guid||(o.guid=le.guid++),(a=d.events)||(a=d.events={}),(u=d.handle)||(u=d.handle=function(t){return typeof le===U||t&&le.event.triggered===t.type?e:le.event.dispatch.apply(u.elem,arguments)},u.elem=t),i=(i||"").match(me)||[""],l=i.length;l--;)r=Ee.exec(i[l])||[],_=f=r[1],y=(r[2]||"").split(".").sort(),m=le.event.special[_]||{},_=(s?m.delegateType:m.bindType)||_,m=le.event.special[_]||{},h=le.extend({type:_,origType:f,data:n,handler:o,guid:o.guid,selector:s,needsContext:s&&le.expr.match.needsContext.test(s),namespace:y.join(".")},c),(p=a[_])||(p=a[_]=[],p.delegateCount=0,m.setup&&m.setup.call(t,n,y,u)!==!1||(t.addEventListener?t.addEventListener(_,u,!1):t.attachEvent&&t.attachEvent("on"+_,u))),m.add&&(m.add.call(t,h),h.handler.guid||(h.handler.guid=o.guid)),s?p.splice(p.delegateCount++,0,h):p.push(h),le.event.global[_]=!0;t=null}},remove:function(t,e,i,o,n){var s,r,a,l,c,m,u,h,p,_,y,f=le.hasData(t)&&le._data(t);if(f&&(m=f.events)){for(e=(e||"").match(me)||[""],c=e.length;c--;)if(a=Ee.exec(e[c])||[],p=y=a[1],_=(a[2]||"").split(".").sort(),p){for(u=le.event.special[p]||{},p=(o?u.delegateType:u.bindType)||p,h=m[p]||[],a=a[2]&&new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=h.length;s--;)r=h[s],!n&&y!==r.origType||i&&i.guid!==r.guid||a&&!a.test(r.namespace)||o&&o!==r.selector&&("**"!==o||!r.selector)||(h.splice(s,1),r.selector&&h.delegateCount--,u.remove&&u.remove.call(t,r));l&&!h.length&&(u.teardown&&u.teardown.call(t,_,f.handle)!==!1||le.removeEvent(t,p,f.handle),delete m[p])}else for(p in m)le.event.remove(t,p+e[c],i,o,!0);le.isEmptyObject(m)&&(delete f.handle,le._removeData(t,"events"))}},trigger:function(i,o,n,s){var r,a,l,c,m,u,h,p=[n||X],_=re.call(i,"type")?i.type:i,y=re.call(i,"namespace")?i.namespace.split("."):[];if(l=u=n=n||X,3!==n.nodeType&&8!==n.nodeType&&!Je.test(_+le.event.triggered)&&(_.indexOf(".")>=0&&(y=_.split("."),_=y.shift(),y.sort()),a=0>_.indexOf(":")&&"on"+_,i=i[le.expando]?i:new le.Event(_,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=y.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=n),o=null==o?[i]:le.makeArray(o,[i]),m=le.event.special[_]||{},s||!m.trigger||m.trigger.apply(n,o)!==!1)){if(!s&&!m.noBubble&&!le.isWindow(n)){for(c=m.delegateType||_,Je.test(c+_)||(l=l.parentNode);l;l=l.parentNode)p.push(l),u=l;u===(n.ownerDocument||X)&&p.push(u.defaultView||u.parentWindow||t)}for(h=0;(l=p[h++])&&!i.isPropagationStopped();)i.type=h>1?c:m.bindType||_,r=(le._data(l,"events")||{})[i.type]&&le._data(l,"handle"),r&&r.apply(l,o),r=a&&l[a],r&&le.acceptData(l)&&r.apply&&r.apply(l,o)===!1&&i.preventDefault();if(i.type=_,!(s||i.isDefaultPrevented()||m._default&&m._default.apply(n.ownerDocument,o)!==!1||"click"===_&&le.nodeName(n,"a")||!le.acceptData(n)||!a||!n[_]||le.isWindow(n))){u=n[a],u&&(n[a]=null),le.event.triggered=_;try{n[_]()}catch(f){}le.event.triggered=e,u&&(n[a]=u)}return i.result}},dispatch:function(t){t=le.event.fix(t);var i,o,n,s,r,a=[],l=oe.call(arguments),c=(le._data(this,"events")||{})[t.type]||[],m=le.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!m.preDispatch||m.preDispatch.call(this,t)!==!1){for(a=le.event.handlers.call(this,t,c),i=0;(s=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,r=0;(n=s.handlers[r++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(n.namespace))&&(t.handleObj=n,t.data=n.data,o=((le.event.special[n.origType]||{}).handle||n.handler).apply(s.elem,l),o!==e&&(t.result=o)===!1&&(t.preventDefault(),t.stopPropagation()));return m.postDispatch&&m.postDispatch.call(this,t),t.result}},handlers:function(t,i){var o,n,s,r,a=[],l=i.delegateCount,c=t.target;if(l&&c.nodeType&&(!t.button||"click"!==t.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==t.type)){for(s=[],r=0;l>r;r++)n=i[r],o=n.selector+" ",s[o]===e&&(s[o]=n.needsContext?le(o,this).index(c)>=0:le.find(o,this,null,[c]).length),s[o]&&s.push(n);s.length&&a.push({elem:c,handlers:s})}return i.length>l&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(t){if(t[le.expando])return t;var e,i,o,n=t.type,s=t,r=this.fixHooks[n];for(r||(this.fixHooks[n]=r=Ne.test(n)?this.mouseHooks:Pe.test(n)?this.keyHooks:{}),o=r.props?this.props.concat(r.props):this.props,t=new le.Event(s),e=o.length;e--;)i=o[e],t[i]=s[i];return t.target||(t.target=s.srcElement||X),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,r.filter?r.filter(t,s):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var o,n,s,r=i.button,a=i.fromElement;return null==t.pageX&&null!=i.clientX&&(n=t.target.ownerDocument||X,s=n.documentElement,o=n.body,t.pageX=i.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),t.pageY=i.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?i.toElement:a),t.which||r===e||(t.which=1&r?1:2&r?3:4&r?2:0),t}},special:{load:{noBubble:!0},click:{trigger:function(){return le.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0}},focus:{trigger:function(){if(this!==X.activeElement&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===X.activeElement&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,o){var n=le.extend(new le.Event,i,{type:t,isSimulated:!0,originalEvent:{}});o?le.event.trigger(n,null,e):le.event.dispatch.call(e,n),n.isDefaultPrevented()&&i.preventDefault()}},le.removeEvent=X.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var o="on"+e;t.detachEvent&&(typeof t[o]===U&&(t[o]=null),t.detachEvent(o,i))},le.Event=function(t,e){return this instanceof le.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?l:c):this.type=t,e&&le.extend(this,e),this.timeStamp=t&&t.timeStamp||le.now(),this[le.expando]=!0,void 0):new le.Event(t,e)},le.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},le.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){le.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,o=this,n=t.relatedTarget,s=t.handleObj;return(!n||n!==o&&!le.contains(o,n))&&(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}}),le.support.submitBubbles||(le.event.special.submit={setup:function(){return le.nodeName(this,"form")?!1:(le.event.add(this,"click._submit keypress._submit",function(t){var i=t.target,o=le.nodeName(i,"input")||le.nodeName(i,"button")?i.form:e;o&&!le._data(o,"submitBubbles")&&(le.event.add(o,"submit._submit",function(t){t._submit_bubble=!0}),le._data(o,"submitBubbles",!0))}),void 0)},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&le.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return le.nodeName(this,"form")?!1:(le.event.remove(this,"._submit"),void 0)}}),le.support.changeBubbles||(le.event.special.change={setup:function(){return Re.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(le.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),le.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),le.event.simulate("change",this,t,!0)})),!1):(le.event.add(this,"beforeactivate._change",function(t){var e=t.target;Re.test(e.nodeName)&&!le._data(e,"changeBubbles")&&(le.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||le.event.simulate("change",this.parentNode,t,!0)}),le._data(e,"changeBubbles",!0))}),void 0)},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return le.event.remove(this,"._change"),!Re.test(this.nodeName)}}),le.support.focusinBubbles||le.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,o=function(t){le.event.simulate(e,t.target,le.event.fix(t),!0)};le.event.special[e]={setup:function(){0===i++&&X.addEventListener(t,o,!0)},teardown:function(){0===--i&&X.removeEventListener(t,o,!0)}}}),le.fn.extend({on:function(t,i,o,n,s){var r,a;if("object"==typeof t){"string"!=typeof i&&(o=o||i,i=e);for(r in t)this.on(r,i,o,t[r],s);return this}if(null==o&&null==n?(n=i,o=i=e):null==n&&("string"==typeof i?(n=o,o=e):(n=o,o=i,i=e)),n===!1)n=c;else if(!n)return this;return 1===s&&(a=n,n=function(t){return le().off(t),a.apply(this,arguments)},n.guid=a.guid||(a.guid=le.guid++)),this.each(function(){le.event.add(this,t,n,o,i)})},one:function(t,e,i,o){return this.on(t,e,i,o,1)},off:function(t,i,o){var n,s;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,le(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(s in t)this.off(s,i,t[s]);return this}return(i===!1||"function"==typeof i)&&(o=i,i=e),o===!1&&(o=c),this.each(function(){le.event.remove(this,t,o,i)})},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,o){return this.on(e,t,i,o)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},trigger:function(t,e){return this.each(function(){le.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?le.event.trigger(t,e,i,!0):void 0}}),/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */
function(t,e){function i(t){return _e.test(t+"")}function o(){var t,e=[];return t=function(i,o){return e.push(i+=" ")>B.cacheLength&&delete t[e.shift()],t[i]=o}}function n(t){return t[J]=!0,t}function s(t){var e=T.createElement("div");try{return t(e)}catch(i){return!1}finally{e=null}}function r(t,e,i,o){var n,s,r,a,l,c,m,p,_,y;if((e?e.ownerDocument||e:E)!==T&&I(e),e=e||T,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(!L&&!o){if(n=ye.exec(t))if(r=n[1]){if(9===a){if(s=e.getElementById(r),!s||!s.parentNode)return i;if(s.id===r)return i.push(s),i}else if(e.ownerDocument&&(s=e.ownerDocument.getElementById(r))&&P(e,s)&&s.id===r)return i.push(s),i}else{if(n[2])return Y.apply(i,Z.call(e.getElementsByTagName(t),0)),i;if((r=n[3])&&j.getByClassName&&e.getElementsByClassName)return Y.apply(i,Z.call(e.getElementsByClassName(r),0)),i}if(j.qsa&&!k.test(t)){if(m=!0,p=J,_=e,y=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(c=u(t),(m=e.getAttribute("id"))?p=m.replace(xe,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+h(c[l]);_=pe.test(t)&&e.parentNode||e,y=c.join(",")}if(y)try{return Y.apply(i,Z.call(_.querySelectorAll(y),0)),i}catch(f){}finally{m||e.removeAttribute("id")}}}return g(t.replace(re,"$1"),e,i,o)}function a(t,e){var i=e&&t,o=i&&(~e.sourceIndex||X)-(~t.sourceIndex||X);if(o)return o;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function l(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function c(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function m(t){return n(function(e){return e=+e,n(function(i,o){for(var n,s=t([],i.length,e),r=s.length;r--;)i[n=s[r]]&&(i[n]=!(o[n]=i[n]))})})}function u(t,e){var i,o,n,s,a,l,c,m=W[t+" "];if(m)return e?0:m.slice(0);for(a=t,l=[],c=B.preFilter;a;){(!i||(o=ae.exec(a)))&&(o&&(a=a.slice(o[0].length)||a),l.push(n=[])),i=!1,(o=ce.exec(a))&&(i=o.shift(),n.push({value:i,type:o[0].replace(re," ")}),a=a.slice(i.length));for(s in B.filter)!(o=he[s].exec(a))||c[s]&&!(o=c[s](o))||(i=o.shift(),n.push({value:i,type:s,matches:o}),a=a.slice(i.length));if(!i)break}return e?a.length:a?r.error(t):W(t,l).slice(0)}function h(t){for(var e=0,i=t.length,o="";i>e;e++)o+=t[e].value;return o}function p(t,e,i){var o=e.dir,n=i&&"parentNode"===o,s=q++;return e.first?function(e,i,s){for(;e=e[o];)if(1===e.nodeType||n)return t(e,i,s)}:function(e,i,r){var a,l,c,m=z+" "+s;if(r){for(;e=e[o];)if((1===e.nodeType||n)&&t(e,i,r))return!0}else for(;e=e[o];)if(1===e.nodeType||n)if(c=e[J]||(e[J]={}),(l=c[o])&&l[0]===m){if((a=l[1])===!0||a===C)return a===!0}else if(l=c[o]=[m],l[1]=t(e,i,r)||C,l[1]===!0)return!0}}function _(t){return t.length>1?function(e,i,o){for(var n=t.length;n--;)if(!t[n](e,i,o))return!1;return!0}:t[0]}function y(t,e,i,o,n){for(var s,r=[],a=0,l=t.length,c=null!=e;l>a;a++)(s=t[a])&&(!i||i(s,o,n))&&(r.push(s),c&&e.push(a));return r}function f(t,e,i,o,s,r){return o&&!o[J]&&(o=f(o)),s&&!s[J]&&(s=f(s,r)),n(function(n,r,a,l){var c,m,u,h=[],p=[],_=r.length,f=n||b(e||"*",a.nodeType?[a]:a,[]),d=!t||!n&&e?f:y(f,h,t,a,l),x=i?s||(n?t:_||o)?[]:r:d;if(i&&i(d,x,a,l),o)for(c=y(x,p),o(c,[],a,l),m=c.length;m--;)(u=c[m])&&(x[p[m]]=!(d[p[m]]=u));if(n){if(s||t){if(s){for(c=[],m=x.length;m--;)(u=x[m])&&c.push(d[m]=u);s(null,x=[],c,l)}for(m=x.length;m--;)(u=x[m])&&(c=s?Q.call(n,u):h[m])>-1&&(n[c]=!(r[c]=u))}}else x=y(x===r?x.splice(_,x.length):x),s?s(null,r,x,l):Y.apply(r,x)})}function d(t){for(var e,i,o,n=t.length,s=B.relative[t[0].type],r=s||B.relative[" "],a=s?1:0,l=p(function(t){return t===e},r,!0),c=p(function(t){return Q.call(e,t)>-1},r,!0),m=[function(t,i,o){return!s&&(o||i!==V)||((e=i).nodeType?l(t,i,o):c(t,i,o))}];n>a;a++)if(i=B.relative[t[a].type])m=[p(_(m),i)];else{if(i=B.filter[t[a].type].apply(null,t[a].matches),i[J]){for(o=++a;n>o&&!B.relative[t[o].type];o++);return f(a>1&&_(m),a>1&&h(t.slice(0,a-1)).replace(re,"$1"),i,o>a&&d(t.slice(a,o)),n>o&&d(t=t.slice(o)),n>o&&h(t))}m.push(i)}return _(m)}function x(t,e){var i=0,o=e.length>0,s=t.length>0,a=function(n,a,l,c,m){var u,h,p,_=[],f=0,d="0",x=n&&[],b=null!=m,g=V,v=n||s&&B.find.TAG("*",m&&a.parentNode||a),w=z+=null==g?1:Math.random()||.1;for(b&&(V=a!==T&&a,C=i);null!=(u=v[d]);d++){if(s&&u){for(h=0;p=t[h++];)if(p(u,a,l)){c.push(u);break}b&&(z=w,C=++i)}o&&((u=!p&&u)&&f--,n&&x.push(u))}if(f+=d,o&&d!==f){for(h=0;p=e[h++];)p(x,_,a,l);if(n){if(f>0)for(;d--;)x[d]||_[d]||(_[d]=$.call(c));_=y(_)}Y.apply(c,_),b&&!n&&_.length>0&&f+e.length>1&&r.uniqueSort(c)}return b&&(z=w,V=g),x};return o?n(a):a}function b(t,e,i){for(var o=0,n=e.length;n>o;o++)r(t,e[o],i);return i}function g(t,e,i,o){var n,s,r,a,l,c=u(t);if(!o&&1===c.length){if(s=c[0]=c[0].slice(0),s.length>2&&"ID"===(r=s[0]).type&&9===e.nodeType&&!L&&B.relative[s[1].type]){if(e=B.find.ID(r.matches[0].replace(ge,ve),e)[0],!e)return i;t=t.slice(s.shift().value.length)}for(n=he.needsContext.test(t)?0:s.length;n--&&(r=s[n],!B.relative[a=r.type]);)if((l=B.find[a])&&(o=l(r.matches[0].replace(ge,ve),pe.test(s[0].type)&&e.parentNode||e))){if(s.splice(n,1),t=o.length&&h(s),!t)return Y.apply(i,Z.call(o,0)),i;break}}return A(t,c)(o,e,L,i,pe.test(t)),i}function v(){}var w,C,B,D,S,A,M,V,I,T,G,L,k,F,R,P,N,J="sizzle"+-new Date,E=t.document,j={},z=0,q=0,O=o(),W=o(),H=o(),U=typeof e,X=1<<31,K=[],$=K.pop,Y=K.push,Z=K.slice,Q=K.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},te="[\\x20\\t\\r\\n\\f]",ee="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie=ee.replace("w","w#"),oe="([*^$|!~]?=)",ne="\\["+te+"*("+ee+")"+te+"*(?:"+oe+te+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ie+")|)|)"+te+"*\\]",se=":("+ee+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ne.replace(3,8)+")*)|.*)\\)|)",re=new RegExp("^"+te+"+|((?:^|[^\\\\])(?:\\\\.)*)"+te+"+$","g"),ae=new RegExp("^"+te+"*,"+te+"*"),ce=new RegExp("^"+te+"*([\\x20\\t\\r\\n\\f>+~])"+te+"*"),me=new RegExp(se),ue=new RegExp("^"+ie+"$"),he={ID:new RegExp("^#("+ee+")"),CLASS:new RegExp("^\\.("+ee+")"),NAME:new RegExp("^\\[name=['\"]?("+ee+")['\"]?\\]"),TAG:new RegExp("^("+ee.replace("w","w*")+")"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+te+"*(even|odd|(([+-]|)(\\d*)n|)"+te+"*(?:([+-]|)"+te+"*(\\d+)|))"+te+"*\\)|)","i"),needsContext:new RegExp("^"+te+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+te+"*((?:-\\d)?\\d*)"+te+"*\\)|)(?=[^-]|$)","i")},pe=/[\x20\t\r\n\f]*[+~]/,_e=/^[^{]+\{\s*\[native code/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,fe=/^(?:input|select|textarea|button)$/i,de=/^h\d$/i,xe=/'|\\/g,be=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,ge=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,ve=function(t,e){var i="0x"+e-65536;return i!==i?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(55296|i>>10,56320|1023&i)};try{Z.call(E.documentElement.childNodes,0)[0].nodeType}catch(we){Z=function(t){for(var e,i=[];e=this[t++];)i.push(e);return i}}S=r.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},I=r.setDocument=function(t){var o=t?t.ownerDocument||t:E;return o!==T&&9===o.nodeType&&o.documentElement?(T=o,G=o.documentElement,L=S(o),j.tagNameNoComments=s(function(t){return t.appendChild(o.createComment("")),!t.getElementsByTagName("*").length}),j.attributes=s(function(t){t.innerHTML="<select></select>";var e=typeof t.lastChild.getAttribute("multiple");return"boolean"!==e&&"string"!==e}),j.getByClassName=s(function(t){return t.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",t.getElementsByClassName&&t.getElementsByClassName("e").length?(t.lastChild.className="e",2===t.getElementsByClassName("e").length):!1}),j.getByName=s(function(t){t.id=J+0,t.innerHTML="<a name='"+J+"'></a><div name='"+J+"'></div>",G.insertBefore(t,G.firstChild);var e=o.getElementsByName&&o.getElementsByName(J).length===2+o.getElementsByName(J+0).length;return j.getIdNotName=!o.getElementById(J),G.removeChild(t),e}),B.attrHandle=s(function(t){return t.innerHTML="<a href='#'></a>",t.firstChild&&typeof t.firstChild.getAttribute!==U&&"#"===t.firstChild.getAttribute("href")})?{}:{href:function(t){return t.getAttribute("href",2)},type:function(t){return t.getAttribute("type")}},j.getIdNotName?(B.find.ID=function(t,e){if(typeof e.getElementById!==U&&!L){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},B.filter.ID=function(t){var e=t.replace(ge,ve);return function(t){return t.getAttribute("id")===e}}):(B.find.ID=function(t,i){if(typeof i.getElementById!==U&&!L){var o=i.getElementById(t);return o?o.id===t||typeof o.getAttributeNode!==U&&o.getAttributeNode("id").value===t?[o]:e:[]}},B.filter.ID=function(t){var e=t.replace(ge,ve);return function(t){var i=typeof t.getAttributeNode!==U&&t.getAttributeNode("id");return i&&i.value===e}}),B.find.TAG=j.tagNameNoComments?function(t,e){return typeof e.getElementsByTagName!==U?e.getElementsByTagName(t):void 0}:function(t,e){var i,o=[],n=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[n++];)1===i.nodeType&&o.push(i);return o}return s},B.find.NAME=j.getByName&&function(t,e){return typeof e.getElementsByName!==U?e.getElementsByName(name):void 0},B.find.CLASS=j.getByClassName&&function(t,e){return typeof e.getElementsByClassName===U||L?void 0:e.getElementsByClassName(t)},F=[],k=[":focus"],(j.qsa=i(o.querySelectorAll))&&(s(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||k.push("\\["+te+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),t.querySelectorAll(":checked").length||k.push(":checked")}),s(function(t){t.innerHTML="<input type='hidden' i=''/>",t.querySelectorAll("[i^='']").length&&k.push("[*^$]="+te+"*(?:\"\"|'')"),t.querySelectorAll(":enabled").length||k.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),k.push(",.*:")})),(j.matchesSelector=i(R=G.matchesSelector||G.mozMatchesSelector||G.webkitMatchesSelector||G.oMatchesSelector||G.msMatchesSelector))&&s(function(t){j.disconnectedMatch=R.call(t,"div"),R.call(t,"[s!='']:x"),F.push("!=",se)}),k=new RegExp(k.join("|")),F=new RegExp(F.join("|")),P=i(G.contains)||G.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,o=e&&e.parentNode;return t===o||!(!o||1!==o.nodeType||!(i.contains?i.contains(o):t.compareDocumentPosition&&16&t.compareDocumentPosition(o)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},N=G.compareDocumentPosition?function(t,e){var i;return t===e?(M=!0,0):(i=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e))?1&i||t.parentNode&&11===t.parentNode.nodeType?t===o||P(E,t)?-1:e===o||P(E,e)?1:0:4&i?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var i,n=0,s=t.parentNode,r=e.parentNode,l=[t],c=[e];if(t===e)return M=!0,0;if(!s||!r)return t===o?-1:e===o?1:s?-1:r?1:0;if(s===r)return a(t,e);for(i=t;i=i.parentNode;)l.unshift(i);for(i=e;i=i.parentNode;)c.unshift(i);for(;l[n]===c[n];)n++;return n?a(l[n],c[n]):l[n]===E?-1:c[n]===E?1:0},M=!1,[0,0].sort(N),j.detectDuplicates=M,T):T},r.matches=function(t,e){return r(t,null,null,e)},r.matchesSelector=function(t,e){if((t.ownerDocument||t)!==T&&I(t),e=e.replace(be,"='$1']"),!(!j.matchesSelector||L||F&&F.test(e)||k.test(e)))try{var i=R.call(t,e);if(i||j.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(o){}return r(e,T,null,[t]).length>0},r.contains=function(t,e){return(t.ownerDocument||t)!==T&&I(t),P(t,e)},r.attr=function(t,e){var i;return(t.ownerDocument||t)!==T&&I(t),L||(e=e.toLowerCase()),(i=B.attrHandle[e])?i(t):L||j.attributes?t.getAttribute(e):((i=t.getAttributeNode(e))||t.getAttribute(e))&&t[e]===!0?e:i&&i.specified?i.value:null},r.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},r.uniqueSort=function(t){var e,i=[],o=1,n=0;if(M=!j.detectDuplicates,t.sort(N),M){for(;e=t[o];o++)e===t[o-1]&&(n=i.push(o));for(;n--;)t.splice(i[n],1)}return t},D=r.getText=function(t){var e,i="",o=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=D(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[o];o++)i+=D(e);return i},B=r.selectors={cacheLength:50,createPseudo:n,match:he,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(ge,ve),t[3]=(t[4]||t[5]||"").replace(ge,ve),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||r.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&r.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return he.CHILD.test(t[0])?null:(t[4]?t[2]=t[4]:i&&me.test(i)&&(e=u(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){return"*"===t?function(){return!0}:(t=t.replace(ge,ve).toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(t){var e=O[t+" "];return e||(e=new RegExp("(^|"+te+")"+t+"("+te+"|$)"))&&O(t,function(t){return e.test(t.className||typeof t.getAttribute!==U&&t.getAttribute("class")||"")})},ATTR:function(t,e,i){return function(o){var n=r.attr(o,t);return null==n?"!="===e:e?(n+="","="===e?n===i:"!="===e?n!==i:"^="===e?i&&0===n.indexOf(i):"*="===e?i&&n.indexOf(i)>-1:"$="===e?i&&n.slice(-i.length)===i:"~="===e?(" "+n+" ").indexOf(i)>-1:"|="===e?n===i||n.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(t,e,i,o,n){var s="nth"!==t.slice(0,3),r="last"!==t.slice(-4),a="of-type"===e;return 1===o&&0===n?function(t){return!!t.parentNode}:function(e,i,l){var c,m,u,h,p,_,y=s!==r?"nextSibling":"previousSibling",f=e.parentNode,d=a&&e.nodeName.toLowerCase(),x=!l&&!a;if(f){if(s){for(;y;){for(u=e;u=u[y];)if(a?u.nodeName.toLowerCase()===d:1===u.nodeType)return!1;_=y="only"===t&&!_&&"nextSibling"}return!0}if(_=[r?f.firstChild:f.lastChild],r&&x){for(m=f[J]||(f[J]={}),c=m[t]||[],p=c[0]===z&&c[1],h=c[0]===z&&c[2],u=p&&f.childNodes[p];u=++p&&u&&u[y]||(h=p=0)||_.pop();)if(1===u.nodeType&&++h&&u===e){m[t]=[z,p,h];break}}else if(x&&(c=(e[J]||(e[J]={}))[t])&&c[0]===z)h=c[1];else for(;(u=++p&&u&&u[y]||(h=p=0)||_.pop())&&((a?u.nodeName.toLowerCase()!==d:1!==u.nodeType)||!++h||(x&&((u[J]||(u[J]={}))[t]=[z,h]),u!==e)););return h-=n,h===o||0===h%o&&h/o>=0}}},PSEUDO:function(t,e){var i,o=B.pseudos[t]||B.setFilters[t.toLowerCase()]||r.error("unsupported pseudo: "+t);return o[J]?o(e):o.length>1?(i=[t,t,"",e],B.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,i){for(var n,s=o(t,e),r=s.length;r--;)n=Q.call(t,s[r]),t[n]=!(i[n]=s[r])}):function(t){return o(t,0,i)}):o}},pseudos:{not:n(function(t){var e=[],i=[],o=A(t.replace(re,"$1"));return o[J]?n(function(t,e,i,n){for(var s,r=o(t,null,n,[]),a=t.length;a--;)(s=r[a])&&(t[a]=!(e[a]=s))}):function(t,n,s){return e[0]=t,o(e,null,s,i),!i.pop()}}),has:n(function(t){return function(e){return r(t,e).length>0}}),contains:n(function(t){return function(e){return(e.textContent||e.innerText||D(e)).indexOf(t)>-1}}),lang:n(function(t){return ue.test(t||"")||r.error("unsupported lang: "+t),t=t.replace(ge,ve).toLowerCase(),function(e){var i;do if(i=L?e.getAttribute("xml:lang")||e.getAttribute("lang"):e.lang)return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===G},focus:function(t){return t===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!B.pseudos.empty(t)},header:function(t){return de.test(t.nodeName)},input:function(t){return fe.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:m(function(){return[0]}),last:m(function(t,e){return[e-1]}),eq:m(function(t,e,i){return[0>i?i+e:i]}),even:m(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:m(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:m(function(t,e,i){for(var o=0>i?i+e:i;--o>=0;)t.push(o);return t}),gt:m(function(t,e,i){for(var o=0>i?i+e:i;e>++o;)t.push(o);return t})}};for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})B.pseudos[w]=l(w);for(w in{submit:!0,reset:!0})B.pseudos[w]=c(w);A=r.compile=function(t,e){var i,o=[],n=[],s=H[t+" "];if(!s){for(e||(e=u(t)),i=e.length;i--;)s=d(e[i]),s[J]?o.push(s):n.push(s);s=H(t,x(n,o))}return s},B.pseudos.nth=B.pseudos.eq,B.filters=v.prototype=B.pseudos,B.setFilters=new v,I(),r.attr=le.attr,le.find=r,le.expr=r.selectors,le.expr[":"]=le.expr.pseudos,le.unique=r.uniqueSort,le.text=r.getText,le.isXMLDoc=r.isXML,le.contains=r.contains}(t);var je=/Until$/,ze=/^(?:parents|prev(?:Until|All))/,qe=/^.[^:#\[\.,]*$/,Oe=le.expr.match.needsContext,We={children:!0,contents:!0,next:!0,prev:!0};le.fn.extend({find:function(t){var e,i,o,n=this.length;if("string"!=typeof t)return o=this,this.pushStack(le(t).filter(function(){for(e=0;n>e;e++)if(le.contains(o[e],this))return!0}));for(i=[],e=0;n>e;e++)le.find(t,this[e],i);return i=this.pushStack(n>1?le.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+t,i},has:function(t){var e,i=le(t,this),o=i.length;return this.filter(function(){for(e=0;o>e;e++)if(le.contains(this,i[e]))return!0})},not:function(t){return this.pushStack(u(this,t,!1))},filter:function(t){return this.pushStack(u(this,t,!0))},is:function(t){return!!t&&("string"==typeof t?Oe.test(t)?le(t,this.context).index(this[0])>=0:le.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){for(var i,o=0,n=this.length,s=[],r=Oe.test(t)||"string"!=typeof t?le(t,e||this.context):0;n>o;o++)for(i=this[o];i&&i.ownerDocument&&i!==e&&11!==i.nodeType;){if(r?r.index(i)>-1:le.find.matchesSelector(i,t)){s.push(i);break}i=i.parentNode}return this.pushStack(s.length>1?le.unique(s):s)},index:function(t){return t?"string"==typeof t?le.inArray(this[0],le(t)):le.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?le(t,e):le.makeArray(t&&t.nodeType?[t]:t),o=le.merge(this.get(),i);return this.pushStack(le.unique(o))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),le.fn.andSelf=le.fn.addBack,le.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return le.dir(t,"parentNode")},parentsUntil:function(t,e,i){return le.dir(t,"parentNode",i)},next:function(t){return m(t,"nextSibling")},prev:function(t){return m(t,"previousSibling")},nextAll:function(t){return le.dir(t,"nextSibling")},prevAll:function(t){return le.dir(t,"previousSibling")},nextUntil:function(t,e,i){return le.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return le.dir(t,"previousSibling",i)},siblings:function(t){return le.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return le.sibling(t.firstChild)},contents:function(t){return le.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:le.merge([],t.childNodes)}},function(t,e){le.fn[t]=function(i,o){var n=le.map(this,e,i);return je.test(t)||(o=i),o&&"string"==typeof o&&(n=le.filter(o,n)),n=this.length>1&&!We[t]?le.unique(n):n,this.length>1&&ze.test(t)&&(n=n.reverse()),this.pushStack(n)}}),le.extend({filter:function(t,e,i){return i&&(t=":not("+t+")"),1===e.length?le.find.matchesSelector(e[0],t)?[e[0]]:[]:le.find.matches(t,e)},dir:function(t,i,o){for(var n=[],s=t[i];s&&9!==s.nodeType&&(o===e||1!==s.nodeType||!le(s).is(o));)1===s.nodeType&&n.push(s),s=s[i];return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var He="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ue=/ jQuery\d+="(?:null|\d+)"/g,Xe=new RegExp("<(?:"+He+")[\\s/>]","i"),Ke=/^\s+/,$e=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ye=/<([\w:]+)/,Ze=/<tbody/i,Qe=/<|&#?\w+;/,ti=/<(?:script|style|link)/i,ei=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,oi=/^$|\/(?:java|ecma)script/i,ni=/^true\/(.*)/,si=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ri={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:le.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ai=h(X),li=ai.appendChild(X.createElement("div"));ri.optgroup=ri.option,ri.tbody=ri.tfoot=ri.colgroup=ri.caption=ri.thead,ri.th=ri.td,le.fn.extend({text:function(t){return le.access(this,function(t){return t===e?le.text(this):this.empty().append((this[0]&&this[0].ownerDocument||X).createTextNode(t))},null,t,arguments.length)},wrapAll:function(t){if(le.isFunction(t))return this.each(function(e){le(this).wrapAll(t.call(this,e))});if(this[0]){var e=le(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return le.isFunction(t)?this.each(function(e){le(this).wrapInner(t.call(this,e))}):this.each(function(){var e=le(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=le.isFunction(t);return this.each(function(i){le(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){le.nodeName(this,"body")||le(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(t,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,!1,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,o=0;null!=(i=this[o]);o++)(!t||le.filter(t,[i]).length>0)&&(e||1!==i.nodeType||le.cleanData(b(i)),i.parentNode&&(e&&le.contains(i.ownerDocument,i)&&f(b(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&le.cleanData(b(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&le.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return le.clone(this,t,e)})},html:function(t){return le.access(this,function(t){var i=this[0]||{},o=0,n=this.length;if(t===e)return 1===i.nodeType?i.innerHTML.replace(Ue,""):e;if(!("string"!=typeof t||ti.test(t)||!le.support.htmlSerialize&&Xe.test(t)||!le.support.leadingWhitespace&&Ke.test(t)||ri[(Ye.exec(t)||["",""])[1].toLowerCase()])){t=t.replace($e,"<$1></$2>");try{for(;n>o;o++)i=this[o]||{},1===i.nodeType&&(le.cleanData(b(i,!1)),i.innerHTML=t);i=0}catch(s){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(t){var e=le.isFunction(t);return e||"string"==typeof t||(t=le(t).not(this).detach()),this.domManip([t],!0,function(t){var e=this.nextSibling,i=this.parentNode;i&&(le(this).remove(),i.insertBefore(t,e))})},detach:function(t){return this.remove(t,!0)},domManip:function(t,i,o){t=ee.apply([],t);var n,s,r,a,l,c,m=0,u=this.length,h=this,f=u-1,d=t[0],x=le.isFunction(d);if(x||!(1>=u||"string"!=typeof d||le.support.checkClone)&&ii.test(d))return this.each(function(n){var s=h.eq(n);x&&(t[0]=d.call(this,n,i?s.html():e)),s.domManip(t,i,o)});if(u&&(c=le.buildFragment(t,this[0].ownerDocument,!1,this),n=c.firstChild,1===c.childNodes.length&&(c=n),n)){for(i=i&&le.nodeName(n,"tr"),a=le.map(b(c,"script"),_),r=a.length;u>m;m++)s=c,m!==f&&(s=le.clone(s,!0,!0),r&&le.merge(a,b(s,"script"))),o.call(i&&le.nodeName(this[m],"table")?p(this[m],"tbody"):this[m],s,m);if(r)for(l=a[a.length-1].ownerDocument,le.map(a,y),m=0;r>m;m++)s=a[m],oi.test(s.type||"")&&!le._data(s,"globalEval")&&le.contains(l,s)&&(s.src?le.ajax({url:s.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):le.globalEval((s.text||s.textContent||s.innerHTML||"").replace(si,"")));c=n=null}return this}}),le.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){le.fn[t]=function(t){for(var i,o=0,n=[],s=le(t),r=s.length-1;r>=o;o++)i=o===r?this:this.clone(!0),le(s[o])[e](i),ie.apply(n,i.get());return this.pushStack(n)}}),le.extend({clone:function(t,e,i){var o,n,s,r,a,l=le.contains(t.ownerDocument,t);if(le.support.html5Clone||le.isXMLDoc(t)||!Xe.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(li.innerHTML=t.outerHTML,li.removeChild(s=li.firstChild)),!(le.support.noCloneEvent&&le.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||le.isXMLDoc(t)))for(o=b(s),a=b(t),r=0;null!=(n=a[r]);++r)o[r]&&x(n,o[r]);if(e)if(i)for(a=a||b(t),o=o||b(s),r=0;null!=(n=a[r]);r++)d(n,o[r]);else d(t,s);return o=b(s,"script"),o.length>0&&f(o,!l&&b(t,"script")),o=a=n=null,s},buildFragment:function(t,e,i,o){for(var n,s,r,a,l,c,m,u=t.length,p=h(e),_=[],y=0;u>y;y++)if(s=t[y],s||0===s)if("object"===le.type(s))le.merge(_,s.nodeType?[s]:s);else if(Qe.test(s)){for(a=a||p.appendChild(e.createElement("div")),l=(Ye.exec(s)||["",""])[1].toLowerCase(),m=ri[l]||ri._default,a.innerHTML=m[1]+s.replace($e,"<$1></$2>")+m[2],n=m[0];n--;)a=a.lastChild;if(!le.support.leadingWhitespace&&Ke.test(s)&&_.push(e.createTextNode(Ke.exec(s)[0])),!le.support.tbody)for(s="table"!==l||Ze.test(s)?"<table>"!==m[1]||Ze.test(s)?0:a:a.firstChild,n=s&&s.childNodes.length;n--;)le.nodeName(c=s.childNodes[n],"tbody")&&!c.childNodes.length&&s.removeChild(c);for(le.merge(_,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=p.lastChild}else _.push(e.createTextNode(s));for(a&&p.removeChild(a),le.support.appendChecked||le.grep(b(_,"input"),g),y=0;s=_[y++];)if((!o||-1===le.inArray(s,o))&&(r=le.contains(s.ownerDocument,s),a=b(p.appendChild(s),"script"),r&&f(a),i))for(n=0;s=a[n++];)oi.test(s.type||"")&&i.push(s);return a=null,p},cleanData:function(t,e){for(var i,o,n,s,r=0,a=le.expando,l=le.cache,c=le.support.deleteExpando,m=le.event.special;null!=(i=t[r]);r++)if((e||le.acceptData(i))&&(n=i[a],s=n&&l[n])){if(s.events)for(o in s.events)m[o]?le.event.remove(i,o):le.removeEvent(i,o,s.handle);l[n]&&(delete l[n],c?delete i[a]:typeof i.removeAttribute!==U?i.removeAttribute(a):i[a]=null,Q.push(n))}}});var ci,mi,ui,hi=/alpha\([^)]*\)/i,pi=/opacity\s*=\s*([^)]*)/,_i=/^(top|right|bottom|left)$/,yi=/^(none|table(?!-c[ea]).+)/,fi=/^margin/,di=new RegExp("^("+ce+")(.*)$","i"),xi=new RegExp("^("+ce+")(?!px)[a-z%]+$","i"),bi=new RegExp("^([+-])=("+ce+")","i"),gi={BODY:"block"},vi={position:"absolute",visibility:"hidden",display:"block"},wi={letterSpacing:0,fontWeight:400},Ci=["Top","Right","Bottom","Left"],Bi=["Webkit","O","Moz","ms"];le.fn.extend({css:function(t,i){return le.access(this,function(t,i,o){var n,s,r={},a=0;if(le.isArray(i)){for(s=mi(t),n=i.length;n>a;a++)r[i[a]]=le.css(t,i[a],!1,s);return r}return o!==e?le.style(t,i,o):le.css(t,i)},t,i,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:w(this))?le(this).show():le(this).hide()})}}),le.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ui(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":le.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,o,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,r,a,l=le.camelCase(i),c=t.style;if(i=le.cssProps[l]||(le.cssProps[l]=v(c,l)),a=le.cssHooks[i]||le.cssHooks[l],o===e)return a&&"get"in a&&(s=a.get(t,!1,n))!==e?s:c[i];if(r=typeof o,"string"===r&&(s=bi.exec(o))&&(o=(s[1]+1)*s[2]+parseFloat(le.css(t,i)),r="number"),!(null==o||"number"===r&&isNaN(o)||("number"!==r||le.cssNumber[l]||(o+="px"),le.support.clearCloneStyle||""!==o||0!==i.indexOf("background")||(c[i]="inherit"),a&&"set"in a&&(o=a.set(t,o,n))===e)))try{c[i]=o}catch(m){}}},css:function(t,i,o,n){var s,r,a,l=le.camelCase(i);return i=le.cssProps[l]||(le.cssProps[l]=v(t.style,l)),a=le.cssHooks[i]||le.cssHooks[l],a&&"get"in a&&(r=a.get(t,!0,o)),r===e&&(r=ui(t,i,n)),"normal"===r&&i in wi&&(r=wi[i]),""===o||o?(s=parseFloat(r),o===!0||le.isNumeric(s)?s||0:r):r},swap:function(t,e,i,o){var n,s,r={};for(s in e)r[s]=t.style[s],t.style[s]=e[s];n=i.apply(t,o||[]);for(s in e)t.style[s]=r[s];return n}}),t.getComputedStyle?(mi=function(e){return t.getComputedStyle(e,null)},ui=function(t,i,o){var n,s,r,a=o||mi(t),l=a?a.getPropertyValue(i)||a[i]:e,c=t.style;return a&&(""!==l||le.contains(t.ownerDocument,t)||(l=le.style(t,i)),xi.test(l)&&fi.test(i)&&(n=c.width,s=c.minWidth,r=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=a.width,c.width=n,c.minWidth=s,c.maxWidth=r)),l}):X.documentElement.currentStyle&&(mi=function(t){return t.currentStyle},ui=function(t,i,o){var n,s,r,a=o||mi(t),l=a?a[i]:e,c=t.style;return null==l&&c&&c[i]&&(l=c[i]),xi.test(l)&&!_i.test(i)&&(n=c.left,s=t.runtimeStyle,r=s&&s.left,r&&(s.left=t.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=n,r&&(s.left=r)),""===l?"auto":l}),le.each(["height","width"],function(t,e){le.cssHooks[e]={get:function(t,i,o){return i?0===t.offsetWidth&&yi.test(le.css(t,"display"))?le.swap(t,vi,function(){return S(t,e,o)}):S(t,e,o):void 0},set:function(t,i,o){var n=o&&mi(t);return B(t,i,o?D(t,e,o,le.support.boxSizing&&"border-box"===le.css(t,"boxSizing",!1,n),n):0)}}}),le.support.opacity||(le.cssHooks.opacity={get:function(t,e){return pi.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,o=t.currentStyle,n=le.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=o&&o.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===le.trim(s.replace(hi,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||o&&!o.filter)||(i.filter=hi.test(s)?s.replace(hi,n):s+" "+n)}}),le(function(){le.support.reliableMarginRight||(le.cssHooks.marginRight={get:function(t,e){return e?le.swap(t,{display:"inline-block"},ui,[t,"marginRight"]):void 0}}),!le.support.pixelPosition&&le.fn.position&&le.each(["top","left"],function(t,e){le.cssHooks[e]={get:function(t,i){return i?(i=ui(t,e),xi.test(i)?le(t).position()[e]+"px":i):void 0}}})}),le.expr&&le.expr.filters&&(le.expr.filters.hidden=function(t){return 0>=t.offsetWidth&&0>=t.offsetHeight||!le.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||le.css(t,"display"))},le.expr.filters.visible=function(t){return!le.expr.filters.hidden(t)}),le.each({margin:"",padding:"",border:"Width"},function(t,e){le.cssHooks[t+e]={expand:function(i){for(var o=0,n={},s="string"==typeof i?i.split(" "):[i];4>o;o++)n[t+Ci[o]+e]=s[o]||s[o-2]||s[0];return n}},fi.test(t)||(le.cssHooks[t+e].set=B)});var Di=/%20/g,Si=/\[\]$/,Ai=/\r?\n/g,Mi=/^(?:submit|button|image|reset|file)$/i,Vi=/^(?:input|select|textarea|keygen)/i;le.fn.extend({serialize:function(){return le.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=le.prop(this,"elements");return t?le.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!le(this).is(":disabled")&&Vi.test(this.nodeName)&&!Mi.test(t)&&(this.checked||!ei.test(t))}).map(function(t,e){var i=le(this).val();return null==i?null:le.isArray(i)?le.map(i,function(t){return{name:e.name,value:t.replace(Ai,"\r\n")}}):{name:e.name,value:i.replace(Ai,"\r\n")}}).get()}}),le.param=function(t,i){var o,n=[],s=function(t,e){e=le.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)
};if(i===e&&(i=le.ajaxSettings&&le.ajaxSettings.traditional),le.isArray(t)||t.jquery&&!le.isPlainObject(t))le.each(t,function(){s(this.name,this.value)});else for(o in t)V(o,t[o],i,s);return n.join("&").replace(Di,"+")},le.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){le.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),le.fn.hover=function(t,e){return this.mouseenter(t).mouseleave(e||t)};var Ii,Ti,Gi=le.now(),Li=/\?/,ki=/#.*$/,Fi=/([?&])_=[^&]*/,Ri=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Pi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ni=/^(?:GET|HEAD)$/,Ji=/^\/\//,Ei=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ji=le.fn.load,zi={},qi={},Oi="*/".concat("*");try{Ti=K.href}catch(Wi){Ti=X.createElement("a"),Ti.href="",Ti=Ti.href}Ii=Ei.exec(Ti.toLowerCase())||[],le.fn.load=function(t,i,o){if("string"!=typeof t&&ji)return ji.apply(this,arguments);var n,s,r,a=this,l=t.indexOf(" ");return l>=0&&(n=t.slice(l,t.length),t=t.slice(0,l)),le.isFunction(i)?(o=i,i=e):i&&"object"==typeof i&&(r="POST"),a.length>0&&le.ajax({url:t,type:r,dataType:"html",data:i}).done(function(t){s=arguments,a.html(n?le("<div>").append(le.parseHTML(t)).find(n):t)}).complete(o&&function(t,e){a.each(o,s||[t.responseText,e,t])}),this},le.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){le.fn[e]=function(t){return this.on(e,t)}}),le.each(["get","post"],function(t,i){le[i]=function(t,o,n,s){return le.isFunction(o)&&(s=s||n,n=o,o=e),le.ajax({url:t,type:i,dataType:s,data:o,success:n})}}),le.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ti,type:"GET",isLocal:Pi.test(Ii[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Oi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":t.String,"text html":!0,"text json":le.parseJSON,"text xml":le.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?G(G(t,le.ajaxSettings),e):G(le.ajaxSettings,t)},ajaxPrefilter:I(zi),ajaxTransport:I(qi),ajax:function(t,i){function o(t,i,o,n){var s,u,x,b,v,C=i;2!==g&&(g=2,l&&clearTimeout(l),m=e,a=n||"",w.readyState=t>0?4:0,o&&(b=L(h,w,o)),t>=200&&300>t||304===t?(h.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(le.lastModified[r]=v),v=w.getResponseHeader("etag"),v&&(le.etag[r]=v)),204===t?(s=!0,C="nocontent"):304===t?(s=!0,C="notmodified"):(s=k(h,b),C=s.state,u=s.data,x=s.error,s=!x)):(x=C,(t||!C)&&(C="error",0>t&&(t=0))),w.status=t,w.statusText=(i||C)+"",s?y.resolveWith(p,[u,C,w]):y.rejectWith(p,[w,C,x]),w.statusCode(d),d=e,c&&_.trigger(s?"ajaxSuccess":"ajaxError",[w,h,s?u:x]),f.fireWith(p,[w,C]),c&&(_.trigger("ajaxComplete",[w,h]),--le.active||le.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=e),i=i||{};var n,s,r,a,l,c,m,u,h=le.ajaxSetup({},i),p=h.context||h,_=h.context&&(p.nodeType||p.jquery)?le(p):le.event,y=le.Deferred(),f=le.Callbacks("once memory"),d=h.statusCode||{},x={},b={},g=0,v="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===g){if(!u)for(u={};e=Ri.exec(a);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===g?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return g||(t=b[i]=b[i]||t,x[t]=e),this},overrideMimeType:function(t){return g||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>g)for(e in t)d[e]=[d[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||v;return m&&m.abort(e),o(0,e),this}};if(y.promise(w).complete=f.add,w.success=w.done,w.error=w.fail,h.url=((t||h.url||Ti)+"").replace(ki,"").replace(Ji,Ii[1]+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=le.trim(h.dataType||"*").toLowerCase().match(me)||[""],null==h.crossDomain&&(n=Ei.exec(h.url.toLowerCase()),h.crossDomain=!(!n||n[1]===Ii[1]&&n[2]===Ii[2]&&(n[3]||("http:"===n[1]?80:443))==(Ii[3]||("http:"===Ii[1]?80:443)))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=le.param(h.data,h.traditional)),T(zi,h,i,w),2===g)return w;c=h.global,c&&0===le.active++&&le.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Ni.test(h.type),r=h.url,h.hasContent||(h.data&&(r=h.url+=(Li.test(r)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Fi.test(r)?r.replace(Fi,"$1_="+Gi++):r+(Li.test(r)?"&":"?")+"_="+Gi++)),h.ifModified&&(le.lastModified[r]&&w.setRequestHeader("If-Modified-Since",le.lastModified[r]),le.etag[r]&&w.setRequestHeader("If-None-Match",le.etag[r])),(h.data&&h.hasContent&&h.contentType!==!1||i.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Oi+"; q=0.01":""):h.accepts["*"]);for(s in h.headers)w.setRequestHeader(s,h.headers[s]);if(h.beforeSend&&(h.beforeSend.call(p,w,h)===!1||2===g))return w.abort();v="abort";for(s in{success:1,error:1,complete:1})w[s](h[s]);if(m=T(qi,h,i,w)){w.readyState=1,c&&_.trigger("ajaxSend",[w,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){w.abort("timeout")},h.timeout));try{g=1,m.send(x,o)}catch(C){if(!(2>g))throw C;o(-1,C)}}else o(-1,"No Transport");return w},getScript:function(t,i){return le.get(t,e,i,"script")},getJSON:function(t,e,i){return le.get(t,e,i,"json")}}),le.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return le.globalEval(t),t}}}),le.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),le.ajaxTransport("script",function(t){if(t.crossDomain){var i,o=X.head||le("head")[0]||X.documentElement;return{send:function(e,n){i=X.createElement("script"),i.async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,e||n(200,"success"))},o.insertBefore(i,o.firstChild)},abort:function(){i&&i.onload(e,!0)}}}});var Hi=[],Ui=/(=)\?(?=&|$)|\?\?/;le.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Hi.pop()||le.expando+"_"+Gi++;return this[t]=!0,t}}),le.ajaxPrefilter("json jsonp",function(i,o,n){var s,r,a,l=i.jsonp!==!1&&(Ui.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ui.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(s=i.jsonpCallback=le.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Ui,"$1"+s):i.jsonp!==!1&&(i.url+=(Li.test(i.url)?"&":"?")+i.jsonp+"="+s),i.converters["script json"]=function(){return a||le.error(s+" was not called"),a[0]},i.dataTypes[0]="json",r=t[s],t[s]=function(){a=arguments},n.always(function(){t[s]=r,i[s]&&(i.jsonpCallback=o.jsonpCallback,Hi.push(s)),a&&le.isFunction(r)&&r(a[0]),a=r=e}),"script"):void 0});var Xi,Ki,$i=0,Yi=t.ActiveXObject&&function(){var t;for(t in Xi)Xi[t](e,!0)};le.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&F()||R()}:F,Ki=le.ajaxSettings.xhr(),le.support.cors=!!Ki&&"withCredentials"in Ki,Ki=le.support.ajax=!!Ki,Ki&&le.ajaxTransport(function(i){if(!i.crossDomain||le.support.cors){var o;return{send:function(n,s){var r,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");try{for(a in n)l.setRequestHeader(a,n[a])}catch(c){}l.send(i.hasContent&&i.data||null),o=function(t,n){var a,c,m,u;try{if(o&&(n||4===l.readyState))if(o=e,r&&(l.onreadystatechange=le.noop,Yi&&delete Xi[r]),n)4!==l.readyState&&l.abort();else{u={},a=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{m=l.statusText}catch(h){m=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=u.text?200:404}}catch(p){n||s(-1,p)}u&&s(a,m,u,c)},i.async?4===l.readyState?setTimeout(o):(r=++$i,Yi&&(Xi||(Xi={},le(t).unload(Yi)),Xi[r]=o),l.onreadystatechange=o):o()},abort:function(){o&&o(e,!0)}}}});var Zi,Qi,to=/^(?:toggle|show|hide)$/,eo=new RegExp("^(?:([+-])=|)("+ce+")([a-z%]*)$","i"),io=/queueHooks$/,oo=[j],no={"*":[function(t,e){var i,o,n=this.createTween(t,e),s=eo.exec(e),r=n.cur(),a=+r||0,l=1,c=20;if(s){if(i=+s[2],o=s[3]||(le.cssNumber[t]?"":"px"),"px"!==o&&a){a=le.css(n.elem,t,!0)||i||1;do l=l||".5",a/=l,le.style(n.elem,t,a+o);while(l!==(l=n.cur()/r)&&1!==l&&--c)}n.unit=o,n.start=a,n.end=s[1]?a+(s[1]+1)*i:i}return n}]};le.Animation=le.extend(J,{tweener:function(t,e){le.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,o=0,n=t.length;n>o;o++)i=t[o],no[i]=no[i]||[],no[i].unshift(e)},prefilter:function(t,e){e?oo.unshift(t):oo.push(t)}}),le.Tween=z,z.prototype={constructor:z,init:function(t,e,i,o,n,s){this.elem=t,this.prop=i,this.easing=n||"swing",this.options=e,this.start=this.now=this.cur(),this.end=o,this.unit=s||(le.cssNumber[i]?"":"px")},cur:function(){var t=z.propHooks[this.prop];return t&&t.get?t.get(this):z.propHooks._default.get(this)},run:function(t){var e,i=z.propHooks[this.prop];return this.pos=e=this.options.duration?le.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):z.propHooks._default.set(this),this}},z.prototype.init.prototype=z.prototype,z.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=le.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){le.fx.step[t.prop]?le.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[le.cssProps[t.prop]]||le.cssHooks[t.prop])?le.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},z.propHooks.scrollTop=z.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},le.each(["toggle","show","hide"],function(t,e){var i=le.fn[e];le.fn[e]=function(t,o,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(q(e,!0),t,o,n)}}),le.fn.extend({fadeTo:function(t,e,i,o){return this.filter(w).css("opacity",0).show().end().animate({opacity:e},t,i,o)},animate:function(t,e,i,o){var n=le.isEmptyObject(t),s=le.speed(e,i,o),r=function(){var e=J(this,le.extend({},t),s);r.finish=function(){e.stop(!0)},(n||le._data(this,"finish"))&&e.stop(!0)};return r.finish=r,n||s.queue===!1?this.each(r):this.queue(s.queue,r)},stop:function(t,i,o){var n=function(t){var e=t.stop;delete t.stop,e(o)};return"string"!=typeof t&&(o=i,i=t,t=e),i&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",s=le.timers,r=le._data(this);if(i)r[i]&&r[i].stop&&n(r[i]);else for(i in r)r[i]&&r[i].stop&&io.test(i)&&n(r[i]);for(i=s.length;i--;)s[i].elem!==this||null!=t&&s[i].queue!==t||(s[i].anim.stop(o),e=!1,s.splice(i,1));(e||!o)&&le.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=le._data(this),o=i[t+"queue"],n=i[t+"queueHooks"],s=le.timers,r=o?o.length:0;for(i.finish=!0,le.queue(this,t,[]),n&&n.cur&&n.cur.finish&&n.cur.finish.call(this),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;r>e;e++)o[e]&&o[e].finish&&o[e].finish.call(this);delete i.finish})}}),le.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){le.fn[t]=function(t,i,o){return this.animate(e,t,i,o)}}),le.speed=function(t,e,i){var o=t&&"object"==typeof t?le.extend({},t):{complete:i||!i&&e||le.isFunction(t)&&t,duration:t,easing:i&&e||e&&!le.isFunction(e)&&e};return o.duration=le.fx.off?0:"number"==typeof o.duration?o.duration:o.duration in le.fx.speeds?le.fx.speeds[o.duration]:le.fx.speeds._default,(null==o.queue||o.queue===!0)&&(o.queue="fx"),o.old=o.complete,o.complete=function(){le.isFunction(o.old)&&o.old.call(this),o.queue&&le.dequeue(this,o.queue)},o},le.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},le.timers=[],le.fx=z.prototype.init,le.fx.tick=function(){var t,i=le.timers,o=0;for(Zi=le.now();i.length>o;o++)t=i[o],t()||i[o]!==t||i.splice(o--,1);i.length||le.fx.stop(),Zi=e},le.fx.timer=function(t){t()&&le.timers.push(t)&&le.fx.start()},le.fx.interval=13,le.fx.start=function(){Qi||(Qi=setInterval(le.fx.tick,le.fx.interval))},le.fx.stop=function(){clearInterval(Qi),Qi=null},le.fx.speeds={slow:600,fast:200,_default:400},le.fx.step={},le.expr&&le.expr.filters&&(le.expr.filters.animated=function(t){return le.grep(le.timers,function(e){return t===e.elem}).length}),le.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){le.offset.setOffset(this,t,e)});var i,o,n={top:0,left:0},s=this[0],r=s&&s.ownerDocument;if(r)return i=r.documentElement,le.contains(i,s)?(typeof s.getBoundingClientRect!==U&&(n=s.getBoundingClientRect()),o=O(r),{top:n.top+(o.pageYOffset||i.scrollTop)-(i.clientTop||0),left:n.left+(o.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):n},le.offset={setOffset:function(t,e,i){var o=le.css(t,"position");"static"===o&&(t.style.position="relative");var n,s,r=le(t),a=r.offset(),l=le.css(t,"top"),c=le.css(t,"left"),m=("absolute"===o||"fixed"===o)&&le.inArray("auto",[l,c])>-1,u={},h={};m?(h=r.position(),n=h.top,s=h.left):(n=parseFloat(l)||0,s=parseFloat(c)||0),le.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(u.top=e.top-a.top+n),null!=e.left&&(u.left=e.left-a.left+s),"using"in e?e.using.call(t,u):r.css(u)}},le.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},o=this[0];return"fixed"===le.css(o,"position")?e=o.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),le.nodeName(t[0],"html")||(i=t.offset()),i.top+=le.css(t[0],"borderTopWidth",!0),i.left+=le.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-le.css(o,"marginTop",!0),left:e.left-i.left-le.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||X.documentElement;t&&!le.nodeName(t,"html")&&"static"===le.css(t,"position");)t=t.offsetParent;return t||X.documentElement})}}),le.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o=/Y/.test(i);le.fn[t]=function(n){return le.access(this,function(t,n,s){var r=O(t);return s===e?r?i in r?r[i]:r.document.documentElement[n]:t[n]:(r?r.scrollTo(o?le(r).scrollLeft():s,o?s:le(r).scrollTop()):t[n]=s,void 0)},t,n,arguments.length,null)}}),le.each({Height:"height",Width:"width"},function(t,i){le.each({padding:"inner"+t,content:i,"":"outer"+t},function(o,n){le.fn[n]=function(n,s){var r=arguments.length&&(o||"boolean"!=typeof n),a=o||(n===!0||s===!0?"margin":"border");return le.access(this,function(i,o,n){var s;return le.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(s=i.documentElement,Math.max(i.body["scroll"+t],s["scroll"+t],i.body["offset"+t],s["offset"+t],s["client"+t])):n===e?le.css(i,o,a):le.style(i,o,n,a)},i,r?n:e,r,null)}})}),t.jQuery=t.$=le,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return le})})(window),function(t,e){var i=function(){var e=t._data(document,"events");return e&&e.click&&t.grep(e.click,function(t){return"rails"===t.namespace}).length};i()&&t.error("jquery-ujs has already been loaded!");var o;t.rails=o={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(e){var i=t('meta[name="csrf-token"]').attr("content");i&&e.setRequestHeader("X-CSRF-Token",i)},fire:function(e,i,o){var n=t.Event(i);return e.trigger(n,o),n.result!==!1},confirm:function(t){return confirm(t)},ajax:function(e){return t.ajax(e)},href:function(t){return t.attr("href")},handleRemote:function(i){var n,s,r,a,l,c,m,u;if(o.fire(i,"ajax:before")){if(a=i.data("cross-domain"),l=a===e?null:a,c=i.data("with-credentials")||null,m=i.data("type")||t.ajaxSettings&&t.ajaxSettings.dataType,i.is("form")){n=i.attr("method"),s=i.attr("action"),r=i.serializeArray();var h=i.data("ujs:submit-button");h&&(r.push(h),i.data("ujs:submit-button",null))}else i.is(o.inputChangeSelector)?(n=i.data("method"),s=i.data("url"),r=i.serialize(),i.data("params")&&(r=r+"&"+i.data("params"))):(n=i.data("method"),s=o.href(i),r=i.data("params")||null);u={type:n||"GET",data:r,dataType:m,beforeSend:function(t,n){return n.dataType===e&&t.setRequestHeader("accept","*/*;q=0.5, "+n.accepts.script),o.fire(i,"ajax:beforeSend",[t,n])},success:function(t,e,o){i.trigger("ajax:success",[t,e,o])},complete:function(t,e){i.trigger("ajax:complete",[t,e])},error:function(t,e,o){i.trigger("ajax:error",[t,e,o])},crossDomain:l},c&&(u.xhrFields={withCredentials:c}),s&&(u.url=s);var p=o.ajax(u);return i.trigger("ajax:send",p),p}return!1},handleMethod:function(i){var n=o.href(i),s=i.data("method"),r=i.attr("target"),a=t("meta[name=csrf-token]").attr("content"),l=t("meta[name=csrf-param]").attr("content"),c=t('<form method="post" action="'+n+'"></form>'),m='<input name="_method" value="'+s+'" type="hidden" />';l!==e&&a!==e&&(m+='<input name="'+l+'" value="'+a+'" type="hidden" />'),r&&c.attr("target",r),c.hide().append(m).appendTo("body"),c.submit()},disableFormElements:function(e){e.find(o.disableSelector).each(function(){var e=t(this),i=e.is("button")?"html":"val";e.data("ujs:enable-with",e[i]()),e[i](e.data("disable-with")),e.prop("disabled",!0)})},enableFormElements:function(e){e.find(o.enableSelector).each(function(){var e=t(this),i=e.is("button")?"html":"val";e.data("ujs:enable-with")&&e[i](e.data("ujs:enable-with")),e.prop("disabled",!1)})},allowAction:function(t){var e,i=t.data("confirm"),n=!1;return i?(o.fire(t,"confirm")&&(n=o.confirm(i),e=o.fire(t,"confirm:complete",[n])),n&&e):!0},blankInputs:function(e,i,o){var n,s,r=t(),a=i||"input,textarea",l=e.find(a);return l.each(function(){if(n=t(this),s=n.is("input[type=checkbox],input[type=radio]")?n.is(":checked"):n.val(),!s==!o){if(n.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+n.attr("name")+'"]').length)return!0;r=r.add(n)}}),r.length?r:!1},nonBlankInputs:function(t,e){return o.blankInputs(t,e,!0)},stopEverything:function(e){return t(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},callFormSubmitBindings:function(i,o){var n=i.data("events"),s=!0;return n!==e&&n.submit!==e&&t.each(n.submit,function(t,e){return"function"==typeof e.handler?s=e.handler(o):void 0}),s},disableElement:function(t){t.data("ujs:enable-with",t.html()),t.html(t.data("disable-with")),t.bind("click.railsDisable",function(t){return o.stopEverything(t)})},enableElement:function(t){t.data("ujs:enable-with")!==e&&(t.html(t.data("ujs:enable-with")),t.data("ujs:enable-with",!1)),t.unbind("click.railsDisable")}},o.fire(t(document),"rails:attachBindings")&&(t.ajaxPrefilter(function(t,e,i){t.crossDomain||o.CSRFProtection(i)}),t(document).delegate(o.linkDisableSelector,"ajax:complete",function(){o.enableElement(t(this))}),t(document).delegate(o.linkClickSelector,"click.rails",function(i){var n=t(this),s=n.data("method"),r=n.data("params");if(!o.allowAction(n))return o.stopEverything(i);if(n.is(o.linkDisableSelector)&&o.disableElement(n),n.data("remote")!==e){if(!(!i.metaKey&&!i.ctrlKey||s&&"GET"!==s||r))return!0;var a=o.handleRemote(n);return a===!1?o.enableElement(n):a.error(function(){o.enableElement(n)}),!1}return n.data("method")?(o.handleMethod(n),!1):void 0}),t(document).delegate(o.inputChangeSelector,"change.rails",function(e){var i=t(this);return o.allowAction(i)?(o.handleRemote(i),!1):o.stopEverything(e)}),t(document).delegate(o.formSubmitSelector,"submit.rails",function(i){var n=t(this),s=n.data("remote")!==e,r=o.blankInputs(n,o.requiredInputSelector),a=o.nonBlankInputs(n,o.fileInputSelector);if(!o.allowAction(n))return o.stopEverything(i);if(r&&n.attr("novalidate")==e&&o.fire(n,"ajax:aborted:required",[r]))return o.stopEverything(i);if(s){if(a){setTimeout(function(){o.disableFormElements(n)},13);var l=o.fire(n,"ajax:aborted:file",[a]);return l||setTimeout(function(){o.enableFormElements(n)},13),l}return!t.support.submitBubbles&&"1.7">t().jquery&&o.callFormSubmitBindings(n,i)===!1?o.stopEverything(i):(o.handleRemote(n),!1)}setTimeout(function(){o.disableFormElements(n)},13)}),t(document).delegate(o.formInputClickSelector,"click.rails",function(e){var i=t(this);if(!o.allowAction(i))return o.stopEverything(e);var n=i.attr("name"),s=n?{name:n,value:i.val()}:null;i.closest("form").data("ujs:submit-button",s)}),t(document).delegate(o.formSubmitSelector,"ajax:beforeSend.rails",function(e){this==e.target&&o.disableFormElements(t(this))}),t(document).delegate(o.formSubmitSelector,"ajax:complete.rails",function(e){this==e.target&&o.enableFormElements(t(this))}),t(function(){var e=t("meta[name=csrf-token]").attr("content"),i=t("meta[name=csrf-param]").attr("content");t('form input[name="'+i+'"]').val(e)}))}(jQuery),function(){var t=this,e=t._,i={},o=Array.prototype,n=Object.prototype,s=Function.prototype,r=o.push,a=o.slice,l=o.concat,c=n.toString,m=n.hasOwnProperty,u=o.forEach,h=o.map,p=o.reduce,_=o.reduceRight,y=o.filter,f=o.every,d=o.some,x=o.indexOf,b=o.lastIndexOf,g=Array.isArray,v=Object.keys,w=s.bind,C=function(t){return t instanceof C?t:this instanceof C?(this._wrapped=t,void 0):new C(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):t._=C,C.VERSION="1.4.4";var B=C.each=C.forEach=function(t,e,o){if(null!=t)if(u&&t.forEach===u)t.forEach(e,o);else if(t.length===+t.length){for(var n=0,s=t.length;s>n;n++)if(e.call(o,t[n],n,t)===i)return}else for(var r in t)if(C.has(t,r)&&e.call(o,t[r],r,t)===i)return};C.map=C.collect=function(t,e,i){var o=[];return null==t?o:h&&t.map===h?t.map(e,i):(B(t,function(t,n,s){o[o.length]=e.call(i,t,n,s)}),o)};var D="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(t,e,i,o){var n=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return o&&(e=C.bind(e,o)),n?t.reduce(e,i):t.reduce(e);if(B(t,function(t,s,r){n?i=e.call(o,i,t,s,r):(i=t,n=!0)}),!n)throw new TypeError(D);return i},C.reduceRight=C.foldr=function(t,e,i,o){var n=arguments.length>2;if(null==t&&(t=[]),_&&t.reduceRight===_)return o&&(e=C.bind(e,o)),n?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(s!==+s){var r=C.keys(t);s=r.length}if(B(t,function(a,l,c){l=r?r[--s]:--s,n?i=e.call(o,i,t[l],l,c):(i=t[l],n=!0)}),!n)throw new TypeError(D);return i},C.find=C.detect=function(t,e,i){var o;return S(t,function(t,n,s){return e.call(i,t,n,s)?(o=t,!0):void 0}),o},C.filter=C.select=function(t,e,i){var o=[];return null==t?o:y&&t.filter===y?t.filter(e,i):(B(t,function(t,n,s){e.call(i,t,n,s)&&(o[o.length]=t)}),o)},C.reject=function(t,e,i){return C.filter(t,function(t,o,n){return!e.call(i,t,o,n)},i)},C.every=C.all=function(t,e,o){e||(e=C.identity);var n=!0;return null==t?n:f&&t.every===f?t.every(e,o):(B(t,function(t,s,r){return(n=n&&e.call(o,t,s,r))?void 0:i}),!!n)};var S=C.some=C.any=function(t,e,o){e||(e=C.identity);var n=!1;return null==t?n:d&&t.some===d?t.some(e,o):(B(t,function(t,s,r){return n||(n=e.call(o,t,s,r))?i:void 0}),!!n)};C.contains=C.include=function(t,e){return null==t?!1:x&&t.indexOf===x?-1!=t.indexOf(e):S(t,function(t){return t===e})},C.invoke=function(t,e){var i=a.call(arguments,2),o=C.isFunction(e);return C.map(t,function(t){return(o?e:t[e]).apply(t,i)})},C.pluck=function(t,e){return C.map(t,function(t){return t[e]})},C.where=function(t,e,i){return C.isEmpty(e)?i?void 0:[]:C[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},C.findWhere=function(t,e){return C.where(t,e,!0)},C.max=function(t,e,i){if(!e&&C.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.max.apply(Math,t);if(!e&&C.isEmpty(t))return-1/0;var o={computed:-1/0,value:-1/0};return B(t,function(t,n,s){var r=e?e.call(i,t,n,s):t;r>=o.computed&&(o={value:t,computed:r})}),o.value},C.min=function(t,e,i){if(!e&&C.isArray(t)&&t[0]===+t[0]&&65535>t.length)return Math.min.apply(Math,t);if(!e&&C.isEmpty(t))return 1/0;var o={computed:1/0,value:1/0};return B(t,function(t,n,s){var r=e?e.call(i,t,n,s):t;o.computed>r&&(o={value:t,computed:r})}),o.value},C.shuffle=function(t){var e,i=0,o=[];return B(t,function(t){e=C.random(i++),o[i-1]=o[e],o[e]=t}),o};var A=function(t){return C.isFunction(t)?t:function(e){return e[t]}};C.sortBy=function(t,e,i){var o=A(e);return C.pluck(C.map(t,function(t,e,n){return{value:t,index:e,criteria:o.call(i,t,e,n)}}).sort(function(t,e){var i=t.criteria,o=e.criteria;if(i!==o){if(i>o||void 0===i)return 1;if(o>i||void 0===o)return-1}return t.index<e.index?-1:1}),"value")};var M=function(t,e,i,o){var n={},s=A(null==e?C.identity:e);return B(t,function(e,r){var a=s.call(i,e,r,t);o(n,a,e)}),n};C.groupBy=function(t,e,i){return M(t,e,i,function(t,e,i){(C.has(t,e)?t[e]:t[e]=[]).push(i)})},C.countBy=function(t,e,i){return M(t,e,i,function(t,e){C.has(t,e)||(t[e]=0),t[e]++})},C.sortedIndex=function(t,e,i,o){i=null==i?C.identity:A(i);for(var n=i.call(o,e),s=0,r=t.length;r>s;){var a=s+r>>>1;n>i.call(o,t[a])?s=a+1:r=a}return s},C.toArray=function(t){return t?C.isArray(t)?a.call(t):t.length===+t.length?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:t.length===+t.length?t.length:C.keys(t).length},C.first=C.head=C.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:a.call(t,0,e)},C.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},C.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},C.rest=C.tail=C.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var V=function(t,e,i){return B(t,function(t){C.isArray(t)?e?r.apply(i,t):V(t,e,i):i.push(t)}),i};C.flatten=function(t,e){return V(t,e,[])},C.without=function(t){return C.difference(t,a.call(arguments,1))},C.uniq=C.unique=function(t,e,i,o){C.isFunction(e)&&(o=i,i=e,e=!1);var n=i?C.map(t,i,o):t,s=[],r=[];return B(n,function(i,o){(e?o&&r[r.length-1]===i:C.contains(r,i))||(r.push(i),s.push(t[o]))}),s},C.union=function(){return C.uniq(l.apply(o,arguments))},C.intersection=function(t){var e=a.call(arguments,1);return C.filter(C.uniq(t),function(t){return C.every(e,function(e){return C.indexOf(e,t)>=0})})},C.difference=function(t){var e=l.apply(o,a.call(arguments,1));return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){for(var t=a.call(arguments),e=C.max(C.pluck(t,"length")),i=new Array(e),o=0;e>o;o++)i[o]=C.pluck(t,""+o);return i},C.object=function(t,e){if(null==t)return{};for(var i={},o=0,n=t.length;n>o;o++)e?i[t[o]]=e[o]:i[t[o][0]]=t[o][1];return i},C.indexOf=function(t,e,i){if(null==t)return-1;var o=0,n=t.length;if(i){if("number"!=typeof i)return o=C.sortedIndex(t,e),t[o]===e?o:-1;o=0>i?Math.max(0,n+i):i}if(x&&t.indexOf===x)return t.indexOf(e,i);for(;n>o;o++)if(t[o]===e)return o;return-1},C.lastIndexOf=function(t,e,i){if(null==t)return-1;var o=null!=i;if(b&&t.lastIndexOf===b)return o?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var n=o?i:t.length;n--;)if(t[n]===e)return n;return-1},C.range=function(t,e,i){1>=arguments.length&&(e=t||0,t=0),i=arguments[2]||1;for(var o=Math.max(Math.ceil((e-t)/i),0),n=0,s=new Array(o);o>n;)s[n++]=t,t+=i;return s};var I=function(){};C.bind=function(t,e){var i,o;if(t.bind===w&&w)return w.apply(t,a.call(arguments,1));if(!C.isFunction(t))throw new TypeError;return i=a.call(arguments,2),o=function(){if(!(this instanceof o))return t.apply(e,i.concat(a.call(arguments)));I.prototype=t.prototype;var n=new I;I.prototype=null;var s=t.apply(n,i.concat(a.call(arguments)));return Object(s)===s?s:n}},C.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},C.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return B(e,function(e){t[e]=C.bind(t[e],t)}),t},C.memoize=function(t,e){var i={};return e||(e=C.identity),function(){var o=e.apply(this,arguments);return C.has(i,o)?i[o]:i[o]=t.apply(this,arguments)}},C.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},C.defer=function(t){return C.delay.apply(C,[t,1].concat(a.call(arguments,1)))},C.throttle=function(t,e){var i,o,n,s,r=0,a=function(){r=new Date,n=null,s=t.apply(i,o)};return function(){var l=new Date,c=e-(l-r);return i=this,o=arguments,0>=c?(clearTimeout(n),n=null,r=l,s=t.apply(i,o)):n||(n=setTimeout(a,c)),s}},C.debounce=function(t,e,i){var o,n;return function(){var s=this,r=arguments,a=function(){o=null,i||(n=t.apply(s,r))},l=i&&!o;return clearTimeout(o),o=setTimeout(a,e),l&&(n=t.apply(s,r)),n}},C.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},C.wrap=function(t,e){return function(){var i=[t];return r.apply(i,arguments),e.apply(this,i)}},C.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},C.after=function(t,e){return 0>=t?e():function(){return 1>--t?e.apply(this,arguments):void 0}},C.keys=v||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)C.has(t,i)&&(e[e.length]=i);return e},C.values=function(t){var e=[];for(var i in t)C.has(t,i)&&e.push(t[i]);return e},C.pairs=function(t){var e=[];for(var i in t)C.has(t,i)&&e.push([i,t[i]]);return e},C.invert=function(t){var e={};for(var i in t)C.has(t,i)&&(e[t[i]]=i);return e},C.functions=C.methods=function(t){var e=[];for(var i in t)C.isFunction(t[i])&&e.push(i);return e.sort()},C.extend=function(t){return B(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},C.pick=function(t){var e={},i=l.apply(o,a.call(arguments,1));return B(i,function(i){i in t&&(e[i]=t[i])}),e},C.omit=function(t){var e={},i=l.apply(o,a.call(arguments,1));for(var n in t)C.contains(i,n)||(e[n]=t[n]);return e},C.defaults=function(t){return B(a.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t};var T=function(t,e,i,o){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var n=c.call(t);if(n!=c.call(e))return!1;switch(n){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return o[s]==e;i.push(t),o.push(e);var r=0,a=!0;if("[object Array]"==n){if(r=t.length,a=r==e.length)for(;r--&&(a=T(t[r],e[r],i,o)););}else{var l=t.constructor,m=e.constructor;if(l!==m&&!(C.isFunction(l)&&l instanceof l&&C.isFunction(m)&&m instanceof m))return!1;for(var u in t)if(C.has(t,u)&&(r++,!(a=C.has(e,u)&&T(t[u],e[u],i,o))))break;if(a){for(u in e)if(C.has(e,u)&&!r--)break;a=!r}}return i.pop(),o.pop(),a};C.isEqual=function(t,e){return T(t,e,[],[])},C.isEmpty=function(t){if(null==t)return!0;if(C.isArray(t)||C.isString(t))return 0===t.length;for(var e in t)if(C.has(t,e))return!1;return!0},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=g||function(t){return"[object Array]"==c.call(t)},C.isObject=function(t){return t===Object(t)},B(["Arguments","Function","String","Number","Date","RegExp"],function(t){C["is"+t]=function(e){return c.call(e)=="[object "+t+"]"
}}),C.isArguments(arguments)||(C.isArguments=function(t){return!(!t||!C.has(t,"callee"))}),C.isFunction=function(t){return"function"==typeof t},C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!=+t},C.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return m.call(t,e)},C.noConflict=function(){return t._=e,this},C.identity=function(t){return t},C.times=function(t,e,i){for(var o=Array(t),n=0;t>n;n++)o[n]=e.call(i,n);return o},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=C.invert(G.escape);var L={escape:new RegExp("["+C.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+C.keys(G.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(t){C[t]=function(e){return null==e?"":(""+e).replace(L[t],function(e){return G[t][e]})}}),C.result=function(t,e){if(null==t)return void 0;var i=t[e];return C.isFunction(i)?i.call(t):i},C.mixin=function(t){B(C.functions(t),function(e){var i=C[e]=t[e];C.prototype[e]=function(){var t=[this._wrapped];return r.apply(t,arguments),N.call(this,i.apply(C,t))}})};var k=0;C.uniqueId=function(t){var e=++k+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(t,e,i){var o;i=C.defaults({},i,C.templateSettings);var n=new RegExp([(i.escape||F).source,(i.interpolate||F).source,(i.evaluate||F).source].join("|")+"|$","g"),s=0,r="__p+='";t.replace(n,function(e,i,o,n,a){return r+=t.slice(s,a).replace(P,function(t){return"\\"+R[t]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),o&&(r+="'+\n((__t=("+o+"))==null?'':__t)+\n'"),n&&(r+="';\n"+n+"\n__p+='"),s=a+e.length,e}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{o=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(e)return o(e,C);var l=function(t){return o.call(this,t,C)};return l.source="function("+(i.variable||"obj")+"){\n"+r+"}",l},C.chain=function(t){return C(t).chain()};var N=function(t){return this._chain?C(t).chain():t};C.mixin(C),B(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];C.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],N.call(this,i)}}),B(["concat","join","slice"],function(t){var e=o[t];C.prototype[t]=function(){return N.call(this,e.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);var Box2D={};(function(t,e){function i(){}!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(t,e,i){i.get instanceof Function&&t.__defineGetter__(e,i.get),i.set instanceof Function&&t.__defineSetter__(e,i.set)}),t.inherit=function(t,e){i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){t===e&&(t=0);for(var i=Array(t||0),o=0;t>o;++o)i[o]=0;return i},t.is=function(t,i){return null===t?!1:i instanceof Function&&t instanceof i?!0:t.constructor.__implements!=e&&t.constructor.__implements[i]?!0:!1},t.parseUInt=function(t){return Math.abs(parseInt(t))}})(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"==typeof Box2D&&(Box2D={}),"undefined"==typeof Box2D.Collision&&(Box2D.Collision={}),"undefined"==typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={}),"undefined"==typeof Box2D.Common&&(Box2D.Common={}),"undefined"==typeof Box2D.Common.Math&&(Box2D.Common.Math={}),"undefined"==typeof Box2D.Dynamics&&(Box2D.Dynamics={}),"undefined"==typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={}),"undefined"==typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={}),"undefined"==typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={}),function(){function t(){t.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function i(){i.b2BoundValues.apply(this,arguments),this.constructor===i&&this.b2BoundValues.apply(this,arguments)}function o(){o.b2Collision.apply(this,arguments)}function n(){n.b2ContactID.apply(this,arguments),this.constructor===n&&this.b2ContactID.apply(this,arguments)}function s(){s.b2ContactPoint.apply(this,arguments)}function r(){r.b2Distance.apply(this,arguments)}function a(){a.b2DistanceInput.apply(this,arguments)}function l(){l.b2DistanceOutput.apply(this,arguments)}function c(){c.b2DistanceProxy.apply(this,arguments)}function m(){m.b2DynamicTree.apply(this,arguments),this.constructor===m&&this.b2DynamicTree.apply(this,arguments)}function u(){u.b2DynamicTreeBroadPhase.apply(this,arguments)}function h(){h.b2DynamicTreeNode.apply(this,arguments)}function p(){p.b2DynamicTreePair.apply(this,arguments)}function _(){_.b2Manifold.apply(this,arguments),this.constructor===_&&this.b2Manifold.apply(this,arguments)}function y(){y.b2ManifoldPoint.apply(this,arguments),this.constructor===y&&this.b2ManifoldPoint.apply(this,arguments)}function f(){f.b2Point.apply(this,arguments)}function d(){d.b2RayCastInput.apply(this,arguments),this.constructor===d&&this.b2RayCastInput.apply(this,arguments)}function x(){x.b2RayCastOutput.apply(this,arguments)}function b(){b.b2Segment.apply(this,arguments)}function g(){g.b2SeparationFunction.apply(this,arguments)}function v(){v.b2Simplex.apply(this,arguments),this.constructor===v&&this.b2Simplex.apply(this,arguments)}function w(){w.b2SimplexCache.apply(this,arguments)}function C(){C.b2SimplexVertex.apply(this,arguments)}function B(){B.b2TimeOfImpact.apply(this,arguments)}function D(){D.b2TOIInput.apply(this,arguments)}function S(){S.b2WorldManifold.apply(this,arguments),this.constructor===S&&this.b2WorldManifold.apply(this,arguments)}function A(){A.ClipVertex.apply(this,arguments)}function M(){M.Features.apply(this,arguments)}function V(){V.b2CircleShape.apply(this,arguments),this.constructor===V&&this.b2CircleShape.apply(this,arguments)}function I(){I.b2EdgeChainDef.apply(this,arguments),this.constructor===I&&this.b2EdgeChainDef.apply(this,arguments)}function T(){T.b2EdgeShape.apply(this,arguments),this.constructor===T&&this.b2EdgeShape.apply(this,arguments)}function G(){G.b2MassData.apply(this,arguments)}function L(){L.b2PolygonShape.apply(this,arguments),this.constructor===L&&this.b2PolygonShape.apply(this,arguments)}function k(){k.b2Shape.apply(this,arguments),this.constructor===k&&this.b2Shape.apply(this,arguments)}function F(){F.b2Color.apply(this,arguments),this.constructor===F&&this.b2Color.apply(this,arguments)}function R(){R.b2Settings.apply(this,arguments)}function P(){P.b2Mat22.apply(this,arguments),this.constructor===P&&this.b2Mat22.apply(this,arguments)}function N(){N.b2Mat33.apply(this,arguments),this.constructor===N&&this.b2Mat33.apply(this,arguments)}function J(){J.b2Math.apply(this,arguments)}function E(){E.b2Sweep.apply(this,arguments)}function j(){j.b2Transform.apply(this,arguments),this.constructor===j&&this.b2Transform.apply(this,arguments)}function z(){z.b2Vec2.apply(this,arguments),this.constructor===z&&this.b2Vec2.apply(this,arguments)}function q(){q.b2Vec3.apply(this,arguments),this.constructor===q&&this.b2Vec3.apply(this,arguments)}function O(){O.b2Body.apply(this,arguments),this.constructor===O&&this.b2Body.apply(this,arguments)}function W(){W.b2BodyDef.apply(this,arguments),this.constructor===W&&this.b2BodyDef.apply(this,arguments)}function H(){H.b2ContactFilter.apply(this,arguments)}function U(){U.b2ContactImpulse.apply(this,arguments)}function X(){X.b2ContactListener.apply(this,arguments)}function K(){K.b2ContactManager.apply(this,arguments),this.constructor===K&&this.b2ContactManager.apply(this,arguments)}function $(){$.b2DebugDraw.apply(this,arguments),this.constructor===$&&this.b2DebugDraw.apply(this,arguments)}function Y(){Y.b2DestructionListener.apply(this,arguments)}function Z(){Z.b2FilterData.apply(this,arguments)}function Q(){Q.b2Fixture.apply(this,arguments),this.constructor===Q&&this.b2Fixture.apply(this,arguments)}function te(){te.b2FixtureDef.apply(this,arguments),this.constructor===te&&this.b2FixtureDef.apply(this,arguments)}function ee(){ee.b2Island.apply(this,arguments),this.constructor===ee&&this.b2Island.apply(this,arguments)}function ie(){ie.b2TimeStep.apply(this,arguments)}function oe(){oe.b2World.apply(this,arguments),this.constructor===oe&&this.b2World.apply(this,arguments)}function ne(){ne.b2CircleContact.apply(this,arguments)}function se(){se.b2Contact.apply(this,arguments),this.constructor===se&&this.b2Contact.apply(this,arguments)}function re(){re.b2ContactConstraint.apply(this,arguments),this.constructor===re&&this.b2ContactConstraint.apply(this,arguments)}function ae(){ae.b2ContactConstraintPoint.apply(this,arguments)}function le(){le.b2ContactEdge.apply(this,arguments)}function ce(){ce.b2ContactFactory.apply(this,arguments),this.constructor===ce&&this.b2ContactFactory.apply(this,arguments)}function me(){me.b2ContactRegister.apply(this,arguments)}function ue(){ue.b2ContactResult.apply(this,arguments)}function he(){he.b2ContactSolver.apply(this,arguments),this.constructor===he&&this.b2ContactSolver.apply(this,arguments)}function pe(){pe.b2EdgeAndCircleContact.apply(this,arguments)}function _e(){_e.b2NullContact.apply(this,arguments),this.constructor===_e&&this.b2NullContact.apply(this,arguments)}function ye(){ye.b2PolyAndCircleContact.apply(this,arguments)}function fe(){fe.b2PolyAndEdgeContact.apply(this,arguments)}function de(){de.b2PolygonContact.apply(this,arguments)}function xe(){xe.b2PositionSolverManifold.apply(this,arguments),this.constructor===xe&&this.b2PositionSolverManifold.apply(this,arguments)}function be(){be.b2BuoyancyController.apply(this,arguments)}function ge(){ge.b2ConstantAccelController.apply(this,arguments)}function ve(){ve.b2ConstantForceController.apply(this,arguments)}function we(){we.b2Controller.apply(this,arguments)}function Ce(){Ce.b2ControllerEdge.apply(this,arguments)}function Be(){Be.b2GravityController.apply(this,arguments)}function De(){De.b2TensorDampingController.apply(this,arguments)}function Se(){Se.b2DistanceJoint.apply(this,arguments),this.constructor===Se&&this.b2DistanceJoint.apply(this,arguments)}function Ae(){Ae.b2DistanceJointDef.apply(this,arguments),this.constructor===Ae&&this.b2DistanceJointDef.apply(this,arguments)}function Me(){Me.b2FrictionJoint.apply(this,arguments),this.constructor===Me&&this.b2FrictionJoint.apply(this,arguments)}function Ve(){Ve.b2FrictionJointDef.apply(this,arguments),this.constructor===Ve&&this.b2FrictionJointDef.apply(this,arguments)}function Ie(){Ie.b2GearJoint.apply(this,arguments),this.constructor===Ie&&this.b2GearJoint.apply(this,arguments)}function Te(){Te.b2GearJointDef.apply(this,arguments),this.constructor===Te&&this.b2GearJointDef.apply(this,arguments)}function Ge(){Ge.b2Jacobian.apply(this,arguments)}function Le(){Le.b2Joint.apply(this,arguments),this.constructor===Le&&this.b2Joint.apply(this,arguments)}function ke(){ke.b2JointDef.apply(this,arguments),this.constructor===ke&&this.b2JointDef.apply(this,arguments)}function Fe(){Fe.b2JointEdge.apply(this,arguments)}function Re(){Re.b2LineJoint.apply(this,arguments),this.constructor===Re&&this.b2LineJoint.apply(this,arguments)}function Pe(){Pe.b2LineJointDef.apply(this,arguments),this.constructor===Pe&&this.b2LineJointDef.apply(this,arguments)}function Ne(){Ne.b2MouseJoint.apply(this,arguments),this.constructor===Ne&&this.b2MouseJoint.apply(this,arguments)}function Je(){Je.b2MouseJointDef.apply(this,arguments),this.constructor===Je&&this.b2MouseJointDef.apply(this,arguments)}function Ee(){Ee.b2PrismaticJoint.apply(this,arguments),this.constructor===Ee&&this.b2PrismaticJoint.apply(this,arguments)}function je(){je.b2PrismaticJointDef.apply(this,arguments),this.constructor===je&&this.b2PrismaticJointDef.apply(this,arguments)}function ze(){ze.b2PulleyJoint.apply(this,arguments),this.constructor===ze&&this.b2PulleyJoint.apply(this,arguments)}function qe(){qe.b2PulleyJointDef.apply(this,arguments),this.constructor===qe&&this.b2PulleyJointDef.apply(this,arguments)}function Oe(){Oe.b2RevoluteJoint.apply(this,arguments),this.constructor===Oe&&this.b2RevoluteJoint.apply(this,arguments)}function We(){We.b2RevoluteJointDef.apply(this,arguments),this.constructor===We&&this.b2RevoluteJointDef.apply(this,arguments)}function He(){He.b2WeldJoint.apply(this,arguments),this.constructor===He&&this.b2WeldJoint.apply(this,arguments)}function Ue(){Ue.b2WeldJointDef.apply(this,arguments),this.constructor===Ue&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",Box2D.Collision.b2AABB=t,Box2D.Collision.b2Bound=e,Box2D.Collision.b2BoundValues=i,Box2D.Collision.b2Collision=o,Box2D.Collision.b2ContactID=n,Box2D.Collision.b2ContactPoint=s,Box2D.Collision.b2Distance=r,Box2D.Collision.b2DistanceInput=a,Box2D.Collision.b2DistanceOutput=l,Box2D.Collision.b2DistanceProxy=c,Box2D.Collision.b2DynamicTree=m,Box2D.Collision.b2DynamicTreeBroadPhase=u,Box2D.Collision.b2DynamicTreeNode=h,Box2D.Collision.b2DynamicTreePair=p,Box2D.Collision.b2Manifold=_,Box2D.Collision.b2ManifoldPoint=y,Box2D.Collision.b2Point=f,Box2D.Collision.b2RayCastInput=d,Box2D.Collision.b2RayCastOutput=x,Box2D.Collision.b2Segment=b,Box2D.Collision.b2SeparationFunction=g,Box2D.Collision.b2Simplex=v,Box2D.Collision.b2SimplexCache=w,Box2D.Collision.b2SimplexVertex=C,Box2D.Collision.b2TimeOfImpact=B,Box2D.Collision.b2TOIInput=D,Box2D.Collision.b2WorldManifold=S,Box2D.Collision.ClipVertex=A,Box2D.Collision.Features=M,Box2D.Collision.Shapes.b2CircleShape=V,Box2D.Collision.Shapes.b2EdgeChainDef=I,Box2D.Collision.Shapes.b2EdgeShape=T,Box2D.Collision.Shapes.b2MassData=G,Box2D.Collision.Shapes.b2PolygonShape=L,Box2D.Collision.Shapes.b2Shape=k,Box2D.Common.b2internal="Box2D.Common.b2internal",Box2D.Common.b2Color=F,Box2D.Common.b2Settings=R,Box2D.Common.Math.b2Mat22=P,Box2D.Common.Math.b2Mat33=N,Box2D.Common.Math.b2Math=J,Box2D.Common.Math.b2Sweep=E,Box2D.Common.Math.b2Transform=j,Box2D.Common.Math.b2Vec2=z,Box2D.Common.Math.b2Vec3=q,Box2D.Dynamics.b2Body=O,Box2D.Dynamics.b2BodyDef=W,Box2D.Dynamics.b2ContactFilter=H,Box2D.Dynamics.b2ContactImpulse=U,Box2D.Dynamics.b2ContactListener=X,Box2D.Dynamics.b2ContactManager=K,Box2D.Dynamics.b2DebugDraw=$,Box2D.Dynamics.b2DestructionListener=Y,Box2D.Dynamics.b2FilterData=Z,Box2D.Dynamics.b2Fixture=Q,Box2D.Dynamics.b2FixtureDef=te,Box2D.Dynamics.b2Island=ee,Box2D.Dynamics.b2TimeStep=ie,Box2D.Dynamics.b2World=oe,Box2D.Dynamics.Contacts.b2CircleContact=ne,Box2D.Dynamics.Contacts.b2Contact=se,Box2D.Dynamics.Contacts.b2ContactConstraint=re,Box2D.Dynamics.Contacts.b2ContactConstraintPoint=ae,Box2D.Dynamics.Contacts.b2ContactEdge=le,Box2D.Dynamics.Contacts.b2ContactFactory=ce,Box2D.Dynamics.Contacts.b2ContactRegister=me,Box2D.Dynamics.Contacts.b2ContactResult=ue,Box2D.Dynamics.Contacts.b2ContactSolver=he,Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=pe,Box2D.Dynamics.Contacts.b2NullContact=_e,Box2D.Dynamics.Contacts.b2PolyAndCircleContact=ye,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=fe,Box2D.Dynamics.Contacts.b2PolygonContact=de,Box2D.Dynamics.Contacts.b2PositionSolverManifold=xe,Box2D.Dynamics.Controllers.b2BuoyancyController=be,Box2D.Dynamics.Controllers.b2ConstantAccelController=ge,Box2D.Dynamics.Controllers.b2ConstantForceController=ve,Box2D.Dynamics.Controllers.b2Controller=we,Box2D.Dynamics.Controllers.b2ControllerEdge=Ce,Box2D.Dynamics.Controllers.b2GravityController=Be,Box2D.Dynamics.Controllers.b2TensorDampingController=De,Box2D.Dynamics.Joints.b2DistanceJoint=Se,Box2D.Dynamics.Joints.b2DistanceJointDef=Ae,Box2D.Dynamics.Joints.b2FrictionJoint=Me,Box2D.Dynamics.Joints.b2FrictionJointDef=Ve,Box2D.Dynamics.Joints.b2GearJoint=Ie,Box2D.Dynamics.Joints.b2GearJointDef=Te,Box2D.Dynamics.Joints.b2Jacobian=Ge,Box2D.Dynamics.Joints.b2Joint=Le,Box2D.Dynamics.Joints.b2JointDef=ke,Box2D.Dynamics.Joints.b2JointEdge=Fe,Box2D.Dynamics.Joints.b2LineJoint=Re,Box2D.Dynamics.Joints.b2LineJointDef=Pe,Box2D.Dynamics.Joints.b2MouseJoint=Ne,Box2D.Dynamics.Joints.b2MouseJointDef=Je,Box2D.Dynamics.Joints.b2PrismaticJoint=Ee,Box2D.Dynamics.Joints.b2PrismaticJointDef=je,Box2D.Dynamics.Joints.b2PulleyJoint=ze,Box2D.Dynamics.Joints.b2PulleyJointDef=qe,Box2D.Dynamics.Joints.b2RevoluteJoint=Oe,Box2D.Dynamics.Joints.b2RevoluteJointDef=We,Box2D.Dynamics.Joints.b2WeldJoint=He,Box2D.Dynamics.Joints.b2WeldJointDef=Ue}(),Box2D.postDefs=[],function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=Box2D.Collision.Shapes.b2PolygonShape,i=Box2D.Collision.Shapes.b2Shape,o=Box2D.Common.b2Settings,n=Box2D.Common.Math.b2Math,s=Box2D.Common.Math.b2Sweep,r=Box2D.Common.Math.b2Transform,a=Box2D.Common.Math.b2Vec2,l=Box2D.Collision.b2AABB,c=Box2D.Collision.b2Bound,m=Box2D.Collision.b2BoundValues,u=Box2D.Collision.b2Collision,h=Box2D.Collision.b2ContactID,p=Box2D.Collision.b2ContactPoint,_=Box2D.Collision.b2Distance,y=Box2D.Collision.b2DistanceInput,f=Box2D.Collision.b2DistanceOutput,d=Box2D.Collision.b2DistanceProxy,x=Box2D.Collision.b2DynamicTree,b=Box2D.Collision.b2DynamicTreeBroadPhase,g=Box2D.Collision.b2DynamicTreeNode,v=Box2D.Collision.b2DynamicTreePair,w=Box2D.Collision.b2Manifold,C=Box2D.Collision.b2ManifoldPoint,B=Box2D.Collision.b2Point,D=Box2D.Collision.b2RayCastInput,S=Box2D.Collision.b2RayCastOutput,A=Box2D.Collision.b2Segment,M=Box2D.Collision.b2SeparationFunction,V=Box2D.Collision.b2Simplex,I=Box2D.Collision.b2SimplexCache,T=Box2D.Collision.b2SimplexVertex,G=Box2D.Collision.b2TimeOfImpact,L=Box2D.Collision.b2TOIInput,k=Box2D.Collision.b2WorldManifold,F=Box2D.Collision.ClipVertex,R=Box2D.Collision.Features,P=Box2D.Collision.IBroadPhase;l.b2AABB=function(){this.lowerBound=new a,this.upperBound=new a},l.prototype.IsValid=function(){var t=this.upperBound.y-this.lowerBound.y;return t=(t=this.upperBound.x-this.lowerBound.x>=0&&t>=0)&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},l.prototype.GetCenter=function(){return new a((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},l.prototype.GetExtents=function(){return new a((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},l.prototype.Contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},l.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,o=Number.MAX_VALUE,n=e.p1.x,s=e.p1.y,r=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(a),c=t.normal,m=0,u=0,h=m=0;if(h=0,Math.abs(r)<Number.MIN_VALUE){if(this.lowerBound.x>n||n>this.upperBound.x)return!1}else if(m=1/r,u=(this.lowerBound.x-n)*m,m=(this.upperBound.x-n)*m,h=-1,u>m&&(h=u,u=m,m=h,h=1),u>i&&(c.x=h,c.y=0,i=u),o=Math.min(o,m),i>o)return!1;if(Number.MIN_VALUE>l){if(this.lowerBound.y>s||s>this.upperBound.y)return!1}else if(m=1/a,u=(this.lowerBound.y-s)*m,m=(this.upperBound.y-s)*m,h=-1,u>m&&(h=u,u=m,m=h,h=1),u>i&&(c.y=h,c.x=0,i=u),o=Math.min(o,m),i>o)return!1;return t.fraction=i,!0},l.prototype.TestOverlap=function(t){var e=t.lowerBound.y-this.upperBound.y,i=this.lowerBound.y-t.upperBound.y;return t.lowerBound.x-this.upperBound.x>0||e>0?!1:this.lowerBound.x-t.upperBound.x>0||i>0?!1:!0},l.Combine=function(t,e){var i=new l;return i.Combine(t,e),i},l.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},c.b2Bound=function(){},c.prototype.IsLower=function(){return 0==(1&this.value)},c.prototype.IsUpper=function(){return 1==(1&this.value)},c.prototype.Swap=function(t){var e=this.value,i=this.proxy,o=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=o},m.b2BoundValues=function(){},m.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},u.b2Collision=function(){},u.ClipSegmentToLine=function(t,e,i,o){void 0===o&&(o=0);var n,s=0;n=e[0];var r=n.v;n=e[1];var a=n.v,l=i.x*r.x+i.y*r.y-o;return n=i.x*a.x+i.y*a.y-o,0>=l&&t[s++].Set(e[0]),0>=n&&t[s++].Set(e[1]),0>l*n&&(i=l/(l-n),n=t[s],n=n.v,n.x=r.x+i*(a.x-r.x),n.y=r.y+i*(a.y-r.y),n=t[s],n.id=(l>0?e[0]:e[1]).id,++s),s},u.EdgeSeparation=function(t,e,i,o,n){void 0===i&&(i=0),parseInt(t.m_vertexCount);var s=t.m_vertices;t=t.m_normals;var r,a,l=parseInt(o.m_vertexCount),c=o.m_vertices;r=e.R,a=t[i],t=r.col1.x*a.x+r.col2.x*a.y,o=r.col1.y*a.x+r.col2.y*a.y,r=n.R;var m=r.col1.x*t+r.col1.y*o;r=r.col2.x*t+r.col2.y*o;for(var u=0,h=Number.MAX_VALUE,p=0;l>p;++p)a=c[p],a=a.x*m+a.y*r,h>a&&(h=a,u=p);return a=s[i],r=e.R,i=e.position.x+(r.col1.x*a.x+r.col2.x*a.y),e=e.position.y+(r.col1.y*a.x+r.col2.y*a.y),a=c[u],r=n.R,s=n.position.x+(r.col1.x*a.x+r.col2.x*a.y),n=n.position.y+(r.col1.y*a.x+r.col2.y*a.y),s-=i,n-=e,s*t+n*o},u.FindMaxSeparation=function(t,e,i,o,n){var s,r,a=parseInt(e.m_vertexCount),l=e.m_normals;r=n.R,s=o.m_centroid;var c=n.position.x+(r.col1.x*s.x+r.col2.x*s.y),m=n.position.y+(r.col1.y*s.x+r.col2.y*s.y);r=i.R,s=e.m_centroid,c-=i.position.x+(r.col1.x*s.x+r.col2.x*s.y),m-=i.position.y+(r.col1.y*s.x+r.col2.y*s.y),r=c*i.R.col1.x+m*i.R.col1.y,m=c*i.R.col2.x+m*i.R.col2.y,c=0;for(var h=-Number.MAX_VALUE,p=0;a>p;++p)s=l[p],s=s.x*r+s.y*m,s>h&&(h=s,c=p);l=u.EdgeSeparation(e,i,c,o,n),s=parseInt(c-1>=0?c-1:a-1),r=u.EdgeSeparation(e,i,s,o,n),m=parseInt(a>c+1?c+1:0),h=u.EdgeSeparation(e,i,m,o,n);var _=p=0,y=0;if(r>l&&r>h)y=-1,p=s,_=r;else{if(!(h>l))return t[0]=c,l;y=1,p=m,_=h}for(;c=-1==y?p-1>=0?p-1:a-1:a>p+1?p+1:0,l=u.EdgeSeparation(e,i,c,o,n),l>_;)p=c,_=l;return t[0]=p,_},u.FindIncidentEdge=function(t,e,i,o,n,s){void 0===o&&(o=0),parseInt(e.m_vertexCount);var r=e.m_normals,a=parseInt(n.m_vertexCount);e=n.m_vertices,n=n.m_normals;var l;l=i.R,i=r[o],r=l.col1.x*i.x+l.col2.x*i.y;var c=l.col1.y*i.x+l.col2.y*i.y;l=s.R,i=l.col1.x*r+l.col1.y*c,c=l.col2.x*r+l.col2.y*c,r=i,l=0;for(var m=Number.MAX_VALUE,u=0;a>u;++u)i=n[u],i=r*i.x+c*i.y,m>i&&(m=i,l=u);n=parseInt(l),r=parseInt(a>n+1?n+1:0),a=t[0],i=e[n],l=s.R,a.v.x=s.position.x+(l.col1.x*i.x+l.col2.x*i.y),a.v.y=s.position.y+(l.col1.y*i.x+l.col2.y*i.y),a.id.features.referenceEdge=o,a.id.features.incidentEdge=n,a.id.features.incidentVertex=0,a=t[1],i=e[r],l=s.R,a.v.x=s.position.x+(l.col1.x*i.x+l.col2.x*i.y),a.v.y=s.position.y+(l.col1.y*i.x+l.col2.y*i.y),a.id.features.referenceEdge=o,a.id.features.incidentEdge=r,a.id.features.incidentVertex=1},u.MakeClipPointVector=function(){var t=new Vector(2);return t[0]=new F,t[1]=new F,t},u.CollidePolygons=function(t,e,i,n,s){var r;t.m_pointCount=0;var a=e.m_radius+n.m_radius;r=0,u.s_edgeAO[0]=r;var l=u.FindMaxSeparation(u.s_edgeAO,e,i,n,s);if(r=u.s_edgeAO[0],!(l>a)){var c=0;u.s_edgeBO[0]=c;var m=u.FindMaxSeparation(u.s_edgeBO,n,s,e,i);if(c=u.s_edgeBO[0],!(m>a)){var h=0,p=0;m>.98*l+.001?(l=n,n=e,e=s,i=i,h=c,t.m_type=w.e_faceB,p=1):(l=e,n=n,e=i,i=s,h=r,t.m_type=w.e_faceA,p=0),r=u.s_incidentEdge,u.FindIncidentEdge(r,l,e,h,n,i),c=parseInt(l.m_vertexCount),s=l.m_vertices,l=s[h];var _;_=c>h+1?s[parseInt(h+1)]:s[0],h=u.s_localTangent,h.Set(_.x-l.x,_.y-l.y),h.Normalize(),s=u.s_localNormal,s.x=h.y,s.y=-h.x,n=u.s_planePoint,n.Set(.5*(l.x+_.x),.5*(l.y+_.y)),m=u.s_tangent,c=e.R,m.x=c.col1.x*h.x+c.col2.x*h.y,m.y=c.col1.y*h.x+c.col2.y*h.y;var y=u.s_tangent2;y.x=-m.x,y.y=-m.y,h=u.s_normal,h.x=m.y,h.y=-m.x;var f=u.s_v11,d=u.s_v12;if(f.x=e.position.x+(c.col1.x*l.x+c.col2.x*l.y),f.y=e.position.y+(c.col1.y*l.x+c.col2.y*l.y),d.x=e.position.x+(c.col1.x*_.x+c.col2.x*_.y),d.y=e.position.y+(c.col1.y*_.x+c.col2.y*_.y),e=h.x*f.x+h.y*f.y,c=m.x*d.x+m.y*d.y+a,_=u.s_clipPoints1,l=u.s_clipPoints2,d=0,d=u.ClipSegmentToLine(_,r,y,-m.x*f.x-m.y*f.y+a),!(2>d||(d=u.ClipSegmentToLine(l,_,m,c),2>d))){for(t.m_localPlaneNormal.SetV(s),t.m_localPoint.SetV(n),n=s=0;o.b2_maxManifoldPoints>n;++n)r=l[n],a>=h.x*r.v.x+h.y*r.v.y-e&&(m=t.m_points[s],c=i.R,y=r.v.x-i.position.x,f=r.v.y-i.position.y,m.m_localPoint.x=y*c.col1.x+f*c.col1.y,m.m_localPoint.y=y*c.col2.x+f*c.col2.y,m.m_id.Set(r.id),m.m_id.features.flip=p,++s);t.m_pointCount=s}}}},u.CollideCircles=function(t,e,i,o,n){t.m_pointCount=0;var s,r;s=i.R,r=e.m_p;var a=i.position.x+(s.col1.x*r.x+s.col2.x*r.y);i=i.position.y+(s.col1.y*r.x+s.col2.y*r.y),s=n.R,r=o.m_p,a=n.position.x+(s.col1.x*r.x+s.col2.x*r.y)-a,n=n.position.y+(s.col1.y*r.x+s.col2.y*r.y)-i,s=e.m_radius+o.m_radius,a*a+n*n>s*s||(t.m_type=w.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(o.m_p),t.m_points[0].m_id.key=0)},u.CollidePolygonAndCircle=function(t,e,i,o,n){var s,r,a=t.m_pointCount=0,l=0;r=n.R,s=o.m_p;var c=n.position.y+(r.col1.y*s.x+r.col2.y*s.y);a=n.position.x+(r.col1.x*s.x+r.col2.x*s.y)-i.position.x,l=c-i.position.y,r=i.R,i=a*r.col1.x+l*r.col1.y,r=a*r.col2.x+l*r.col2.y;var m=0;c=-Number.MAX_VALUE,n=e.m_radius+o.m_radius;var u=parseInt(e.m_vertexCount),h=e.m_vertices;e=e.m_normals;for(var p=0;u>p;++p){if(s=h[p],a=i-s.x,l=r-s.y,s=e[p],a=s.x*a+s.y*l,a>n)return;a>c&&(c=a,m=p)}if(a=parseInt(m),l=parseInt(u>a+1?a+1:0),s=h[a],h=h[l],Number.MIN_VALUE>c)t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.SetV(e[m]),t.m_localPoint.x=.5*(s.x+h.x),t.m_localPoint.y=.5*(s.y+h.y);else if(c=(i-h.x)*(s.x-h.x)+(r-h.y)*(s.y-h.y),0>=(i-s.x)*(h.x-s.x)+(r-s.y)*(h.y-s.y)){if((i-s.x)*(i-s.x)+(r-s.y)*(r-s.y)>n*n)return;t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.x=i-s.x,t.m_localPlaneNormal.y=r-s.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(s)}else if(0>=c){if((i-h.x)*(i-h.x)+(r-h.y)*(r-h.y)>n*n)return;t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.x=i-h.x,t.m_localPlaneNormal.y=r-h.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(h)}else{if(m=.5*(s.x+h.x),s=.5*(s.y+h.y),c=(i-m)*e[a].x+(r-s)*e[a].y,c>n)return;t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.x=e[a].x,t.m_localPlaneNormal.y=e[a].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(m,s)}t.m_points[0].m_localPoint.SetV(o.m_p),t.m_points[0].m_id.key=0},u.TestOverlap=function(t,e){var i=e.lowerBound,o=t.upperBound,n=i.x-o.x,s=i.y-o.y;i=t.lowerBound,o=e.upperBound;var r=i.y-o.y;return n>0||s>0?!1:i.x-o.x>0||r>0?!1:!0},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=u.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=u.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=u.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new a,Box2D.Collision.b2Collision.s_localNormal=new a,Box2D.Collision.b2Collision.s_planePoint=new a,Box2D.Collision.b2Collision.s_normal=new a,Box2D.Collision.b2Collision.s_tangent=new a,Box2D.Collision.b2Collision.s_tangent2=new a,Box2D.Collision.b2Collision.s_v11=new a,Box2D.Collision.b2Collision.s_v12=new a,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new a,Box2D.Collision.b2Collision.b2_nullFeature=255}),h.b2ContactID=function(){this.features=new R},h.prototype.b2ContactID=function(){this.features._m_id=this},h.prototype.Set=function(t){this.key=t._key},h.prototype.Copy=function(){var t=new h;return t.key=this.key,t},Object.defineProperty(h.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(h.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=255&(65280&this._key)>>8,this.features._incidentVertex=255&(16711680&this._key)>>16,this.features._flip=255&(4278190080&this._key)>>24}}),p.b2ContactPoint=function(){this.position=new a,this.velocity=new a,this.normal=new a,this.id=new h},_.b2Distance=function(){},_.Distance=function(t,e,i){++_.b2_gjkCalls;var s=i.proxyA,r=i.proxyB,l=i.transformA,c=i.transformB,m=_.s_simplex;m.ReadCache(e,s,l,r,c);var u=m.m_vertices,h=_.s_saveA,p=_.s_saveB,y=0;m.GetClosestPoint().LengthSquared();for(var f,d=0,x=0;20>x;){for(y=m.m_count,d=0;y>d;d++)h[d]=u[d].indexA,p[d]=u[d].indexB;switch(m.m_count){case 1:break;case 2:m.Solve2();break;case 3:m.Solve3();break;default:o.b2Assert(!1)}if(3==m.m_count)break;if(f=m.GetClosestPoint(),f.LengthSquared(),d=m.GetSearchDirection(),d.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;f=u[m.m_count],f.indexA=s.GetSupport(n.MulTMV(l.R,d.GetNegative())),f.wA=n.MulX(l,s.GetVertex(f.indexA)),f.indexB=r.GetSupport(n.MulTMV(c.R,d)),f.wB=n.MulX(c,r.GetVertex(f.indexB)),f.w=n.SubtractVV(f.wB,f.wA),++x,++_.b2_gjkIters;var b=!1;for(d=0;y>d;d++)if(f.indexA==h[d]&&f.indexB==p[d]){b=!0;break}if(b)break;++m.m_count}_.b2_gjkMaxIters=n.Max(_.b2_gjkMaxIters,x),m.GetWitnessPoints(t.pointA,t.pointB),t.distance=n.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=x,m.WriteCache(e),i.useRadii&&(e=s.m_radius,r=r.m_radius,t.distance>e+r&&t.distance>Number.MIN_VALUE?(t.distance-=e+r,i=n.SubtractVV(t.pointB,t.pointA),i.Normalize(),t.pointA.x+=e*i.x,t.pointA.y+=e*i.y,t.pointB.x-=r*i.x,t.pointB.y-=r*i.y):(f=new a,f.x=.5*(t.pointA.x+t.pointB.x),f.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=f.x,t.pointA.y=t.pointB.y=f.y,t.distance=0))},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new V,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),y.b2DistanceInput=function(){},f.b2DistanceOutput=function(){this.pointA=new a,this.pointB=new a},d.b2DistanceProxy=function(){},d.prototype.Set=function(n){switch(n.GetType()){case i.e_circleShape:n=n instanceof t?n:null,this.m_vertices=new Vector(1,!0),this.m_vertices[0]=n.m_p,this.m_count=1,this.m_radius=n.m_radius;break;case i.e_polygonShape:n=n instanceof e?n:null,this.m_vertices=n.m_vertices,this.m_count=n.m_vertexCount,this.m_radius=n.m_radius;break;default:o.b2Assert(!1)}},d.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;this.m_count>o;++o){var n=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;n>i&&(e=o,i=n)}return e},d.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;this.m_count>o;++o){var n=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;n>i&&(e=o,i=n)}return this.m_vertices[e]},d.prototype.GetVertexCount=function(){return this.m_count},d.prototype.GetVertex=function(t){return void 0===t&&(t=0),o.b2Assert(t>=0&&this.m_count>t),this.m_vertices[t]},x.b2DynamicTree=function(){},x.prototype.b2DynamicTree=function(){this.m_freeList=this.m_root=null,this.m_insertionCount=this.m_path=0},x.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),n=o.b2_aabbExtension,s=o.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-n,i.aabb.lowerBound.y=t.lowerBound.y-s,i.aabb.upperBound.x=t.upperBound.x+n,i.aabb.upperBound.y=t.upperBound.y+s,i.userData=e,this.InsertLeaf(i),i},x.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},x.prototype.MoveProxy=function(t,e,i){if(o.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var n=o.b2_aabbExtension+o.b2_aabbMultiplier*(i.x>0?i.x:-i.x);return i=o.b2_aabbExtension+o.b2_aabbMultiplier*(i.y>0?i.y:-i.y),t.aabb.lowerBound.x=e.lowerBound.x-n,t.aabb.lowerBound.y=e.lowerBound.y-i,t.aabb.upperBound.x=e.upperBound.x+n,t.aabb.upperBound.y=e.upperBound.y+i,this.InsertLeaf(t),!0},x.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;t>e;e++){for(var i=this.m_root,o=0;0==i.IsLeaf();)i=1&this.m_path>>o?i.child2:i.child1,o=31&o+1;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},x.prototype.GetFatAABB=function(t){return t.aabb},x.prototype.GetUserData=function(t){return t.userData},x.prototype.Query=function(t,e){if(null!=this.m_root){var i=new Vector,o=0;for(i[o++]=this.m_root;o>0;){var n=i[--o];if(n.aabb.TestOverlap(e))if(n.IsLeaf()){if(!t(n))break}else i[o++]=n.child1,i[o++]=n.child2}}},x.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,o=e.p2,s=n.SubtractVV(i,o);
s.Normalize(),s=n.CrossFV(1,s);var r=n.AbsV(s),a=e.maxFraction,c=new l,m=0,u=0;m=i.x+a*(o.x-i.x),u=i.y+a*(o.y-i.y),c.lowerBound.x=Math.min(i.x,m),c.lowerBound.y=Math.min(i.y,u),c.upperBound.x=Math.max(i.x,m),c.upperBound.y=Math.max(i.y,u);var h=new Vector,p=0;for(h[p++]=this.m_root;p>0;)if(a=h[--p],0!=a.aabb.TestOverlap(c)&&(m=a.aabb.GetCenter(),u=a.aabb.GetExtents(),!(Math.abs(s.x*(i.x-m.x)+s.y*(i.y-m.y))-r.x*u.x-r.y*u.y>0)))if(a.IsLeaf()){if(m=new D,m.p1=e.p1,m.p2=e.p2,m.maxFraction=e.maxFraction,a=t(m,a),0==a)break;a>0&&(m=i.x+a*(o.x-i.x),u=i.y+a*(o.y-i.y),c.lowerBound.x=Math.min(i.x,m),c.lowerBound.y=Math.min(i.y,u),c.upperBound.x=Math.max(i.x,m),c.upperBound.y=Math.max(i.y,u))}else h[p++]=a.child1,h[p++]=a.child2}},x.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new g},x.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},x.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)this.m_root=t,this.m_root.parent=null;else{var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var o=i.child1;i=i.child2,i=Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-e.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-e.y)<Math.abs((i.aabb.lowerBound.x+i.aabb.upperBound.x)/2-e.x)+Math.abs((i.aabb.lowerBound.y+i.aabb.upperBound.y)/2-e.y)?o:i}while(0==i.IsLeaf());if(e=i.parent,o=this.AllocateNode(),o.parent=e,o.userData=null,o.aabb.Combine(t.aabb,i.aabb),e){i.parent.child1==i?e.child1=o:e.child2=o,o.child1=i,o.child2=t,i.parent=o,t.parent=o;do{if(e.aabb.Contains(o.aabb))break;e.aabb.Combine(e.child1.aabb,e.child2.aabb),o=e,e=e.parent}while(e)}else o.child1=i,o.child2=t,i.parent=o,this.m_root=t.parent=o}},x.prototype.RemoveLeaf=function(t){if(t==this.m_root)this.m_root=null;else{var e=t.parent,i=e.parent;if(t=e.child1==t?e.child2:e.child1,i)for(i.child1==e?i.child1=t:i.child2=t,t.parent=i,this.FreeNode(e);i&&(e=i.aabb,i.aabb=l.Combine(i.child1.aabb,i.child2.aabb),!e.Contains(i.aabb));)i=i.parent;else this.m_root=t,t.parent=null,this.FreeNode(e)}},b.b2DynamicTreeBroadPhase=function(){this.m_tree=new x,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},b.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},b.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},b.prototype.MoveProxy=function(t,e,i){this.m_tree.MoveProxy(t,e,i)&&this.BufferMove(t)},b.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),o=this.m_tree.GetFatAABB(e);return i.TestOverlap(o)},b.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},b.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},b.prototype.GetProxyCount=function(){return this.m_proxyCount},b.prototype.UpdatePairs=function(t){var e,i=this,o=i.m_pairCount=0;for(o=0;i.m_moveBuffer.length>o;++o){e=i.m_moveBuffer[o];var n=i.m_tree.GetFatAABB(e);i.m_tree.Query(function(t){if(t==e)return!0;i.m_pairCount==i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new v);var o=i.m_pairBuffer[i.m_pairCount];return o.proxyA=e>t?t:e,o.proxyB=t>=e?t:e,++i.m_pairCount,!0},n)}for(o=i.m_moveBuffer.length=0;i.m_pairCount>o;){n=i.m_pairBuffer[o];var s=i.m_tree.GetUserData(n.proxyA),r=i.m_tree.GetUserData(n.proxyB);for(t(s,r),++o;i.m_pairCount>o&&(s=i.m_pairBuffer[o],s.proxyA==n.proxyA&&s.proxyB==n.proxyB);)++o}},b.prototype.Query=function(t,e){this.m_tree.Query(t,e)},b.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},b.prototype.Validate=function(){},b.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},b.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},b.prototype.UnBufferMove=function(t){this.m_moveBuffer.splice(parseInt(this.m_moveBuffer.indexOf(t)),1)},b.prototype.ComparePairs=function(){return 0},b.__implements={},b.__implements[P]=!0,g.b2DynamicTreeNode=function(){this.aabb=new l},g.prototype.IsLeaf=function(){return null==this.child1},v.b2DynamicTreePair=function(){},w.b2Manifold=function(){this.m_pointCount=0},w.prototype.b2Manifold=function(){this.m_points=new Vector(o.b2_maxManifoldPoints);for(var t=0;o.b2_maxManifoldPoints>t;t++)this.m_points[t]=new C;this.m_localPlaneNormal=new a,this.m_localPoint=new a},w.prototype.Reset=function(){for(var t=0;o.b2_maxManifoldPoints>t;t++)(this.m_points[t]instanceof C?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_pointCount=this.m_type=0},w.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;o.b2_maxManifoldPoints>e;e++)(this.m_points[e]instanceof C?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},w.prototype.Copy=function(){var t=new w;return t.Set(this),t},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),C.b2ManifoldPoint=function(){this.m_localPoint=new a,this.m_id=new h},C.prototype.b2ManifoldPoint=function(){this.Reset()},C.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_tangentImpulse=this.m_normalImpulse=0,this.m_id.key=0},C.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},B.b2Point=function(){this.p=new a},B.prototype.Support=function(){return this.p},B.prototype.GetFirstVertex=function(){return this.p},D.b2RayCastInput=function(){this.p1=new a,this.p2=new a},D.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},S.b2RayCastOutput=function(){this.normal=new a},A.b2Segment=function(){this.p1=new a,this.p2=new a},A.prototype.TestSegment=function(t,e,i,o){void 0===o&&(o=0);var n=i.p1,s=i.p2.x-n.x,r=i.p2.y-n.y;i=this.p2.y-this.p1.y;var a=-(this.p2.x-this.p1.x),l=100*Number.MIN_VALUE,c=-(s*i+r*a);if(c>l){var m=n.x-this.p1.x,u=n.y-this.p1.y;if(n=m*i+u*a,n>=0&&o*c>=n&&(o=-s*u+r*m,o>=-l*c&&c*(1+l)>=o))return n/=c,o=Math.sqrt(i*i+a*a),i/=o,a/=o,t[0]=n,e.Set(i,a),!0}return!1},A.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},A.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y;t=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:0>e?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p1.y)/i:0>i?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY),this.p2.x=this.p1.x+e*t,this.p2.y=this.p1.y+i*t},A.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y;t=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:0>e?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p2.y)/i:0>i?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY),this.p1.x=this.p2.x+e*t,this.p1.y=this.p2.y+i*t},M.b2SeparationFunction=function(){this.m_localPoint=new a,this.m_axis=new a},M.prototype.Initialize=function(t,e,i,s,r){this.m_proxyA=e,this.m_proxyB=s;var l=parseInt(t.count);o.b2Assert(l>0&&3>l);var c,m,u,h,p=h=u=s=e=0,_=0;p=0,1==l?(this.m_type=M.e_points,c=this.m_proxyA.GetVertex(t.indexA[0]),m=this.m_proxyB.GetVertex(t.indexB[0]),l=c,t=i.R,e=i.position.x+(t.col1.x*l.x+t.col2.x*l.y),s=i.position.y+(t.col1.y*l.x+t.col2.y*l.y),l=m,t=r.R,u=r.position.x+(t.col1.x*l.x+t.col2.x*l.y),h=r.position.y+(t.col1.y*l.x+t.col2.y*l.y),this.m_axis.x=u-e,this.m_axis.y=h-s,this.m_axis.Normalize()):(t.indexB[0]==t.indexB[1]?(this.m_type=M.e_faceA,e=this.m_proxyA.GetVertex(t.indexA[0]),s=this.m_proxyA.GetVertex(t.indexA[1]),m=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(e.x+s.x),this.m_localPoint.y=.5*(e.y+s.y),this.m_axis=n.CrossVF(n.SubtractVV(s,e),1),this.m_axis.Normalize(),l=this.m_axis,t=i.R,p=t.col1.x*l.x+t.col2.x*l.y,_=t.col1.y*l.x+t.col2.y*l.y,l=this.m_localPoint,t=i.R,e=i.position.x+(t.col1.x*l.x+t.col2.x*l.y),s=i.position.y+(t.col1.y*l.x+t.col2.y*l.y),l=m,t=r.R,u=r.position.x+(t.col1.x*l.x+t.col2.x*l.y),h=r.position.y+(t.col1.y*l.x+t.col2.y*l.y),p=(u-e)*p+(h-s)*_):t.indexA[0]==t.indexA[0]?(this.m_type=M.e_faceB,u=this.m_proxyB.GetVertex(t.indexB[0]),h=this.m_proxyB.GetVertex(t.indexB[1]),c=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(u.x+h.x),this.m_localPoint.y=.5*(u.y+h.y),this.m_axis=n.CrossVF(n.SubtractVV(h,u),1),this.m_axis.Normalize(),l=this.m_axis,t=r.R,p=t.col1.x*l.x+t.col2.x*l.y,_=t.col1.y*l.x+t.col2.y*l.y,l=this.m_localPoint,t=r.R,u=r.position.x+(t.col1.x*l.x+t.col2.x*l.y),h=r.position.y+(t.col1.y*l.x+t.col2.y*l.y),l=c,t=i.R,e=i.position.x+(t.col1.x*l.x+t.col2.x*l.y),s=i.position.y+(t.col1.y*l.x+t.col2.y*l.y),p=(e-u)*p+(s-h)*_):(e=this.m_proxyA.GetVertex(t.indexA[0]),s=this.m_proxyA.GetVertex(t.indexA[1]),u=this.m_proxyB.GetVertex(t.indexB[0]),h=this.m_proxyB.GetVertex(t.indexB[1]),n.MulX(i,c),c=n.MulMV(i.R,n.SubtractVV(s,e)),n.MulX(r,m),p=n.MulMV(r.R,n.SubtractVV(h,u)),r=c.x*c.x+c.y*c.y,m=p.x*p.x+p.y*p.y,t=n.SubtractVV(p,c),i=c.x*t.x+c.y*t.y,t=p.x*t.x+p.y*t.y,c=c.x*p.x+c.y*p.y,_=r*m-c*c,p=0,0!=_&&(p=n.Clamp((c*t-i*m)/_,0,1)),0>(c*p+t)/m&&(p=n.Clamp((c-i)/r,0,1)),c=new a,c.x=e.x+p*(s.x-e.x),c.y=e.y+p*(s.y-e.y),m=new a,m.x=u.x+p*(h.x-u.x),m.y=u.y+p*(h.y-u.y),0==p||1==p?(this.m_type=M.e_faceB,this.m_axis=n.CrossVF(n.SubtractVV(h,u),1),this.m_axis.Normalize(),this.m_localPoint=m):(this.m_type=M.e_faceA,this.m_axis=n.CrossVF(n.SubtractVV(s,e),1),this.m_localPoint=c)),0>p&&this.m_axis.NegativeSelf())},M.prototype.Evaluate=function(t,e){var i,s,r=0;switch(this.m_type){case M.e_points:return i=n.MulTMV(t.R,this.m_axis),s=n.MulTMV(e.R,this.m_axis.GetNegative()),i=this.m_proxyA.GetSupportVertex(i),s=this.m_proxyB.GetSupportVertex(s),i=n.MulX(t,i),s=n.MulX(e,s),r=(s.x-i.x)*this.m_axis.x+(s.y-i.y)*this.m_axis.y;case M.e_faceA:return r=n.MulMV(t.R,this.m_axis),i=n.MulX(t,this.m_localPoint),s=n.MulTMV(e.R,r.GetNegative()),s=this.m_proxyB.GetSupportVertex(s),s=n.MulX(e,s),r=(s.x-i.x)*r.x+(s.y-i.y)*r.y;case M.e_faceB:return r=n.MulMV(e.R,this.m_axis),s=n.MulX(e,this.m_localPoint),i=n.MulTMV(t.R,r.GetNegative()),i=this.m_proxyA.GetSupportVertex(i),i=n.MulX(t,i),r=(i.x-s.x)*r.x+(i.y-s.y)*r.y;default:return o.b2Assert(!1),0}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),V.b2Simplex=function(){this.m_v1=new T,this.m_v2=new T,this.m_v3=new T,this.m_vertices=new Vector(3)},V.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},V.prototype.ReadCache=function(t,e,i,s,r){o.b2Assert(t.count>=0&&3>=t.count);var a,l;this.m_count=t.count;for(var c=this.m_vertices,m=0;this.m_count>m;m++){var u=c[m];u.indexA=t.indexA[m],u.indexB=t.indexB[m],a=e.GetVertex(u.indexA),l=s.GetVertex(u.indexB),u.wA=n.MulX(i,a),u.wB=n.MulX(r,l),u.w=n.SubtractVV(u.wB,u.wA),u.a=0}this.m_count>1&&(t=t.metric,a=this.GetMetric(),(.5*t>a||a>2*t||Number.MIN_VALUE>a)&&(this.m_count=0)),0==this.m_count&&(u=c[0],u.indexA=0,u.indexB=0,a=e.GetVertex(0),l=s.GetVertex(0),u.wA=n.MulX(i,a),u.wB=n.MulX(r,l),u.w=n.SubtractVV(u.wB,u.wA),this.m_count=1)},V.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=Box2D.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;this.m_count>i;i++)t.indexA[i]=Box2D.parseUInt(e[i].indexA),t.indexB[i]=Box2D.parseUInt(e[i].indexB)},V.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=n.SubtractVV(this.m_v2.w,this.m_v1.w);return n.CrossVV(t,this.m_v1.w.GetNegative())>0?n.CrossFV(1,t):n.CrossVF(t,1);default:return o.b2Assert(!1),new a}},V.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return o.b2Assert(!1),new a;case 1:return this.m_v1.w;case 2:return new a(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return o.b2Assert(!1),new a}},V.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:o.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:o.b2Assert(!1)}},V.prototype.GetMetric=function(){switch(this.m_count){case 0:return o.b2Assert(!1),0;case 1:return 0;case 2:return n.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return n.CrossVV(n.SubtractVV(this.m_v2.w,this.m_v1.w),n.SubtractVV(this.m_v3.w,this.m_v1.w));default:return o.b2Assert(!1),0}},V.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=n.SubtractVV(e,t);t=-(t.x*i.x+t.y*i.y),0>=t?this.m_count=this.m_v1.a=1:(e=e.x*i.x+e.y*i.y,0>=e?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):(i=1/(e+t),this.m_v1.a=e*i,this.m_v2.a=t*i,this.m_count=2))},V.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,o=n.SubtractVV(e,t),s=n.Dot(t,o),r=n.Dot(e,o);s=-s;var a=n.SubtractVV(i,t),l=n.Dot(t,a),c=n.Dot(i,a);l=-l;var m=n.SubtractVV(i,e),u=n.Dot(e,m);m=n.Dot(i,m),u=-u,a=n.CrossVV(o,a),o=a*n.CrossVV(e,i),i=a*n.CrossVV(i,t),t=a*n.CrossVV(t,e),0>=s&&0>=l?this.m_count=this.m_v1.a=1:r>0&&s>0&&0>=t?(c=1/(r+s),this.m_v1.a=r*c,this.m_v2.a=s*c,this.m_count=2):c>0&&l>0&&0>=i?(r=1/(c+l),this.m_v1.a=c*r,this.m_v3.a=l*r,this.m_count=2,this.m_v2.Set(this.m_v3)):0>=r&&0>=u?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):0>=c&&0>=m?(this.m_count=this.m_v3.a=1,this.m_v1.Set(this.m_v3)):m>0&&u>0&&0>=o?(r=1/(m+u),this.m_v2.a=m*r,this.m_v3.a=u*r,this.m_count=2,this.m_v1.Set(this.m_v3)):(r=1/(o+i+t),this.m_v1.a=o*r,this.m_v2.a=i*r,this.m_v3.a=t*r,this.m_count=3)},I.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},T.b2SimplexVertex=function(){},T.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},G.b2TimeOfImpact=function(){},G.TimeOfImpact=function(t){++G.b2_toiCalls;var e=t.proxyA,i=t.proxyB,s=t.sweepA,r=t.sweepB;o.b2Assert(s.t0==r.t0),o.b2Assert(1-s.t0>Number.MIN_VALUE);var a=e.m_radius+i.m_radius;t=t.tolerance;var l=0,c=0,m=0;for(G.s_cache.count=0,G.s_distanceInput.useRadii=!1;;){if(s.GetTransform(G.s_xfA,l),r.GetTransform(G.s_xfB,l),G.s_distanceInput.proxyA=e,G.s_distanceInput.proxyB=i,G.s_distanceInput.transformA=G.s_xfA,G.s_distanceInput.transformB=G.s_xfB,_.Distance(G.s_distanceOutput,G.s_cache,G.s_distanceInput),0>=G.s_distanceOutput.distance){l=1;break}G.s_fcn.Initialize(G.s_cache,e,G.s_xfA,i,G.s_xfB);var u=G.s_fcn.Evaluate(G.s_xfA,G.s_xfB);if(0>=u){l=1;break}if(0==c&&(m=u>a?n.Max(a-t,.75*a):n.Max(u-t,.02*a)),.5*t>u-m){if(0==c){l=1;break}break}var h=l,p=l,y=1;u=u,s.GetTransform(G.s_xfA,y),r.GetTransform(G.s_xfB,y);var f=G.s_fcn.Evaluate(G.s_xfA,G.s_xfB);if(f>=m){l=1;break}for(var d=0;;){var x=0;x=1&d?p+(m-u)*(y-p)/(f-u):.5*(p+y),s.GetTransform(G.s_xfA,x),r.GetTransform(G.s_xfB,x);var b=G.s_fcn.Evaluate(G.s_xfA,G.s_xfB);if(.025*t>n.Abs(b-m)){h=x;break}if(b>m?(p=x,u=b):(y=x,f=b),++d,++G.b2_toiRootIters,50==d)break}if(G.b2_toiMaxRootIters=n.Max(G.b2_toiMaxRootIters,d),(1+100*Number.MIN_VALUE)*l>h)break;if(l=h,c++,++G.b2_toiIters,1e3==c)break}return G.b2_toiMaxIters=n.Max(G.b2_toiMaxIters,c),l},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new I,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new y,Box2D.Collision.b2TimeOfImpact.s_xfA=new r,Box2D.Collision.b2TimeOfImpact.s_xfB=new r,Box2D.Collision.b2TimeOfImpact.s_fcn=new M,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new f}),L.b2TOIInput=function(){this.proxyA=new d,this.proxyB=new d,this.sweepA=new s,this.sweepB=new s},k.b2WorldManifold=function(){this.m_normal=new a},k.prototype.b2WorldManifold=function(){this.m_points=new Vector(o.b2_maxManifoldPoints);for(var t=0;o.b2_maxManifoldPoints>t;t++)this.m_points[t]=new a},k.prototype.Initialize=function(t,e,i,o,n){if(void 0===i&&(i=0),void 0===n&&(n=0),0!=t.m_pointCount){var s,r,a=0,l=0,c=0,m=0,u=0,h=0;switch(s=0,t.m_type){case w.e_circles:r=e.R,s=t.m_localPoint,a=e.position.x+r.col1.x*s.x+r.col2.x*s.y,e=e.position.y+r.col1.y*s.x+r.col2.y*s.y,r=o.R,s=t.m_points[0].m_localPoint,t=o.position.x+r.col1.x*s.x+r.col2.x*s.y,o=o.position.y+r.col1.y*s.x+r.col2.y*s.y,s=t-a,r=o-e,l=s*s+r*r,l>Number.MIN_VALUE*Number.MIN_VALUE?(l=Math.sqrt(l),this.m_normal.x=s/l,this.m_normal.y=r/l):(this.m_normal.x=1,this.m_normal.y=0),s=e+i*this.m_normal.y,o-=n*this.m_normal.y,this.m_points[0].x=.5*(a+i*this.m_normal.x+(t-n*this.m_normal.x)),this.m_points[0].y=.5*(s+o);break;case w.e_faceA:for(r=e.R,s=t.m_localPlaneNormal,l=r.col1.x*s.x+r.col2.x*s.y,c=r.col1.y*s.x+r.col2.y*s.y,r=e.R,s=t.m_localPoint,m=e.position.x+r.col1.x*s.x+r.col2.x*s.y,u=e.position.y+r.col1.y*s.x+r.col2.y*s.y,this.m_normal.x=l,this.m_normal.y=c,a=0;t.m_pointCount>a;a++)r=o.R,s=t.m_points[a].m_localPoint,h=o.position.x+r.col1.x*s.x+r.col2.x*s.y,s=o.position.y+r.col1.y*s.x+r.col2.y*s.y,this.m_points[a].x=h+.5*(i-(h-m)*l-(s-u)*c-n)*l,this.m_points[a].y=s+.5*(i-(h-m)*l-(s-u)*c-n)*c;break;case w.e_faceB:for(r=o.R,s=t.m_localPlaneNormal,l=r.col1.x*s.x+r.col2.x*s.y,c=r.col1.y*s.x+r.col2.y*s.y,r=o.R,s=t.m_localPoint,m=o.position.x+r.col1.x*s.x+r.col2.x*s.y,u=o.position.y+r.col1.y*s.x+r.col2.y*s.y,this.m_normal.x=-l,this.m_normal.y=-c,a=0;t.m_pointCount>a;a++)r=e.R,s=t.m_points[a].m_localPoint,h=e.position.x+r.col1.x*s.x+r.col2.x*s.y,s=e.position.y+r.col1.y*s.x+r.col2.y*s.y,this.m_points[a].x=h+.5*(n-(h-m)*l-(s-u)*c-i)*l,this.m_points[a].y=s+.5*(n-(h-m)*l-(s-u)*c-i)*c}}},F.ClipVertex=function(){this.v=new a,this.id=new h},F.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},R.Features=function(){},Object.defineProperty(R.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(R.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(R.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(R.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|65280&this._incidentEdge<<8}}),Object.defineProperty(R.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(R.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|16711680&this._incidentVertex<<16}}),Object.defineProperty(R.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(R.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|4278190080&this._flip<<24}})}(),function(){var t=Box2D.Common.b2Settings,e=Box2D.Collision.Shapes.b2CircleShape,i=Box2D.Collision.Shapes.b2EdgeChainDef,o=Box2D.Collision.Shapes.b2EdgeShape,n=Box2D.Collision.Shapes.b2MassData,s=Box2D.Collision.Shapes.b2PolygonShape,r=Box2D.Collision.Shapes.b2Shape,a=Box2D.Common.Math.b2Mat22,l=Box2D.Common.Math.b2Math,c=Box2D.Common.Math.b2Transform,m=Box2D.Common.Math.b2Vec2,u=Box2D.Collision.b2Distance,h=Box2D.Collision.b2DistanceInput,p=Box2D.Collision.b2DistanceOutput,_=Box2D.Collision.b2DistanceProxy,y=Box2D.Collision.b2SimplexCache;Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape),e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,e.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new m},e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(t){this.__super.Set.call(this,t),Box2D.is(t,e)&&this.m_p.SetV((t instanceof e?t:null).m_p)},e.prototype.TestPoint=function(t,e){var i=t.R,o=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y);return i=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y),o=e.x-o,i=e.y-i,this.m_radius*this.m_radius>=o*o+i*i},e.prototype.RayCast=function(t,e,i){var o=i.R,n=e.p1.x-(i.position.x+(o.col1.x*this.m_p.x+o.col2.x*this.m_p.y));i=e.p1.y-(i.position.y+(o.col1.y*this.m_p.x+o.col2.y*this.m_p.y)),o=e.p2.x-e.p1.x;var s=e.p2.y-e.p1.y,r=n*o+i*s,a=o*o+s*s,l=r*r-a*(n*n+i*i-this.m_radius*this.m_radius);return 0>l||Number.MIN_VALUE>a?!1:(r=-(r+Math.sqrt(l)),r>=0&&e.maxFraction*a>=r?(r/=a,t.fraction=r,t.normal.x=n+r*o,t.normal.y=i+r*s,t.normal.Normalize(),!0):!1)},e.prototype.ComputeAABB=function(t,e){var i=e.R,o=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y);i=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y),t.lowerBound.Set(o-this.m_radius,i-this.m_radius),t.upperBound.Set(o+this.m_radius,i+this.m_radius)},e.prototype.ComputeMass=function(e,i){void 0===i&&(i=0),e.mass=i*t.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,o){void 0===e&&(e=0),i=l.MulX(i,this.m_p);var n=-(l.Dot(t,i)-e);if(-this.m_radius+Number.MIN_VALUE>n)return 0;if(n>this.m_radius)return o.SetV(i),Math.PI*this.m_radius*this.m_radius;e=this.m_radius*this.m_radius;var s=n*n;return n=e*(Math.asin(n/this.m_radius)+Math.PI/2)+n*Math.sqrt(e-s),e=-2/3*Math.pow(e-s,1.5)/n,o.x=i.x+t.x*e,o.y=i.y+t.y*e,n},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},e.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=r.e_circleShape,this.m_radius=t},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(o,Box2D.Collision.Shapes.b2Shape),o.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,o.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new m,this.m_v1=new m,this.m_v2=new m,this.m_coreV1=new m,this.m_coreV2=new m,this.m_normal=new m,this.m_direction=new m,this.m_cornerDir1=new m,this.m_cornerDir2=new m},o.prototype.TestPoint=function(){return!1},o.prototype.RayCast=function(t,e,i){var o,n=e.p2.x-e.p1.x,s=e.p2.y-e.p1.y;o=i.R;var r=i.position.x+(o.col1.x*this.m_v1.x+o.col2.x*this.m_v1.y),a=i.position.y+(o.col1.y*this.m_v1.x+o.col2.y*this.m_v1.y),l=i.position.y+(o.col1.y*this.m_v2.x+o.col2.y*this.m_v2.y)-a;i=-(i.position.x+(o.col1.x*this.m_v2.x+o.col2.x*this.m_v2.y)-r),o=100*Number.MIN_VALUE;var c=-(n*l+s*i);if(c>o){r=e.p1.x-r;var m=e.p1.y-a;if(a=r*l+m*i,a>=0&&e.maxFraction*c>=a&&(e=-n*m+s*r,e>=-o*c&&c*(1+o)>=e))return a/=c,t.fraction=a,e=Math.sqrt(l*l+i*i),t.normal.x=l/e,t.normal.y=i/e,!0}return!1},o.prototype.ComputeAABB=function(t,e){var i=e.R,o=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),n=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),s=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y);i=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y),s>o?(t.lowerBound.x=o,t.upperBound.x=s):(t.lowerBound.x=s,t.upperBound.x=o),i>n?(t.lowerBound.y=n,t.upperBound.y=i):(t.lowerBound.y=i,t.upperBound.y=n)},o.prototype.ComputeMass=function(t){t.mass=0,t.center.SetV(this.m_v1),t.I=0},o.prototype.ComputeSubmergedArea=function(t,e,i,o){void 0===e&&(e=0);var n=new m(t.x*e,t.y*e),s=l.MulX(i,this.m_v1);i=l.MulX(i,this.m_v2);var r=l.Dot(t,s)-e;if(t=l.Dot(t,i)-e,r>0){if(t>0)return 0;s.x=-t/(r-t)*s.x+r/(r-t)*i.x,s.y=-t/(r-t)*s.y+r/(r-t)*i.y}else t>0&&(i.x=-t/(r-t)*s.x+r/(r-t)*i.x,i.y=-t/(r-t)*s.y+r/(r-t)*i.y);return o.x=(n.x+s.x+i.x)/3,o.y=(n.y+s.y+i.y)/3,.5*((s.x-n.x)*(i.y-n.y)-(s.y-n.y)*(i.x-n.x))},o.prototype.GetLength=function(){return this.m_length},o.prototype.GetVertex1=function(){return this.m_v1},o.prototype.GetVertex2=function(){return this.m_v2},o.prototype.GetCoreVertex1=function(){return this.m_coreV1},o.prototype.GetCoreVertex2=function(){return this.m_coreV2},o.prototype.GetNormalVector=function(){return this.m_normal},o.prototype.GetDirectionVector=function(){return this.m_direction},o.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},o.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},o.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},o.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},o.prototype.GetFirstVertex=function(t){var e=t.R;return new m(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},o.prototype.GetNextEdge=function(){return this.m_nextEdge},o.prototype.GetPrevEdge=function(){return this.m_prevEdge},o.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var o=t.R,n=t.position.x+(o.col1.x*this.m_coreV1.x+o.col2.x*this.m_coreV1.y),s=t.position.y+(o.col1.y*this.m_coreV1.x+o.col2.y*this.m_coreV1.y),r=t.position.x+(o.col1.x*this.m_coreV2.x+o.col2.x*this.m_coreV2.y);return t=t.position.y+(o.col1.y*this.m_coreV2.x+o.col2.y*this.m_coreV2.y),n*e+s*i>r*e+t*i?(this.s_supportVec.x=n,this.s_supportVec.y=s):(this.s_supportVec.x=r,this.s_supportVec.y=t),this.s_supportVec},o.prototype.b2EdgeShape=function(e,i){this.__super.b2Shape.call(this),this.m_type=r.e_edgeShape,this.m_nextEdge=this.m_prevEdge=null,this.m_v1=e,this.m_v2=i,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},o.prototype.SetPrevEdge=function(t,e,i,o){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=o},o.prototype.SetNextEdge=function(t,e,i,o){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=o},n.b2MassData=function(){this.mass=0,this.center=new m(0,0),this.I=0},Box2D.inherit(s,Box2D.Collision.Shapes.b2Shape),s.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,s.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},s.prototype.Copy=function(){var t=new s;return t.Set(this),t},s.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,s)){t=t instanceof s?t:null,this.m_centroid.SetV(t.m_centroid),this.m_vertexCount=t.m_vertexCount,this.Reserve(this.m_vertexCount);for(var e=0;this.m_vertexCount>e;e++)this.m_vertices[e].SetV(t.m_vertices[e]),this.m_normals[e].SetV(t.m_normals[e])}},s.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,o=new Vector,n=0;for(n=0;t.length>n;++n)i=t[n],o.push(i);this.SetAsVector(o,e)},s.AsArray=function(t,e){void 0===e&&(e=0);var i=new s;return i.SetAsArray(t,e),i},s.prototype.SetAsVector=function(e,i){void 0===i&&(i=0),0==i&&(i=e.length),t.b2Assert(i>=2),this.m_vertexCount=i,this.Reserve(i);var o=0;for(o=0;this.m_vertexCount>o;o++)this.m_vertices[o].SetV(e[o]);for(o=0;this.m_vertexCount>o;++o){var n=parseInt(o),r=parseInt(this.m_vertexCount>o+1?o+1:0);n=l.SubtractVV(this.m_vertices[r],this.m_vertices[n]),t.b2Assert(n.LengthSquared()>Number.MIN_VALUE),this.m_normals[o].SetV(l.CrossVF(n,1)),this.m_normals[o].Normalize()}this.m_centroid=s.ComputeCentroid(this.m_vertices,this.m_vertexCount)},s.AsVector=function(t,e){void 0===e&&(e=0);var i=new s;return i.SetAsVector(t,e),i},s.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},s.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new s;return i.SetAsBox(t,e),i},s.prototype.SetAsOrientedBox=function(t,e,i,o){for(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===o&&(o=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i,t=new c,t.position=i,t.R.Set(o),i=0;this.m_vertexCount>i;++i)this.m_vertices[i]=l.MulX(t,this.m_vertices[i]),this.m_normals[i]=l.MulMV(t.R,this.m_normals[i])},s.AsOrientedBox=function(t,e,i,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===o&&(o=0);var n=new s;return n.SetAsOrientedBox(t,e,i,o),n},s.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=l.CrossVF(l.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},s.AsEdge=function(t,e){var i=new s;return i.SetAsEdge(t,e),i},s.prototype.TestPoint=function(t,e){var i;i=t.R;for(var o=e.x-t.position.x,n=e.y-t.position.y,s=o*i.col1.x+n*i.col1.y,r=o*i.col2.x+n*i.col2.y,a=0;this.m_vertexCount>a;++a)if(i=this.m_vertices[a],o=s-i.x,n=r-i.y,i=this.m_normals[a],i.x*o+i.y*n>0)return!1;return!0},s.prototype.RayCast=function(t,e,i){var o,n,s=0,r=e.maxFraction,a=0,l=0;a=e.p1.x-i.position.x,l=e.p1.y-i.position.y,o=i.R;var c=a*o.col1.x+l*o.col1.y,m=a*o.col2.x+l*o.col2.y;a=e.p2.x-i.position.x,l=e.p2.y-i.position.y,o=i.R,e=a*o.col1.x+l*o.col1.y-c,o=a*o.col2.x+l*o.col2.y-m;for(var u=parseInt(-1),h=0;this.m_vertexCount>h;++h){if(n=this.m_vertices[h],a=n.x-c,l=n.y-m,n=this.m_normals[h],a=n.x*a+n.y*l,l=n.x*e+n.y*o,0==l){if(0>a)return!1}else 0>l&&s*l>a?(s=a/l,u=h):l>0&&r*l>a&&(r=a/l);if(s-Number.MIN_VALUE>r)return!1}return u>=0?(t.fraction=s,o=i.R,n=this.m_normals[u],t.normal.x=o.col1.x*n.x+o.col2.x*n.y,t.normal.y=o.col1.y*n.x+o.col2.y*n.y,!0):!1},s.prototype.ComputeAABB=function(t,e){for(var i=e.R,o=this.m_vertices[0],n=e.position.x+(i.col1.x*o.x+i.col2.x*o.y),s=e.position.y+(i.col1.y*o.x+i.col2.y*o.y),r=n,a=s,l=1;this.m_vertexCount>l;++l){o=this.m_vertices[l];var c=e.position.x+(i.col1.x*o.x+i.col2.x*o.y);o=e.position.y+(i.col1.y*o.x+i.col2.y*o.y),n=c>n?n:c,s=o>s?s:o,r=r>c?r:c,a=a>o?a:o}t.lowerBound.x=n-this.m_radius,t.lowerBound.y=s-this.m_radius,t.upperBound.x=r+this.m_radius,t.upperBound.y=a+this.m_radius},s.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,t.I=0;else{for(var i=0,o=0,n=0,s=0,r=1/3,a=0;this.m_vertexCount>a;++a){var l=this.m_vertices[a],c=this.m_vertexCount>a+1?this.m_vertices[parseInt(a+1)]:this.m_vertices[0],m=l.x-0,u=l.y-0,h=c.x-0,p=c.y-0,_=m*p-u*h,y=.5*_;n+=y,i+=y*r*(0+l.x+c.x),o+=y*r*(0+l.y+c.y),l=m,u=u,h=h,p=p,s+=_*(r*(.25*(l*l+h*l+h*h)+(0*l+0*h))+0+(r*(.25*(u*u+p*u+p*p)+(0*u+0*p))+0))}t.mass=e*n,i*=1/n,o*=1/n,t.center.Set(i,o),t.I=e*s}},s.prototype.ComputeSubmergedArea=function(t,e,i,o){void 0===e&&(e=0);var s=l.MulTMV(i.R,t),r=e-l.Dot(t,i.position),a=new Vector_a2j_Number,c=0,u=parseInt(-1);e=parseInt(-1);var h=!1;for(t=t=0;this.m_vertexCount>t;++t){a[t]=l.Dot(s,this.m_vertices[t])-r;var p=a[t]<-Number.MIN_VALUE;t>0&&(p?h||(u=t-1,c++):h&&(e=t-1,c++)),h=p}switch(c){case 0:return h?(t=new n,this.ComputeMass(t,1),o.SetV(l.MulX(i,t.center)),t.mass):0;case 1:-1==u?u=this.m_vertexCount-1:e=this.m_vertexCount-1}for(t=parseInt((u+1)%this.m_vertexCount),s=parseInt((e+1)%this.m_vertexCount),r=(0-a[u])/(a[t]-a[u]),a=(0-a[e])/(a[s]-a[e]),u=new m(this.m_vertices[u].x*(1-r)+this.m_vertices[t].x*r,this.m_vertices[u].y*(1-r)+this.m_vertices[t].y*r),e=new m(this.m_vertices[e].x*(1-a)+this.m_vertices[s].x*a,this.m_vertices[e].y*(1-a)+this.m_vertices[s].y*a),a=0,r=new m,c=this.m_vertices[t],t=t;t!=s;)t=(t+1)%this.m_vertexCount,h=t==s?e:this.m_vertices[t],p=.5*((c.x-u.x)*(h.y-u.y)-(c.y-u.y)*(h.x-u.x)),a+=p,r.x+=p*(u.x+c.x+h.x)/3,r.y+=p*(u.y+c.y+h.y)/3,c=h;
return r.Multiply(1/a),o.SetV(l.MulX(i,r)),a},s.prototype.GetVertexCount=function(){return this.m_vertexCount},s.prototype.GetVertices=function(){return this.m_vertices},s.prototype.GetNormals=function(){return this.m_normals},s.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;this.m_vertexCount>o;++o){var n=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;n>i&&(e=o,i=n)}return e},s.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;this.m_vertexCount>o;++o){var n=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;n>i&&(e=o,i=n)}return this.m_vertices[e]},s.prototype.Validate=function(){return!1},s.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=r.e_polygonShape,this.m_centroid=new m,this.m_vertices=new Vector,this.m_normals=new Vector},s.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);t>e;e++)this.m_vertices[e]=new m,this.m_normals[e]=new m},s.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new m,o=0,n=1/3,s=0;e>s;++s){var r=t[s],a=e>s+1?t[parseInt(s+1)]:t[0],l=.5*((r.x-0)*(a.y-0)-(r.y-0)*(a.x-0));o+=l,i.x+=l*n*(0+r.x+a.x),i.y+=l*n*(0+r.y+a.y)}return i.x*=1/o,i.y*=1/o,i},s.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var o=0,n=new Vector(i+1);for(o=0;i>o;++o)n[o]=e[o];for(n[i]=n[0],e=Number.MAX_VALUE,o=1;i>=o;++o){var s=n[parseInt(o-1)],r=n[o].x-s.x,a=n[o].y-s.y,l=Math.sqrt(r*r+a*a);r/=l,a/=l;for(var c=-a,m=r,u=l=Number.MAX_VALUE,h=-Number.MAX_VALUE,p=-Number.MAX_VALUE,_=0;i>_;++_){var y=n[_].x-s.x,f=n[_].y-s.y,d=r*y+a*f;y=c*y+m*f,l>d&&(l=d),u>y&&(u=y),d>h&&(h=d),y>p&&(p=y)}_=(h-l)*(p-u),.95*e>_&&(e=_,t.R.col1.x=r,t.R.col1.y=a,t.R.col2.x=c,t.R.col2.y=m,r=.5*(l+h),a=.5*(u+p),c=t.R,t.center.x=s.x+(c.col1.x*r+c.col2.x*a),t.center.y=s.y+(c.col1.y*r+c.col2.y*a),t.extents.x=.5*(h-l),t.extents.y=.5*(p-u))}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new a}),r.b2Shape=function(){},r.prototype.Copy=function(){return null},r.prototype.Set=function(t){this.m_radius=t.m_radius},r.prototype.GetType=function(){return this.m_type},r.prototype.TestPoint=function(){return!1},r.prototype.RayCast=function(){return!1},r.prototype.ComputeAABB=function(){},r.prototype.ComputeMass=function(){},r.prototype.ComputeSubmergedArea=function(){return 0},r.TestOverlap=function(t,e,i,o){var n=new h;return n.proxyA=new _,n.proxyA.Set(t),n.proxyB=new _,n.proxyB.Set(i),n.transformA=e,n.transformB=o,n.useRadii=!0,t=new y,t.count=0,e=new p,u.Distance(e,t,n),e.distance<10*Number.MIN_VALUE},r.prototype.b2Shape=function(){this.m_type=r.e_unknownShape,this.m_radius=t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=Box2D.Common.b2Color,e=Box2D.Common.b2Settings,i=Box2D.Common.Math.b2Math;t.b2Color=function(){this._b=this._g=this._r=0},t.prototype.b2Color=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(o,0,1))},t.prototype.Set=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(o,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=.005,Box2D.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=.2,Box2D.Common.b2Settings.b2_timeToSleep=.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){var t=Box2D.Common.Math.b2Mat22,e=Box2D.Common.Math.b2Mat33,i=Box2D.Common.Math.b2Math,o=Box2D.Common.Math.b2Sweep,n=Box2D.Common.Math.b2Transform,s=Box2D.Common.Math.b2Vec2,r=Box2D.Common.Math.b2Vec3;t.b2Mat22=function(){this.col1=new s,this.col2=new s},t.prototype.b2Mat22=function(){this.SetIdentity()},t.FromAngle=function(e){void 0===e&&(e=0);var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var o=new t;return o.SetVV(e,i),o},t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t);t=Math.sin(t),this.col1.x=e,this.col2.x=-t,this.col1.y=t,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,o=this.col1.y,n=this.col2.y,s=e*n-i*o;return 0!=s&&(s=1/s),t.col1.x=s*n,t.col2.x=-s*i,t.col1.y=-s*o,t.col2.y=s*e,t},t.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var o=this.col1.x,n=this.col2.x,s=this.col1.y,r=this.col2.y,a=o*r-n*s;return 0!=a&&(a=1/a),t.x=a*(r*e-n*i),t.y=a*(o*i-s*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},e.b2Mat33=function(){this.col1=new r,this.col2=new r,this.col3=new r},e.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},e.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)},e.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},e.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},e.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},e.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},e.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var o=this.col1.x,n=this.col2.x,s=this.col1.y,r=this.col2.y,a=o*r-n*s;return 0!=a&&(a=1/a),t.x=a*(r*e-n*i),t.y=a*(o*i-s*e),t},e.prototype.Solve33=function(t,e,i,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0);var n=this.col1.x,s=this.col1.y,r=this.col1.z,a=this.col2.x,l=this.col2.y,c=this.col2.z,m=this.col3.x,u=this.col3.y,h=this.col3.z,p=n*(l*h-c*u)+s*(c*m-a*h)+r*(a*u-l*m);return 0!=p&&(p=1/p),t.x=p*(e*(l*h-c*u)+i*(c*m-a*h)+o*(a*u-l*m)),t.y=p*(n*(i*h-o*u)+s*(o*m-e*h)+r*(e*u-i*m)),t.z=p*(n*(l*o-c*i)+s*(c*e-a*o)+r*(a*i-l*e)),t},i.b2Math=function(){},i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,e){return void 0===e&&(e=0),new s(e*t.y,-e*t.x)},i.CrossFV=function(t,e){return void 0===t&&(t=0),new s(-t*e.y,t*e.x)},i.MulMV=function(t,e){return new s(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y)},i.MulTMV=function(t,e){return new s(i.Dot(e,t.col1),i.Dot(e,t.col2))},i.MulX=function(t,e){var o=i.MulMV(t.R,e);return o.x+=t.position.x,o.y+=t.position.y,o},i.MulXT=function(t,e){var o=i.SubtractVV(e,t.position),n=o.x*t.R.col1.x+o.y*t.R.col1.y;return o.y=o.x*t.R.col2.x+o.y*t.R.col2.y,o.x=n,o},i.AddVV=function(t,e){return new s(t.x+e.x,t.y+e.y)},i.SubtractVV=function(t,e){return new s(t.x-e.x,t.y-e.y)},i.Distance=function(t,e){var i=t.x-e.x,o=t.y-e.y;return Math.sqrt(i*i+o*o)},i.DistanceSquared=function(t,e){var i=t.x-e.x,o=t.y-e.y;return i*i+o*o},i.MulFV=function(t,e){return void 0===t&&(t=0),new s(t*e.x,t*e.y)},i.AddMM=function(e,o){return t.FromVV(i.AddVV(e.col1,o.col1),i.AddVV(e.col2,o.col2))},i.MulMM=function(e,o){return t.FromVV(i.MulMV(e,o.col1),i.MulMV(e,o.col2))},i.MulTMM=function(e,o){var n=new s(i.Dot(e.col1,o.col1),i.Dot(e.col2,o.col1)),r=new s(i.Dot(e.col1,o.col2),i.Dot(e.col2,o.col2));return t.FromVV(n,r)},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){return new s(i.Abs(t.x),i.Abs(t.y))},i.AbsM=function(e){return t.FromVV(i.AbsV(e.col1),i.AbsV(e.col2))},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),e>t?t:e},i.MinV=function(t,e){return new s(i.Min(t.x,e.x),i.Min(t.y,e.y))},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,e){return new s(i.Max(t.x,e.x),i.Max(t.y,e.y))},i.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),e>t?e:t>i?i:t},i.ClampV=function(t,e,o){return i.MaxV(e,i.MinV(t,o))},i.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=2147483647&t>>1,t|=1073741823&t>>2,t|=268435455&t>>4,t|=16777215&t>>8,t|=65535&t>>16,t+1},i.IsPowerOfTwo=function(t){return void 0===t&&(t=0),t>0&&0==(t&t-1)},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new s(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new s(1,0),new s(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new n(i.b2Vec2_zero,i.b2Mat22_identity)}),o.b2Sweep=function(){this.localCenter=new s,this.c0=new s,this.c=new s},o.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},o.prototype.Copy=function(){var t=new o;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},o.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y,t.R.Set((1-e)*this.a0+e*this.a);var i=t.R;t.position.x-=i.col1.x*this.localCenter.x+i.col2.x*this.localCenter.y,t.position.y-=i.col1.y*this.localCenter.x+i.col2.y*this.localCenter.y},o.prototype.Advance=function(t){if(void 0===t&&(t=0),t>this.t0&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},n.b2Transform=function(){this.position=new s,this.R=new t},n.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},n.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},n.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},n.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},n.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},s.b2Vec2=function(){},s.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetZero=function(){this.y=this.x=0},s.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y},s.prototype.GetNegative=function(){return new s(-this.x,-this.y)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},s.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new s(t,e)},s.prototype.Copy=function(){return new s(this.x,this.y)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},s.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},s.prototype.MulTM=function(t){var e=i.Dot(this,t.col1);this.y=i.Dot(this,t.col2),this.x=e},s.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},s.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},s.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},s.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},s.prototype.Abs=function(){0>this.x&&(this.x=-this.x),0>this.y&&(this.y=-this.y)},s.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},s.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(Number.MIN_VALUE>t)return 0;var e=1/t;return this.x*=e,this.y*=e,t},s.prototype.IsValid=function(){return i.IsValid(this.x)&&i.IsValid(this.y)},r.b2Vec3=function(){},r.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},r.prototype.SetZero=function(){this.x=this.y=this.z=0},r.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},r.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},r.prototype.GetNegative=function(){return new r(-this.x,-this.y,-this.z)},r.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},r.prototype.Copy=function(){return new r(this.x,this.y,this.z)},r.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},r.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},r.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){var t=Box2D.Common.Math.b2Math,e=Box2D.Common.Math.b2Sweep,i=Box2D.Common.Math.b2Transform,o=Box2D.Common.Math.b2Vec2,n=Box2D.Common.b2Color,s=Box2D.Common.b2Settings,r=Box2D.Collision.b2AABB,a=Box2D.Collision.b2ContactPoint,l=Box2D.Collision.b2DynamicTreeBroadPhase,c=Box2D.Collision.b2RayCastInput,m=Box2D.Collision.b2RayCastOutput,u=Box2D.Collision.Shapes.b2CircleShape,h=Box2D.Collision.Shapes.b2EdgeShape,p=Box2D.Collision.Shapes.b2MassData,_=Box2D.Collision.Shapes.b2PolygonShape,y=Box2D.Collision.Shapes.b2Shape,f=Box2D.Dynamics.b2Body,d=Box2D.Dynamics.b2BodyDef,x=Box2D.Dynamics.b2ContactFilter,b=Box2D.Dynamics.b2ContactImpulse,g=Box2D.Dynamics.b2ContactListener,v=Box2D.Dynamics.b2ContactManager,w=Box2D.Dynamics.b2DebugDraw,C=Box2D.Dynamics.b2DestructionListener,B=Box2D.Dynamics.b2FilterData,D=Box2D.Dynamics.b2Fixture,S=Box2D.Dynamics.b2FixtureDef,A=Box2D.Dynamics.b2Island,M=Box2D.Dynamics.b2TimeStep,V=Box2D.Dynamics.b2World,I=Box2D.Dynamics.Contacts.b2Contact,T=Box2D.Dynamics.Contacts.b2ContactFactory,G=Box2D.Dynamics.Contacts.b2ContactSolver,L=Box2D.Dynamics.Joints.b2Joint,k=Box2D.Dynamics.Joints.b2PulleyJoint;f.b2Body=function(){this.m_xf=new i,this.m_sweep=new e,this.m_linearVelocity=new o,this.m_force=new o},f.prototype.connectEdges=function(e,i,o){void 0===o&&(o=0);var n=Math.atan2(i.GetDirectionVector().y,i.GetDirectionVector().x);o=t.MulFV(Math.tan(.5*(n-o)),i.GetDirectionVector()),o=t.SubtractVV(o,i.GetNormalVector()),o=t.MulFV(s.b2_toiSlop,o),o=t.AddVV(o,i.GetVertex1());var r=t.AddVV(e.GetDirectionVector(),i.GetDirectionVector());r.Normalize();var a=t.Dot(e.GetDirectionVector(),i.GetNormalVector())>0;return e.SetNextEdge(i,o,r,a),i.SetPrevEdge(e,o,r,a),n},f.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new D;return e.Create(this,this.m_xf,t),this.m_flags&f.e_activeFlag&&e.CreateProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf),e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,e.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=V.e_newFixture,e},f.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new S;return i.shape=t,i.density=e,this.CreateFixture(i)},f.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next;break}i=e,e=e.m_next}for(e=this.m_contactList;e;){i=e.contact,e=e.next;var o=i.GetFixtureA(),n=i.GetFixtureB();(t==o||t==n)&&this.m_world.m_contactManager.Destroy(i)}this.m_flags&f.e_activeFlag&&t.DestroyProxy(this.m_world.m_contactManager.m_broadPhase),t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},f.prototype.SetPositionAndAngle=function(t,e){void 0===e&&(e=0);var i;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t),i=this.m_xf.R;var o=this.m_sweep.localCenter;for(this.m_sweep.c.x=i.col1.x*o.x+i.col2.x*o.y,this.m_sweep.c.y=i.col1.y*o.x+i.col2.y*o.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e,o=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(o,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},f.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},f.prototype.GetTransform=function(){return this.m_xf},f.prototype.GetPosition=function(){return this.m_xf.position},f.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},f.prototype.GetAngle=function(){return this.m_sweep.a},f.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},f.prototype.GetWorldCenter=function(){return this.m_sweep.c},f.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},f.prototype.SetLinearVelocity=function(t){this.m_type!=f.b2_staticBody&&this.m_linearVelocity.SetV(t)},f.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},f.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=f.b2_staticBody&&(this.m_angularVelocity=t)},f.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},f.prototype.GetDefinition=function(){var t=new d;return t.type=this.GetType(),t.allowSleep=(this.m_flags&f.e_allowSleepFlag)==f.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&f.e_fixedRotationFlag)==f.e_fixedRotationFlag,t.bullet=(this.m_flags&f.e_bulletFlag)==f.e_bulletFlag,t.awake=(this.m_flags&f.e_awakeFlag)==f.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},f.prototype.ApplyForce=function(t,e){this.m_type==f.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},f.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==f.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},f.prototype.ApplyImpulse=function(t,e){this.m_type==f.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},f.prototype.Split=function(e){for(var i,o=this.GetLinearVelocity().Copy(),n=this.GetAngularVelocity(),s=this.GetWorldCenter(),r=this.m_world.CreateBody(this.GetDefinition()),a=this.m_fixtureList;a;)if(e(a)){var l=a.m_next;i?i.m_next=l:this.m_fixtureList=l,this.m_fixtureCount--,a.m_next=r.m_fixtureList,r.m_fixtureList=a,r.m_fixtureCount++,a.m_body=r,a=l}else i=a,a=a.m_next;return this.ResetMassData(),r.ResetMassData(),i=this.GetWorldCenter(),e=r.GetWorldCenter(),i=t.AddVV(o,t.CrossFV(n,t.SubtractVV(i,s))),o=t.AddVV(o,t.CrossFV(n,t.SubtractVV(e,s))),this.SetLinearVelocity(i),r.SetLinearVelocity(o),this.SetAngularVelocity(n),r.SetAngularVelocity(n),this.SynchronizeFixtures(),r.SynchronizeFixtures(),r},f.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=n,e=i}o.m_fixtureCount=0;var o=this,n=t;o.GetWorldCenter(),n.GetWorldCenter(),o.GetLinearVelocity().Copy(),n.GetLinearVelocity().Copy(),o.GetAngularVelocity(),n.GetAngularVelocity(),o.ResetMassData(),this.SynchronizeFixtures()},f.prototype.GetMass=function(){return this.m_mass},f.prototype.GetInertia=function(){return this.m_I},f.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},f.prototype.SetMassData=function(e){if(s.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==f.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0,this.m_mass=e.mass,0>=this.m_mass&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&f.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},f.prototype.ResetMassData=function(){if(this.m_invI=this.m_I=this.m_invMass=this.m_mass=0,this.m_sweep.localCenter.SetZero(),this.m_type!=f.b2_staticBody&&this.m_type!=f.b2_kinematicBody){for(var e=o.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var n=i.GetMassData();this.m_mass+=n.mass,e.x+=n.center.x*n.mass,e.y+=n.center.y*n.mass,this.m_I+=n.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):this.m_invMass=this.m_mass=1,this.m_I>0&&0==(this.m_flags&f.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,s.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0,i=this.m_sweep.c.Copy(),this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},f.prototype.GetWorldPoint=function(t){var e=this.m_xf.R;return t=new o(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y),t.x+=this.m_xf.position.x,t.y+=this.m_xf.position.y,t},f.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)},f.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)},f.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)},f.prototype.GetLinearVelocityFromWorldPoint=function(t){return new o(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},f.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R;return t=new o(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y),t.x+=this.m_xf.position.x,t.y+=this.m_xf.position.y,new o(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},f.prototype.GetLinearDamping=function(){return this.m_linearDamping},f.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},f.prototype.GetAngularDamping=function(){return this.m_angularDamping},f.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},f.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t)for(this.m_type=t,this.ResetMassData(),this.m_type==f.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0,t=this.m_contactList;t;t=t.next)t.contact.FlagForFiltering()},f.prototype.GetType=function(){return this.m_type},f.prototype.SetBullet=function(t){t?this.m_flags|=f.e_bulletFlag:this.m_flags&=~f.e_bulletFlag},f.prototype.IsBullet=function(){return(this.m_flags&f.e_bulletFlag)==f.e_bulletFlag},f.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=f.e_allowSleepFlag:(this.m_flags&=~f.e_allowSleepFlag,this.SetAwake(!0))},f.prototype.SetAwake=function(t){t?(this.m_flags|=f.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~f.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},f.prototype.IsAwake=function(){return(this.m_flags&f.e_awakeFlag)==f.e_awakeFlag},f.prototype.SetFixedRotation=function(t){t?this.m_flags|=f.e_fixedRotationFlag:this.m_flags&=~f.e_fixedRotationFlag,this.ResetMassData()},f.prototype.IsFixedRotation=function(){return(this.m_flags&f.e_fixedRotationFlag)==f.e_fixedRotationFlag},f.prototype.SetActive=function(t){if(t!=this.IsActive()){var e;if(t)for(this.m_flags|=f.e_activeFlag,t=this.m_world.m_contactManager.m_broadPhase,e=this.m_fixtureList;e;e=e.m_next)e.CreateProxy(t,this.m_xf);else{for(this.m_flags&=~f.e_activeFlag,t=this.m_world.m_contactManager.m_broadPhase,e=this.m_fixtureList;e;e=e.m_next)e.DestroyProxy(t);for(t=this.m_contactList;t;)e=t,t=t.next,this.m_world.m_contactManager.Destroy(e.contact);this.m_contactList=null}}},f.prototype.IsActive=function(){return(this.m_flags&f.e_activeFlag)==f.e_activeFlag},f.prototype.IsSleepingAllowed=function(){return(this.m_flags&f.e_allowSleepFlag)==f.e_allowSleepFlag},f.prototype.GetFixtureList=function(){return this.m_fixtureList},f.prototype.GetJointList=function(){return this.m_jointList},f.prototype.GetControllerList=function(){return this.m_controllerList},f.prototype.GetContactList=function(){return this.m_contactList},f.prototype.GetNext=function(){return this.m_next},f.prototype.GetUserData=function(){return this.m_userData},f.prototype.SetUserData=function(t){this.m_userData=t},f.prototype.GetWorld=function(){return this.m_world},f.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=f.e_bulletFlag),t.fixedRotation&&(this.m_flags|=f.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=f.e_allowSleepFlag),t.awake&&(this.m_flags|=f.e_awakeFlag),t.active&&(this.m_flags|=f.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,o=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*o.x+i.col2.x*o.y,this.m_sweep.c.y=i.col1.y*o.x+i.col2.y*o.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_contactList=this.m_controllerList=this.m_jointList=null,this.m_controllerCount=0,this.m_next=this.m_prev=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_sleepTime=this.m_torque=0,this.m_type=t.type,this.m_invMass=this.m_mass=this.m_type==f.b2_dynamicBody?1:0,this.m_invI=this.m_I=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},f.prototype.SynchronizeFixtures=function(){var t=f.s_xf1;t.R.Set(this.m_sweep.a0);var e=t.R,i=this.m_sweep.localCenter;for(t.position.x=this.m_sweep.c0.x-(e.col1.x*i.x+e.col2.x*i.y),t.position.y=this.m_sweep.c0.y-(e.col1.y*i.x+e.col2.y*i.y),i=this.m_world.m_contactManager.m_broadPhase,e=this.m_fixtureList;e;e=e.m_next)e.Synchronize(i,t,this.m_xf)},f.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},f.prototype.ShouldCollide=function(t){if(this.m_type!=f.b2_dynamicBody&&t.m_type!=f.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},f.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new i,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),d.b2BodyDef=function(){this.position=new o,this.linearVelocity=new o},d.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularDamping=this.linearDamping=this.angularVelocity=0,this.awake=this.allowSleep=!0,this.bullet=this.fixedRotation=!1,this.type=f.b2_staticBody,this.active=!0,this.inertiaScale=1},x.b2ContactFilter=function(){},x.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),o=e.GetFilterData();return i.groupIndex==o.groupIndex&&0!=i.groupIndex?i.groupIndex>0:0!=(i.maskBits&o.categoryBits)&&0!=(i.categoryBits&o.maskBits)},x.prototype.RayCollide=function(t,e){return t?this.ShouldCollide(t instanceof D?t:null,e):!0},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new x}),b.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(s.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(s.b2_maxManifoldPoints)},g.b2ContactListener=function(){},g.prototype.BeginContact=function(){},g.prototype.EndContact=function(){},g.prototype.PreSolve=function(){},g.prototype.PostSolve=function(){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new g}),v.b2ContactManager=function(){},v.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=x.b2_defaultFilter,this.m_contactListener=g.b2_defaultListener,this.m_contactFactory=new T(this.m_allocator),this.m_broadPhase=new l},v.prototype.AddPair=function(t,e){var i=t instanceof D?t:null,o=e instanceof D?e:null,n=i.GetBody(),s=o.GetBody();if(n!=s){for(var r=s.GetContactList();r;){if(r.other==n){var a=r.contact.GetFixtureA(),l=r.contact.GetFixtureB();if(a==i&&l==o)return;if(a==o&&l==i)return}r=r.next}0!=s.ShouldCollide(n)&&0!=this.m_contactFilter.ShouldCollide(i,o)&&(r=this.m_contactFactory.Create(i,o),i=r.GetFixtureA(),o=r.GetFixtureB(),n=i.m_body,s=o.m_body,r.m_prev=null,r.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=r),this.m_world.m_contactList=r,r.m_nodeA.contact=r,r.m_nodeA.other=s,r.m_nodeA.prev=null,r.m_nodeA.next=n.m_contactList,null!=n.m_contactList&&(n.m_contactList.prev=r.m_nodeA),n.m_contactList=r.m_nodeA,r.m_nodeB.contact=r,r.m_nodeB.other=n,r.m_nodeB.prev=null,r.m_nodeB.next=s.m_contactList,null!=s.m_contactList&&(s.m_contactList.prev=r.m_nodeB),s.m_contactList=r.m_nodeB,++this.m_world.m_contactCount)
}},v.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},v.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB();e=e.GetBody(),i=i.GetBody(),t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==e.m_contactList&&(e.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==i.m_contactList&&(i.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},v.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),o=e.GetBody(),n=i.GetBody();if(0==o.IsAwake()&&0==n.IsAwake())t=t.GetNext();else{if(t.m_flags&I.e_filterFlag){if(0==n.ShouldCollide(o)){e=t,t=e.GetNext(),this.Destroy(e);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){e=t,t=e.GetNext(),this.Destroy(e);continue}t.m_flags&=~I.e_filterFlag}0==this.m_broadPhase.TestOverlap(e.m_proxy,i.m_proxy)?(e=t,t=e.GetNext(),this.Destroy(e)):(t.Update(this.m_contactListener),t=t.GetNext())}}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new a}),w.b2DebugDraw=function(){},w.prototype.b2DebugDraw=function(){},w.prototype.SetFlags=function(){},w.prototype.GetFlags=function(){},w.prototype.AppendFlags=function(){},w.prototype.ClearFlags=function(){},w.prototype.SetSprite=function(){},w.prototype.GetSprite=function(){},w.prototype.SetDrawScale=function(){},w.prototype.GetDrawScale=function(){},w.prototype.SetLineThickness=function(){},w.prototype.GetLineThickness=function(){},w.prototype.SetAlpha=function(){},w.prototype.GetAlpha=function(){},w.prototype.SetFillAlpha=function(){},w.prototype.GetFillAlpha=function(){},w.prototype.SetXFormScale=function(){},w.prototype.GetXFormScale=function(){},w.prototype.DrawPolygon=function(){},w.prototype.DrawSolidPolygon=function(){},w.prototype.DrawCircle=function(){},w.prototype.DrawSolidCircle=function(){},w.prototype.DrawSegment=function(){},w.prototype.DrawTransform=function(){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),C.b2DestructionListener=function(){},C.prototype.SayGoodbyeJoint=function(){},C.prototype.SayGoodbyeFixture=function(){},B.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},B.prototype.Copy=function(){var t=new B;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},D.b2Fixture=function(){this.m_filter=new B},D.prototype.GetType=function(){return this.m_shape.GetType()},D.prototype.GetShape=function(){return this.m_shape},D.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(t=this.m_body.GetContactList();t;){var e=t.contact,i=e.GetFixtureA(),o=e.GetFixtureB();(i==this||o==this)&&e.SetSensor(i.IsSensor()||o.IsSensor()),t=t.next}},D.prototype.IsSensor=function(){return this.m_isSensor},D.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(t=this.m_body.GetContactList();t;){var e=t.contact,i=e.GetFixtureA(),o=e.GetFixtureB();(i==this||o==this)&&e.FlagForFiltering(),t=t.next}},D.prototype.GetFilterData=function(){return this.m_filter.Copy()},D.prototype.GetBody=function(){return this.m_body},D.prototype.GetNext=function(){return this.m_next},D.prototype.GetUserData=function(){return this.m_userData},D.prototype.SetUserData=function(t){this.m_userData=t},D.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},D.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},D.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new p),this.m_shape.ComputeMass(t,this.m_density),t},D.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},D.prototype.GetDensity=function(){return this.m_density},D.prototype.GetFriction=function(){return this.m_friction},D.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},D.prototype.GetRestitution=function(){return this.m_restitution},D.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},D.prototype.GetAABB=function(){return this.m_aabb},D.prototype.b2Fixture=function(){this.m_aabb=new r,this.m_shape=this.m_next=this.m_body=this.m_userData=null,this.m_restitution=this.m_friction=this.m_density=0},D.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},D.prototype.Destroy=function(){this.m_shape=null},D.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},D.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},D.prototype.Synchronize=function(e,i,o){if(this.m_proxy){var n=new r,s=new r;this.m_shape.ComputeAABB(n,i),this.m_shape.ComputeAABB(s,o),this.m_aabb.Combine(n,s),i=t.SubtractVV(o.position,i.position),e.MoveProxy(this.m_proxy,this.m_aabb,i)}},S.b2FixtureDef=function(){this.filter=new B},S.prototype.b2FixtureDef=function(){this.userData=this.shape=null,this.friction=.2,this.density=this.restitution=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},A.b2Island=function(){},A.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},A.prototype.Initialize=function(t,e,i,o,n,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var r=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_jointCount=this.m_contactCount=this.m_bodyCount=0,this.m_allocator=o,this.m_listener=n,this.m_contactSolver=s,r=this.m_bodies.length;t>r;r++)this.m_bodies[r]=null;for(r=this.m_contacts.length;e>r;r++)this.m_contacts[r]=null;for(r=this.m_joints.length;i>r;r++)this.m_joints[r]=null},A.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0},A.prototype.Solve=function(e,i,o){var n,r=0,a=0;for(r=0;this.m_bodyCount>r;++r)a=this.m_bodies[r],a.GetType()==f.b2_dynamicBody&&(a.m_linearVelocity.x+=e.dt*(i.x+a.m_invMass*a.m_force.x),a.m_linearVelocity.y+=e.dt*(i.y+a.m_invMass*a.m_force.y),a.m_angularVelocity+=e.dt*a.m_invI*a.m_torque,a.m_linearVelocity.Multiply(t.Clamp(1-e.dt*a.m_linearDamping,0,1)),a.m_angularVelocity*=t.Clamp(1-e.dt*a.m_angularDamping,0,1));for(this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator),i=this.m_contactSolver,i.InitVelocityConstraints(e),r=0;this.m_jointCount>r;++r)n=this.m_joints[r],n.InitVelocityConstraints(e);for(r=0;e.velocityIterations>r;++r){for(a=0;this.m_jointCount>a;++a)n=this.m_joints[a],n.SolveVelocityConstraints(e);i.SolveVelocityConstraints()}for(r=0;this.m_jointCount>r;++r)n=this.m_joints[r],n.FinalizeVelocityConstraints();for(i.FinalizeVelocityConstraints(),r=0;this.m_bodyCount>r;++r)if(a=this.m_bodies[r],a.GetType()!=f.b2_staticBody){var l=e.dt*a.m_linearVelocity.x,c=e.dt*a.m_linearVelocity.y;l*l+c*c>s.b2_maxTranslationSquared&&(a.m_linearVelocity.Normalize(),a.m_linearVelocity.x*=s.b2_maxTranslation*e.inv_dt,a.m_linearVelocity.y*=s.b2_maxTranslation*e.inv_dt),l=e.dt*a.m_angularVelocity,l*l>s.b2_maxRotationSquared&&(a.m_angularVelocity=0>a.m_angularVelocity?-s.b2_maxRotation*e.inv_dt:s.b2_maxRotation*e.inv_dt),a.m_sweep.c0.SetV(a.m_sweep.c),a.m_sweep.a0=a.m_sweep.a,a.m_sweep.c.x+=e.dt*a.m_linearVelocity.x,a.m_sweep.c.y+=e.dt*a.m_linearVelocity.y,a.m_sweep.a+=e.dt*a.m_angularVelocity,a.SynchronizeTransform()}for(r=0;e.positionIterations>r;++r){for(l=i.SolvePositionConstraints(s.b2_contactBaumgarte),c=!0,a=0;this.m_jointCount>a;++a)n=this.m_joints[a],n=n.SolvePositionConstraints(s.b2_contactBaumgarte),c=c&&n;if(l&&c)break}if(this.Report(i.m_constraints),o){for(o=Number.MAX_VALUE,i=s.b2_linearSleepTolerance*s.b2_linearSleepTolerance,l=s.b2_angularSleepTolerance*s.b2_angularSleepTolerance,r=0;this.m_bodyCount>r;++r)a=this.m_bodies[r],a.GetType()!=f.b2_staticBody&&(0==(a.m_flags&f.e_allowSleepFlag)&&(o=a.m_sleepTime=0),0==(a.m_flags&f.e_allowSleepFlag)||a.m_angularVelocity*a.m_angularVelocity>l||t.Dot(a.m_linearVelocity,a.m_linearVelocity)>i?o=a.m_sleepTime=0:(a.m_sleepTime+=e.dt,o=t.Min(o,a.m_sleepTime)));if(o>=s.b2_timeToSleep)for(r=0;this.m_bodyCount>r;++r)a=this.m_bodies[r],a.SetAwake(!1)}},A.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var o=this.m_contactSolver;for(e=0;this.m_jointCount>e;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;t.velocityIterations>e;++e)for(o.SolveVelocityConstraints(),i=0;this.m_jointCount>i;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;this.m_bodyCount>e;++e)if(i=this.m_bodies[e],i.GetType()!=f.b2_staticBody){var n=t.dt*i.m_linearVelocity.x,r=t.dt*i.m_linearVelocity.y;n*n+r*r>s.b2_maxTranslationSquared&&(i.m_linearVelocity.Normalize(),i.m_linearVelocity.x*=s.b2_maxTranslation*t.inv_dt,i.m_linearVelocity.y*=s.b2_maxTranslation*t.inv_dt),n=t.dt*i.m_angularVelocity,n*n>s.b2_maxRotationSquared&&(i.m_angularVelocity=0>i.m_angularVelocity?-s.b2_maxRotation*t.inv_dt:s.b2_maxRotation*t.inv_dt),i.m_sweep.c0.SetV(i.m_sweep.c),i.m_sweep.a0=i.m_sweep.a,i.m_sweep.c.x+=t.dt*i.m_linearVelocity.x,i.m_sweep.c.y+=t.dt*i.m_linearVelocity.y,i.m_sweep.a+=t.dt*i.m_angularVelocity,i.SynchronizeTransform()}for(e=0;t.positionIterations>e;++e){for(n=o.SolvePositionConstraints(.75),r=!0,i=0;this.m_jointCount>i;++i){var a=this.m_joints[i].SolvePositionConstraints(s.b2_contactBaumgarte);r=r&&a}if(n&&r)break}this.Report(o.m_constraints)},A.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;this.m_contactCount>e;++e){for(var i=this.m_contacts[e],o=t[e],n=0;o.pointCount>n;++n)A.s_impulse.normalImpulses[n]=o.points[n].normalImpulse,A.s_impulse.tangentImpulses[n]=o.points[n].tangentImpulse;this.m_listener.PostSolve(i,A.s_impulse)}},A.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},A.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},A.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new b}),M.b2TimeStep=function(){},M.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},V.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new v,this.m_contactSolver=new G,this.m_island=new A},V.prototype.b2World=function(t,e){this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null,this.m_controllerCount=this.m_jointCount=this.m_contactCount=this.m_bodyCount=0,V.m_warmStarting=!0,V.m_continuousPhysics=!0,this.m_allowSleep=e,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this,this.m_groundBody=this.CreateBody(new d)},V.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},V.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},V.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},V.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},V.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var o=i.m_fixtureList;o;o=o.m_next)o.m_proxy=t.CreateProxy(e.GetFatAABB(o.m_proxy),o)},V.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},V.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},V.prototype.CreateBody=function(t){return 1==this.IsLocked()?null:(t=new f(t,this),t.m_prev=null,(t.m_next=this.m_bodyList)&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount,t)},V.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(e=t.m_controllerList;e;)i=e,e=e.nextController,i.controller.RemoveBody(t);for(e=t.m_contactList;e;)i=e,e=e.next,this.m_contactManager.Destroy(i.contact);for(t.m_contactList=null,e=t.m_fixtureList;e;)i=e,e=e.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(i),i.DestroyProxy(this.m_contactManager.m_broadPhase),i.Destroy();t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},V.prototype.CreateJoint=function(t){var e=L.Create(t,null);e.m_prev=null,(e.m_next=this.m_jointList)&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,(e.m_edgeA.next=e.m_bodyA.m_jointList)&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,(e.m_edgeB.next=e.m_bodyB.m_jointList)&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,o=t.bodyB;if(0==t.collideConnected)for(t=o.GetContactList();t;)t.other==i&&t.contact.FlagForFiltering(),t=t.next;return e},V.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,o=t.m_bodyB;if(i.SetAwake(!0),o.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==o.m_jointList&&(o.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,L.Destroy(t,null),--this.m_jointCount,0==e)for(t=o.GetContactList();t;)t.other==i&&t.contact.FlagForFiltering(),t=t.next},V.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},V.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},V.prototype.CreateController=function(t){if(t.m_world!=this)throw Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},V.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},V.prototype.SetWarmStarting=function(t){V.m_warmStarting=t},V.prototype.SetContinuousPhysics=function(t){V.m_continuousPhysics=t},V.prototype.GetBodyCount=function(){return this.m_bodyCount},V.prototype.GetJointCount=function(){return this.m_jointCount},V.prototype.GetContactCount=function(){return this.m_contactCount},V.prototype.SetGravity=function(t){this.m_gravity=t},V.prototype.GetGravity=function(){return this.m_gravity},V.prototype.GetGroundBody=function(){return this.m_groundBody},V.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&V.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~V.e_newFixture),this.m_flags|=V.e_locked;var o=V.s_timestep2;o.dt=t,o.velocityIterations=e,o.positionIterations=i,o.inv_dt=t>0?1/t:0,o.dtRatio=this.m_inv_dt0*t,o.warmStarting=V.m_warmStarting,this.m_contactManager.Collide(),o.dt>0&&this.Solve(o),V.m_continuousPhysics&&o.dt>0&&this.SolveTOI(o),o.dt>0&&(this.m_inv_dt0=o.inv_dt),this.m_flags&=~V.e_locked},V.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},V.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,s=this.m_debugDraw.GetFlags();new o,new o,new o;var a;new r,new r,a=[new o,new o,new o,new o];var l=new n(0,0,0);if(s&w.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(a=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?l.Set(.5,.5,.3):t.GetType()==f.b2_staticBody?l.Set(.5,.9,.5):t.GetType()==f.b2_kinematicBody?l.Set(.5,.5,.9):0==t.IsAwake()?l.Set(.6,.6,.6):l.Set(.9,.7,.7),this.DrawShape(i,a,l);if(s&w.e_jointBit)for(t=this.m_jointList;t;t=t.m_next)this.DrawJoint(t);if(s&w.e_controllerBit)for(t=this.m_controllerList;t;t=t.m_next)t.Draw(this.m_debugDraw);if(s&w.e_pairBit)for(l.Set(.3,.9,.9),t=this.m_contactManager.m_contactList;t;t=t.GetNext())i=t.GetFixtureA(),e=t.GetFixtureB(),i=i.GetAABB().GetCenter(),e=e.GetAABB().GetCenter(),this.m_debugDraw.DrawSegment(i,e,l);if(s&w.e_aabbBit)for(i=this.m_contactManager.m_broadPhase,a=[new o,new o,new o,new o],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var c=i.GetFatAABB(e.m_proxy);a[0].Set(c.lowerBound.x,c.lowerBound.y),a[1].Set(c.upperBound.x,c.lowerBound.y),a[2].Set(c.upperBound.x,c.upperBound.y),a[3].Set(c.lowerBound.x,c.upperBound.y),this.m_debugDraw.DrawPolygon(a,4,l)}if(s&w.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)a=V.s_xf,a.R=t.m_xf.R,a.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(a)}},V.prototype.QueryAABB=function(t,e){var i=this.m_contactManager.m_broadPhase;i.Query(function(e){return t(i.GetUserData(e))},e)},V.prototype.QueryShape=function(t,e,o){void 0===o&&(o=null),null==o&&(o=new i,o.SetIdentity());var n=this.m_contactManager.m_broadPhase,s=new r;e.ComputeAABB(s,o),n.Query(function(i){return i=n.GetUserData(i)instanceof D?n.GetUserData(i):null,y.TestOverlap(e,o,i.GetShape(),i.GetBody().GetTransform())?t(i):!0},s)},V.prototype.QueryPoint=function(t,e){var i=this.m_contactManager.m_broadPhase,o=new r;o.lowerBound.Set(e.x-s.b2_linearSlop,e.y-s.b2_linearSlop),o.upperBound.Set(e.x+s.b2_linearSlop,e.y+s.b2_linearSlop),i.Query(function(o){return o=i.GetUserData(o)instanceof D?i.GetUserData(o):null,o.TestPoint(e)?t(o):!0},o)},V.prototype.RayCast=function(t,e,i){var n=this.m_contactManager.m_broadPhase,s=new m,r=new c(e,i);n.RayCast(function(r,a){var l=n.GetUserData(a);if(l=l instanceof D?l:null,l.RayCast(s,r)){var c=s.fraction,m=new o((1-c)*e.x+c*i.x,(1-c)*e.y+c*i.y);return t(l,m,s.normal,c)}return r.maxFraction},r)},V.prototype.RayCastOne=function(t,e){var i;return this.RayCast(function(t,e,o,n){return void 0===n&&(n=0),i=t,n},t,e),i},V.prototype.RayCastAll=function(t,e){var i=new Vector;return this.RayCast(function(t){return i[i.length]=t,1},t,e),i},V.prototype.GetBodyList=function(){return this.m_bodyList},V.prototype.GetJointList=function(){return this.m_jointList},V.prototype.GetContactList=function(){return this.m_contactList},V.prototype.IsLocked=function(){return(this.m_flags&V.e_locked)>0},V.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);for(i=this.m_island,i.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~f.e_islandFlag;for(var o=this.m_contactList;o;o=o.m_next)o.m_flags&=~I.e_islandFlag;for(o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;parseInt(this.m_bodyCount),o=this.s_stack;for(var n=this.m_bodyList;n;n=n.m_next)if(!(n.m_flags&f.e_islandFlag)&&0!=n.IsAwake()&&0!=n.IsActive()&&n.GetType()!=f.b2_staticBody){i.Clear();var s=0;for(o[s++]=n,n.m_flags|=f.e_islandFlag;s>0;)if(e=o[--s],i.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=f.b2_staticBody){for(var r,a=e.m_contactList;a;a=a.next)a.contact.m_flags&I.e_islandFlag||1!=a.contact.IsSensor()&&0!=a.contact.IsEnabled()&&0!=a.contact.IsTouching()&&(i.AddContact(a.contact),a.contact.m_flags|=I.e_islandFlag,r=a.other,r.m_flags&f.e_islandFlag||(o[s++]=r,r.m_flags|=f.e_islandFlag));for(e=e.m_jointList;e;e=e.next)1!=e.joint.m_islandFlag&&(r=e.other,0!=r.IsActive()&&(i.AddJoint(e.joint),e.joint.m_islandFlag=!0,r.m_flags&f.e_islandFlag||(o[s++]=r,r.m_flags|=f.e_islandFlag)))}for(i.Solve(t,this.m_gravity,this.m_allowSleep),s=0;i.m_bodyCount>s;++s)e=i.m_bodies[s],e.GetType()==f.b2_staticBody&&(e.m_flags&=~f.e_islandFlag)}for(s=0;o.length>s&&o[s];++s)o[s]=null;for(e=this.m_bodyList;e;e=e.m_next)0==e.IsAwake()||0==e.IsActive()||e.GetType()!=f.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},V.prototype.SolveTOI=function(t){var e,i,o,n=this.m_island;n.Initialize(this.m_bodyCount,s.b2_maxTOIContactsPerIsland,s.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var r=V.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~f.e_islandFlag,e.m_sweep.t0=0;for(o=this.m_contactList;o;o=o.m_next)o.m_flags&=~(I.e_toiFlag|I.e_islandFlag);for(o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(;;){var a=null,l=1;for(o=this.m_contactList;o;o=o.m_next)if(1!=o.IsSensor()&&0!=o.IsEnabled()&&0!=o.IsContinuous()){if(e=1,o.m_flags&I.e_toiFlag)e=o.m_toi;else{if(e=o.m_fixtureA,i=o.m_fixtureB,e=e.m_body,i=i.m_body,!(e.GetType()==f.b2_dynamicBody&&0!=e.IsAwake()||i.GetType()==f.b2_dynamicBody&&0!=i.IsAwake()))continue;var c=e.m_sweep.t0;e.m_sweep.t0<i.m_sweep.t0?(c=i.m_sweep.t0,e.m_sweep.Advance(c)):i.m_sweep.t0<e.m_sweep.t0&&(c=e.m_sweep.t0,i.m_sweep.Advance(c)),e=o.ComputeTOI(e.m_sweep,i.m_sweep),s.b2Assert(e>=0&&1>=e),e>0&&1>e&&(e=(1-e)*c+e,e>1&&(e=1)),o.m_toi=e,o.m_flags|=I.e_toiFlag}e>Number.MIN_VALUE&&l>e&&(a=o,l=e)}if(null==a||l>1-100*Number.MIN_VALUE)break;if(e=a.m_fixtureA,i=a.m_fixtureB,e=e.m_body,i=i.m_body,V.s_backupA.Set(e.m_sweep),V.s_backupB.Set(i.m_sweep),e.Advance(l),i.Advance(l),a.Update(this.m_contactManager.m_contactListener),a.m_flags&=~I.e_toiFlag,1==a.IsSensor()||0==a.IsEnabled())e.m_sweep.Set(V.s_backupA),i.m_sweep.Set(V.s_backupB),e.SynchronizeTransform(),i.SynchronizeTransform();else if(0!=a.IsTouching()){for(e=e,e.GetType()!=f.b2_dynamicBody&&(e=i),n.Clear(),a=o=0,r[o+a++]=e,e.m_flags|=f.e_islandFlag;a>0;)if(e=r[o++],--a,n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==f.b2_dynamicBody){for(i=e.m_contactList;i&&n.m_contactCount!=n.m_contactCapacity;i=i.next)i.contact.m_flags&I.e_islandFlag||1!=i.contact.IsSensor()&&0!=i.contact.IsEnabled()&&0!=i.contact.IsTouching()&&(n.AddContact(i.contact),i.contact.m_flags|=I.e_islandFlag,c=i.other,c.m_flags&f.e_islandFlag||(c.GetType()!=f.b2_staticBody&&(c.Advance(l),c.SetAwake(!0)),r[o+a]=c,++a,c.m_flags|=f.e_islandFlag));for(e=e.m_jointList;e;e=e.next)n.m_jointCount!=n.m_jointCapacity&&1!=e.joint.m_islandFlag&&(c=e.other,0!=c.IsActive()&&(n.AddJoint(e.joint),e.joint.m_islandFlag=!0,c.m_flags&f.e_islandFlag||(c.GetType()!=f.b2_staticBody&&(c.Advance(l),c.SetAwake(!0)),r[o+a]=c,++a,c.m_flags|=f.e_islandFlag)))}for(o=V.s_timestep,o.warmStarting=!1,o.dt=(1-l)*t.dt,o.inv_dt=1/o.dt,o.dtRatio=0,o.velocityIterations=t.velocityIterations,o.positionIterations=t.positionIterations,n.SolveTOI(o),l=l=0;n.m_bodyCount>l;++l)if(e=n.m_bodies[l],e.m_flags&=~f.e_islandFlag,0!=e.IsAwake()&&e.GetType()==f.b2_dynamicBody)for(e.SynchronizeFixtures(),i=e.m_contactList;i;i=i.next)i.contact.m_flags&=~I.e_toiFlag;for(l=0;n.m_contactCount>l;++l)o=n.m_contacts[l],o.m_flags&=~(I.e_toiFlag|I.e_islandFlag);for(l=0;n.m_jointCount>l;++l)o=n.m_joints[l],o.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}},V.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),o=e.m_xf.position,n=i.m_xf.position,s=t.GetAnchorA(),r=t.GetAnchorB(),a=V.s_jointColor;switch(t.m_type){case L.e_distanceJoint:this.m_debugDraw.DrawSegment(s,r,a);break;case L.e_pulleyJoint:e=t instanceof k?t:null,t=e.GetGroundAnchorA(),e=e.GetGroundAnchorB(),this.m_debugDraw.DrawSegment(t,s,a),this.m_debugDraw.DrawSegment(e,r,a),this.m_debugDraw.DrawSegment(t,e,a);break;case L.e_mouseJoint:this.m_debugDraw.DrawSegment(s,r,a);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(o,s,a),this.m_debugDraw.DrawSegment(s,r,a),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(n,r,a)}},V.prototype.DrawShape=function(e,i,o){switch(e.m_type){case y.e_circleShape:var n=e instanceof u?e:null;this.m_debugDraw.DrawSolidCircle(t.MulX(i,n.m_p),n.m_radius,i.R.col1,o);break;case y.e_polygonShape:n=0,n=e instanceof _?e:null,e=parseInt(n.GetVertexCount());var s=n.GetVertices(),r=new Vector(e);for(n=0;e>n;++n)r[n]=t.MulX(i,s[n]);this.m_debugDraw.DrawSolidPolygon(r,e,o);break;case y.e_edgeShape:n=e instanceof h?e:null,this.m_debugDraw.DrawSegment(t.MulX(i,n.GetVertex1()),t.MulX(i,n.GetVertex2()),o)}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new M,Box2D.Dynamics.b2World.s_xf=new i,Box2D.Dynamics.b2World.s_backupA=new e,Box2D.Dynamics.b2World.s_backupB=new e,Box2D.Dynamics.b2World.s_timestep=new M,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new n(.5,.8,.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=Box2D.Collision.Shapes.b2EdgeShape,i=Box2D.Collision.Shapes.b2PolygonShape,o=Box2D.Collision.Shapes.b2Shape,n=Box2D.Dynamics.Contacts.b2CircleContact,s=Box2D.Dynamics.Contacts.b2Contact,r=Box2D.Dynamics.Contacts.b2ContactConstraint,a=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,l=Box2D.Dynamics.Contacts.b2ContactEdge,c=Box2D.Dynamics.Contacts.b2ContactFactory,m=Box2D.Dynamics.Contacts.b2ContactRegister,u=Box2D.Dynamics.Contacts.b2ContactResult,h=Box2D.Dynamics.Contacts.b2ContactSolver,p=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,_=Box2D.Dynamics.Contacts.b2NullContact,y=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,f=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,d=Box2D.Dynamics.Contacts.b2PolygonContact,x=Box2D.Dynamics.Contacts.b2PositionSolverManifold,b=Box2D.Dynamics.b2Body,g=Box2D.Dynamics.b2TimeStep,v=Box2D.Common.b2Settings,w=Box2D.Common.Math.b2Mat22,C=Box2D.Common.Math.b2Math,B=Box2D.Common.Math.b2Vec2,D=Box2D.Collision.b2Collision,S=Box2D.Collision.b2ContactID,A=Box2D.Collision.b2Manifold,M=Box2D.Collision.b2TimeOfImpact,V=Box2D.Collision.b2TOIInput,I=Box2D.Collision.b2WorldManifold;Box2D.inherit(n,Box2D.Dynamics.Contacts.b2Contact),n.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,n.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},n.Create=function(){return new n},n.Destroy=function(){},n.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},n.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();D.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)},s.b2Contact=function(){this.m_nodeA=new l,this.m_nodeB=new l,this.m_manifold=new A,this.m_oldManifold=new A},s.prototype.GetManifold=function(){return this.m_manifold},s.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),o=this.m_fixtureA.GetShape(),n=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),o.m_radius,i.GetTransform(),n.m_radius)},s.prototype.IsTouching=function(){return(this.m_flags&s.e_touchingFlag)==s.e_touchingFlag},s.prototype.IsContinuous=function(){return(this.m_flags&s.e_continuousFlag)==s.e_continuousFlag},s.prototype.SetSensor=function(t){t?this.m_flags|=s.e_sensorFlag:this.m_flags&=~s.e_sensorFlag},s.prototype.IsSensor=function(){return(this.m_flags&s.e_sensorFlag)==s.e_sensorFlag},s.prototype.SetEnabled=function(t){t?this.m_flags|=s.e_enabledFlag:this.m_flags&=~s.e_enabledFlag},s.prototype.IsEnabled=function(){return(this.m_flags&s.e_enabledFlag)==s.e_enabledFlag},s.prototype.GetNext=function(){return this.m_next},s.prototype.GetFixtureA=function(){return this.m_fixtureA},s.prototype.GetFixtureB=function(){return this.m_fixtureB},s.prototype.FlagForFiltering=function(){this.m_flags|=s.e_filterFlag},s.prototype.b2Contact=function(){},s.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=s.e_enabledFlag,t&&e){(t.IsSensor()||e.IsSensor())&&(this.m_flags|=s.e_sensorFlag);var i=t.GetBody(),o=e.GetBody();(i.GetType()!=b.b2_dynamicBody||i.IsBullet()||o.GetType()!=b.b2_dynamicBody||o.IsBullet())&&(this.m_flags|=s.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_next=this.m_prev=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null}else this.m_fixtureB=this.m_fixtureA=null},s.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=s.e_enabledFlag;var i=!1;e=(this.m_flags&s.e_touchingFlag)==s.e_touchingFlag;var n=this.m_fixtureA.m_body,r=this.m_fixtureB.m_body,a=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&s.e_sensorFlag)a&&(i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape(),n=n.GetTransform(),r=r.GetTransform(),i=o.TestOverlap(i,n,a,r)),this.m_manifold.m_pointCount=0;else{if(n.GetType()!=b.b2_dynamicBody||n.IsBullet()||r.GetType()!=b.b2_dynamicBody||r.IsBullet()?this.m_flags|=s.e_continuousFlag:this.m_flags&=~s.e_continuousFlag,a)for(this.Evaluate(),i=this.m_manifold.m_pointCount>0,a=0;this.m_manifold.m_pointCount>a;++a){var l=this.m_manifold.m_points[a];l.m_normalImpulse=0,l.m_tangentImpulse=0;for(var c=l.m_id,m=0;this.m_oldManifold.m_pointCount>m;++m){var u=this.m_oldManifold.m_points[m];if(u.m_id.key==c.key){l.m_normalImpulse=u.m_normalImpulse,l.m_tangentImpulse=u.m_tangentImpulse;break}}}else this.m_manifold.m_pointCount=0;i!=e&&(n.SetAwake(!0),r.SetAwake(!0))}i?this.m_flags|=s.e_touchingFlag:this.m_flags&=~s.e_touchingFlag,0==e&&1==i&&t.BeginContact(this),1==e&&0==i&&t.EndContact(this),0==(this.m_flags&s.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},s.prototype.Evaluate=function(){},s.prototype.ComputeTOI=function(t,e){return s.s_input.proxyA.Set(this.m_fixtureA.GetShape()),s.s_input.proxyB.Set(this.m_fixtureB.GetShape()),s.s_input.sweepA=t,s.s_input.sweepB=e,s.s_input.tolerance=v.b2_linearSlop,M.TimeOfImpact(s.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new V}),r.b2ContactConstraint=function(){this.localPlaneNormal=new B,this.localPoint=new B,this.normal=new B,this.normalMass=new w,this.K=new w},r.prototype.b2ContactConstraint=function(){this.points=new Vector(v.b2_maxManifoldPoints);for(var t=0;v.b2_maxManifoldPoints>t;t++)this.points[t]=new a},a.b2ContactConstraintPoint=function(){this.localPoint=new B,this.rA=new B,this.rB=new B},l.b2ContactEdge=function(){},c.b2ContactFactory=function(){},c.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},c.prototype.AddType=function(t,e,i,o){void 0===i&&(i=0),void 0===o&&(o=0),this.m_registers[i][o].createFcn=t,this.m_registers[i][o].destroyFcn=e,this.m_registers[i][o].primary=!0,i!=o&&(this.m_registers[o][i].createFcn=t,this.m_registers[o][i].destroyFcn=e,this.m_registers[o][i].primary=!1)},c.prototype.InitializeRegisters=function(){this.m_registers=new Vector(o.e_shapeTypeCount);for(var t=0;o.e_shapeTypeCount>t;t++){this.m_registers[t]=new Vector(o.e_shapeTypeCount);for(var e=0;o.e_shapeTypeCount>e;e++)this.m_registers[t][e]=new m}this.AddType(n.Create,n.Destroy,o.e_circleShape,o.e_circleShape),this.AddType(y.Create,y.Destroy,o.e_polygonShape,o.e_circleShape),this.AddType(d.Create,d.Destroy,o.e_polygonShape,o.e_polygonShape),this.AddType(p.Create,p.Destroy,o.e_edgeShape,o.e_circleShape),this.AddType(f.Create,f.Destroy,o.e_polygonShape,o.e_edgeShape)
},c.prototype.Create=function(t,e){var i=parseInt(t.GetType()),o=parseInt(e.GetType());return i=this.m_registers[i][o],i.pool?(o=i.pool,i.pool=o.m_next,i.poolCount--,o.Reset(t,e),o):(o=i.createFcn,null!=o?(i.primary?(o=o(this.m_allocator),o.Reset(t,e)):(o=o(this.m_allocator),o.Reset(e,t)),o):null)},c.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType());e=this.m_registers[e][i],e.poolCount++,t.m_next=e.pool,e.pool=t,e=e.destroyFcn,e(t,this.m_allocator)},m.b2ContactRegister=function(){},u.b2ContactResult=function(){this.position=new B,this.normal=new B,this.id=new S},h.b2ContactSolver=function(){this.m_step=new g,this.m_constraints=new Vector},h.prototype.b2ContactSolver=function(){},h.prototype.Initialize=function(t,e,i,o){void 0===i&&(i=0);var n;for(this.m_step.Set(t),this.m_allocator=o,t=0,this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new r;for(t=0;i>t;++t){n=e[t],o=n.m_fixtureA;var s=n.m_fixtureB,a=o.m_shape.m_radius,l=s.m_shape.m_radius,c=o.m_body,m=s.m_body,u=n.GetManifold(),p=v.b2MixFriction(o.GetFriction(),s.GetFriction()),_=v.b2MixRestitution(o.GetRestitution(),s.GetRestitution()),y=c.m_linearVelocity.x,f=c.m_linearVelocity.y,d=m.m_linearVelocity.x,x=m.m_linearVelocity.y,b=c.m_angularVelocity,g=m.m_angularVelocity;for(v.b2Assert(u.m_pointCount>0),h.s_worldManifold.Initialize(u,c.m_xf,a,m.m_xf,l),s=h.s_worldManifold.m_normal.x,n=h.s_worldManifold.m_normal.y,o=this.m_constraints[t],o.bodyA=c,o.bodyB=m,o.manifold=u,o.normal.x=s,o.normal.y=n,o.pointCount=u.m_pointCount,o.friction=p,o.restitution=_,o.localPlaneNormal.x=u.m_localPlaneNormal.x,o.localPlaneNormal.y=u.m_localPlaneNormal.y,o.localPoint.x=u.m_localPoint.x,o.localPoint.y=u.m_localPoint.y,o.radius=a+l,o.type=u.m_type,a=0;o.pointCount>a;++a){p=u.m_points[a],l=o.points[a],l.normalImpulse=p.m_normalImpulse,l.tangentImpulse=p.m_tangentImpulse,l.localPoint.SetV(p.m_localPoint),p=l.rA.x=h.s_worldManifold.m_points[a].x-c.m_sweep.c.x,_=l.rA.y=h.s_worldManifold.m_points[a].y-c.m_sweep.c.y;var w=l.rB.x=h.s_worldManifold.m_points[a].x-m.m_sweep.c.x,C=l.rB.y=h.s_worldManifold.m_points[a].y-m.m_sweep.c.y,B=p*n-_*s,D=w*n-C*s;B*=B,D*=D,l.normalMass=1/(c.m_invMass+m.m_invMass+c.m_invI*B+m.m_invI*D);var S=c.m_mass*c.m_invMass+m.m_mass*m.m_invMass;S+=c.m_mass*c.m_invI*B+m.m_mass*m.m_invI*D,l.equalizedMass=1/S,D=n,S=-s,B=p*S-_*D,D=w*S-C*D,B*=B,D*=D,l.tangentMass=1/(c.m_invMass+m.m_invMass+c.m_invI*B+m.m_invI*D),l.velocityBias=0,p=o.normal.x*(d+-g*C-y- -b*_)+o.normal.y*(x+g*w-f-b*p),-v.b2_velocityThreshold>p&&(l.velocityBias+=-o.restitution*p)}2==o.pointCount&&(x=o.points[0],d=o.points[1],u=c.m_invMass,c=c.m_invI,y=m.m_invMass,m=m.m_invI,f=x.rA.x*n-x.rA.y*s,x=x.rB.x*n-x.rB.y*s,b=d.rA.x*n-d.rA.y*s,d=d.rB.x*n-d.rB.y*s,s=u+y+c*f*f+m*x*x,n=u+y+c*b*b+m*d*d,m=u+y+c*f*b+m*x*d,100*(s*n-m*m)>s*s?(o.K.col1.Set(s,m),o.K.col2.Set(m,n),o.K.GetInverse(o.normalMass)):o.pointCount=1)}},h.prototype.InitVelocityConstraints=function(t){for(var e=0;this.m_constraintCount>e;++e){var i=this.m_constraints[e],o=i.bodyA,n=i.bodyB,s=o.m_invMass,r=o.m_invI,a=n.m_invMass,l=n.m_invI,c=i.normal.x,m=i.normal.y,u=m,h=-c,p=0,_=0;if(t.warmStarting)for(_=i.pointCount,p=0;_>p;++p){var y=i.points[p];y.normalImpulse*=t.dtRatio,y.tangentImpulse*=t.dtRatio;var f=y.normalImpulse*c+y.tangentImpulse*u,d=y.normalImpulse*m+y.tangentImpulse*h;o.m_angularVelocity-=r*(y.rA.x*d-y.rA.y*f),o.m_linearVelocity.x-=s*f,o.m_linearVelocity.y-=s*d,n.m_angularVelocity+=l*(y.rB.x*d-y.rB.y*f),n.m_linearVelocity.x+=a*f,n.m_linearVelocity.y+=a*d}else for(_=i.pointCount,p=0;_>p;++p)o=i.points[p],o.normalImpulse=0,o.tangentImpulse=0}},h.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,o=0,n=0,s=0,r=n=n=o=o=0,a=o=o=0,l=o=s=0,c=0,m=0;this.m_constraintCount>m;++m){s=this.m_constraints[m];var u=s.bodyA,h=s.bodyB,p=u.m_angularVelocity,_=h.m_angularVelocity,y=u.m_linearVelocity,f=h.m_linearVelocity,d=u.m_invMass,x=u.m_invI,b=h.m_invMass,g=h.m_invI;l=s.normal.x;var v=c=s.normal.y;for(e=-l,a=s.friction,i=0;s.pointCount>i;i++)t=s.points[i],o=f.x-_*t.rB.y-y.x+p*t.rA.y,n=f.y+_*t.rB.x-y.y-p*t.rA.x,o=o*v+n*e,o=t.tangentMass*-o,n=a*t.normalImpulse,n=C.Clamp(t.tangentImpulse+o,-n,n),o=n-t.tangentImpulse,r=o*v,o*=e,y.x-=d*r,y.y-=d*o,p-=x*(t.rA.x*o-t.rA.y*r),f.x+=b*r,f.y+=b*o,_+=g*(t.rB.x*o-t.rB.y*r),t.tangentImpulse=n;if(parseInt(s.pointCount),1==s.pointCount)t=s.points[0],o=f.x+-_*t.rB.y-y.x- -p*t.rA.y,n=f.y+_*t.rB.x-y.y-p*t.rA.x,s=o*l+n*c,o=-t.normalMass*(s-t.velocityBias),n=t.normalImpulse+o,n=n>0?n:0,o=n-t.normalImpulse,r=o*l,o*=c,y.x-=d*r,y.y-=d*o,p-=x*(t.rA.x*o-t.rA.y*r),f.x+=b*r,f.y+=b*o,_+=g*(t.rB.x*o-t.rB.y*r),t.normalImpulse=n;else{t=s.points[0],i=s.points[1],o=t.normalImpulse,a=i.normalImpulse;var w=(f.x-_*t.rB.y-y.x+p*t.rA.y)*l+(f.y+_*t.rB.x-y.y-p*t.rA.x)*c,B=(f.x-_*i.rB.y-y.x+p*i.rA.y)*l+(f.y+_*i.rB.x-y.y-p*i.rA.x)*c;for(n=w-t.velocityBias,r=B-i.velocityBias,e=s.K,n-=e.col1.x*o+e.col2.x*a,r-=e.col1.y*o+e.col2.y*a;;){if(e=s.normalMass,v=-(e.col1.x*n+e.col2.x*r),e=-(e.col1.y*n+e.col2.y*r),v>=0&&e>=0){o=v-o,a=e-a,s=o*l,o*=c,l=a*l,c=a*c,y.x-=d*(s+l),y.y-=d*(o+c),p-=x*(t.rA.x*o-t.rA.y*s+i.rA.x*c-i.rA.y*l),f.x+=b*(s+l),f.y+=b*(o+c),_+=g*(t.rB.x*o-t.rB.y*s+i.rB.x*c-i.rB.y*l),t.normalImpulse=v,i.normalImpulse=e;break}if(v=-t.normalMass*n,e=0,B=s.K.col1.y*v+r,v>=0&&B>=0){o=v-o,a=e-a,s=o*l,o*=c,l=a*l,c=a*c,y.x-=d*(s+l),y.y-=d*(o+c),p-=x*(t.rA.x*o-t.rA.y*s+i.rA.x*c-i.rA.y*l),f.x+=b*(s+l),f.y+=b*(o+c),_+=g*(t.rB.x*o-t.rB.y*s+i.rB.x*c-i.rB.y*l),t.normalImpulse=v,i.normalImpulse=e;break}if(v=0,e=-i.normalMass*r,w=s.K.col2.x*e+n,e>=0&&w>=0){o=v-o,a=e-a,s=o*l,o*=c,l=a*l,c=a*c,y.x-=d*(s+l),y.y-=d*(o+c),p-=x*(t.rA.x*o-t.rA.y*s+i.rA.x*c-i.rA.y*l),f.x+=b*(s+l),f.y+=b*(o+c),_+=g*(t.rB.x*o-t.rB.y*s+i.rB.x*c-i.rB.y*l),t.normalImpulse=v,i.normalImpulse=e;break}if(e=v=0,w=n,B=r,w>=0&&B>=0){o=v-o,a=e-a,s=o*l,o*=c,l=a*l,c=a*c,y.x-=d*(s+l),y.y-=d*(o+c),p-=x*(t.rA.x*o-t.rA.y*s+i.rA.x*c-i.rA.y*l),f.x+=b*(s+l),f.y+=b*(o+c),_+=g*(t.rB.x*o-t.rB.y*s+i.rB.x*c-i.rB.y*l),t.normalImpulse=v,i.normalImpulse=e;break}break}}u.m_angularVelocity=p,h.m_angularVelocity=_}},h.prototype.FinalizeVelocityConstraints=function(){for(var t=0;this.m_constraintCount>t;++t)for(var e=this.m_constraints[t],i=e.manifold,o=0;e.pointCount>o;++o){var n=i.m_points[o],s=e.points[o];n.m_normalImpulse=s.normalImpulse,n.m_tangentImpulse=s.tangentImpulse}},h.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;this.m_constraintCount>i;i++){var o=this.m_constraints[i],n=o.bodyA,s=o.bodyB,r=n.m_mass*n.m_invMass,a=n.m_mass*n.m_invI,l=s.m_mass*s.m_invMass,c=s.m_mass*s.m_invI;h.s_psm.Initialize(o);for(var m=h.s_psm.m_normal,u=0;o.pointCount>u;u++){var p=o.points[u],_=h.s_psm.m_points[u],y=h.s_psm.m_separations[u],f=_.x-n.m_sweep.c.x,d=_.y-n.m_sweep.c.y,x=_.x-s.m_sweep.c.x;_=_.y-s.m_sweep.c.y,e=y>e?e:y,y=C.Clamp(t*(y+v.b2_linearSlop),-v.b2_maxLinearCorrection,0),y=-p.equalizedMass*y,p=y*m.x,y*=m.y,n.m_sweep.c.x-=r*p,n.m_sweep.c.y-=r*y,n.m_sweep.a-=a*(f*y-d*p),n.SynchronizeTransform(),s.m_sweep.c.x+=l*p,s.m_sweep.c.y+=l*y,s.m_sweep.a+=c*(x*y-_*p),s.SynchronizeTransform()}}return e>-1.5*v.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new I,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new x}),Box2D.inherit(p,Box2D.Dynamics.Contacts.b2Contact),p.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,p.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},p.Create=function(){return new p},p.Destroy=function(){},p.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},p.prototype.Evaluate=function(){var i=this.m_fixtureA.GetBody(),o=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,i.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,o.m_xf)},p.prototype.b2CollideEdgeAndCircle=function(){},Box2D.inherit(_,Box2D.Dynamics.Contacts.b2Contact),_.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,_.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},_.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},_.prototype.Evaluate=function(){},Box2D.inherit(y,Box2D.Dynamics.Contacts.b2Contact),y.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,y.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},y.Create=function(){return new y},y.Destroy=function(){},y.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),v.b2Assert(t.GetType()==o.e_polygonShape),v.b2Assert(e.GetType()==o.e_circleShape)},y.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,o=this.m_fixtureB.m_body;D.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,o.m_xf)},Box2D.inherit(f,Box2D.Dynamics.Contacts.b2Contact),f.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,f.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},f.Create=function(){return new f},f.Destroy=function(){},f.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),v.b2Assert(t.GetType()==o.e_polygonShape),v.b2Assert(e.GetType()==o.e_edgeShape)},f.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),o=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,o.m_xf)},f.prototype.b2CollidePolyAndEdge=function(){},Box2D.inherit(d,Box2D.Dynamics.Contacts.b2Contact),d.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,d.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},d.Create=function(){return new d},d.Destroy=function(){},d.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},d.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();D.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},x.b2PositionSolverManifold=function(){},x.prototype.b2PositionSolverManifold=function(){this.m_normal=new B,this.m_separations=new Vector_a2j_Number(v.b2_maxManifoldPoints),this.m_points=new Vector(v.b2_maxManifoldPoints);for(var t=0;v.b2_maxManifoldPoints>t;t++)this.m_points[t]=new B},x.prototype.Initialize=function(t){v.b2Assert(t.pointCount>0);var e,i=0,o=0,n=0,s=0,r=0;switch(t.type){case A.e_circles:e=t.bodyA.m_xf.R,n=t.localPoint,i=t.bodyA.m_xf.position.x+(e.col1.x*n.x+e.col2.x*n.y),o=t.bodyA.m_xf.position.y+(e.col1.y*n.x+e.col2.y*n.y),e=t.bodyB.m_xf.R,n=t.points[0].localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*n.x+e.col2.x*n.y),e=t.bodyB.m_xf.position.y+(e.col1.y*n.x+e.col2.y*n.y),n=s-i,r=e-o;var a=n*n+r*r;a>Number.MIN_VALUE*Number.MIN_VALUE?(a=Math.sqrt(a),this.m_normal.x=n/a,this.m_normal.y=r/a):(this.m_normal.x=1,this.m_normal.y=0),this.m_points[0].x=.5*(i+s),this.m_points[0].y=.5*(o+e),this.m_separations[0]=n*this.m_normal.x+r*this.m_normal.y-t.radius;break;case A.e_faceA:for(e=t.bodyA.m_xf.R,n=t.localPlaneNormal,this.m_normal.x=e.col1.x*n.x+e.col2.x*n.y,this.m_normal.y=e.col1.y*n.x+e.col2.y*n.y,e=t.bodyA.m_xf.R,n=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*n.x+e.col2.x*n.y),r=t.bodyA.m_xf.position.y+(e.col1.y*n.x+e.col2.y*n.y),e=t.bodyB.m_xf.R,i=0;t.pointCount>i;++i)n=t.points[i].localPoint,o=t.bodyB.m_xf.position.x+(e.col1.x*n.x+e.col2.x*n.y),n=t.bodyB.m_xf.position.y+(e.col1.y*n.x+e.col2.y*n.y),this.m_separations[i]=(o-s)*this.m_normal.x+(n-r)*this.m_normal.y-t.radius,this.m_points[i].x=o,this.m_points[i].y=n;break;case A.e_faceB:for(e=t.bodyB.m_xf.R,n=t.localPlaneNormal,this.m_normal.x=e.col1.x*n.x+e.col2.x*n.y,this.m_normal.y=e.col1.y*n.x+e.col2.y*n.y,e=t.bodyB.m_xf.R,n=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*n.x+e.col2.x*n.y),r=t.bodyB.m_xf.position.y+(e.col1.y*n.x+e.col2.y*n.y),e=t.bodyA.m_xf.R,i=0;t.pointCount>i;++i)n=t.points[i].localPoint,o=t.bodyA.m_xf.position.x+(e.col1.x*n.x+e.col2.x*n.y),n=t.bodyA.m_xf.position.y+(e.col1.y*n.x+e.col2.y*n.y),this.m_separations[i]=(o-s)*this.m_normal.x+(n-r)*this.m_normal.y-t.radius,this.m_points[i].Set(o,n);this.m_normal.x*=-1,this.m_normal.y*=-1}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new B,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new B})}(),function(){var t=Box2D.Common.Math.b2Mat22,e=Box2D.Common.Math.b2Math,i=Box2D.Common.Math.b2Vec2,o=Box2D.Common.b2Color,n=Box2D.Dynamics.Controllers.b2BuoyancyController,s=Box2D.Dynamics.Controllers.b2ConstantAccelController,r=Box2D.Dynamics.Controllers.b2ConstantForceController,a=Box2D.Dynamics.Controllers.b2Controller,l=Box2D.Dynamics.Controllers.b2ControllerEdge,c=Box2D.Dynamics.Controllers.b2GravityController,m=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(n,Box2D.Dynamics.Controllers.b2Controller),n.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,n.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new i(0,-1),this.density=this.offset=0,this.velocity=new i(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},n.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var t=this.m_bodyList;t;t=t.nextBody){var e=t.body;if(0!=e.IsAwake()){for(var o=new i,n=new i,s=0,r=0,a=e.GetFixtureList();a;a=a.GetNext()){var l=new i,c=a.GetShape().ComputeSubmergedArea(this.normal,this.offset,e.GetTransform(),l);s+=c,o.x+=c*l.x,o.y+=c*l.y;var m=0;m=1,r+=c*m,n.x+=c*l.x*m,n.y+=c*l.y*m}o.x/=s,o.y/=s,n.x/=r,n.y/=r,Number.MIN_VALUE>s||(r=this.gravity.GetNegative(),r.Multiply(this.density*s),e.ApplyForce(r,n),n=e.GetLinearVelocityFromWorldPoint(o),n.Subtract(this.velocity),n.Multiply(-this.linearDrag*s),e.ApplyForce(n,o),e.ApplyTorque(-e.GetInertia()/e.GetMass()*s*e.GetAngularVelocity()*this.angularDrag))}}}},n.prototype.Draw=function(t){var e=new i,n=new i;e.x=this.normal.x*this.offset+1e3*this.normal.y,e.y=this.normal.y*this.offset-1e3*this.normal.x,n.x=this.normal.x*this.offset-1e3*this.normal.y,n.y=this.normal.y*this.offset+1e3*this.normal.x;var s=new o(0,0,1);t.DrawSegment(e,n,s)},Box2D.inherit(s,Box2D.Dynamics.Controllers.b2Controller),s.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,s.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new i(0,0)},s.prototype.Step=function(t){t=new i(this.A.x*t.dt,this.A.y*t.dt);for(var e=this.m_bodyList;e;e=e.nextBody){var o=e.body;o.IsAwake()&&o.SetLinearVelocity(new i(o.GetLinearVelocity().x+t.x,o.GetLinearVelocity().y+t.y))}},Box2D.inherit(r,Box2D.Dynamics.Controllers.b2Controller),r.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,r.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new i(0,0)},r.prototype.Step=function(){for(var t=this.m_bodyList;t;t=t.nextBody){var e=t.body;e.IsAwake()&&e.ApplyForce(this.F,e.GetWorldCenter())}},a.b2Controller=function(){},a.prototype.Step=function(){},a.prototype.Draw=function(){},a.prototype.AddBody=function(t){var e=new l;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},a.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},a.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},a.prototype.GetNext=function(){return this.m_next},a.prototype.GetWorld=function(){return this.m_world},a.prototype.GetBodyList=function(){return this.m_bodyList},l.b2ControllerEdge=function(){},Box2D.inherit(c,Box2D.Dynamics.Controllers.b2Controller),c.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,c.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},c.prototype.Step=function(){var t=null,e=null,o=null,n=0,s=null,r=null,a=null,l=0,c=0,m=0;if(l=null,this.invSqr)for(t=this.m_bodyList;t;t=t.nextBody)for(e=t.body,o=e.GetWorldCenter(),n=e.GetMass(),s=this.m_bodyList;s!=t;s=s.nextBody)r=s.body,a=r.GetWorldCenter(),l=a.x-o.x,c=a.y-o.y,m=l*l+c*c,Number.MIN_VALUE>m||(l=new i(l,c),l.Multiply(this.G/m/Math.sqrt(m)*n*r.GetMass()),e.IsAwake()&&e.ApplyForce(l,o),l.Multiply(-1),r.IsAwake()&&r.ApplyForce(l,a));else for(t=this.m_bodyList;t;t=t.nextBody)for(e=t.body,o=e.GetWorldCenter(),n=e.GetMass(),s=this.m_bodyList;s!=t;s=s.nextBody)r=s.body,a=r.GetWorldCenter(),l=a.x-o.x,c=a.y-o.y,m=l*l+c*c,Number.MIN_VALUE>m||(l=new i(l,c),l.Multiply(this.G/m*n*r.GetMass()),e.IsAwake()&&e.ApplyForce(l,o),l.Multiply(-1),r.IsAwake()&&r.ApplyForce(l,a))},Box2D.inherit(m,Box2D.Dynamics.Controllers.b2Controller),m.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,m.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},m.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,this.maxTimestep=t>0||e>0?1/Math.max(t,e):0},m.prototype.Step=function(t){if(t=t.dt,!(Number.MIN_VALUE>=t)){t>this.maxTimestep&&this.maxTimestep>0&&(t=this.maxTimestep);for(var o=this.m_bodyList;o;o=o.nextBody){var n=o.body;if(n.IsAwake()){var s=n.GetWorldVector(e.MulMV(this.T,n.GetLocalVector(n.GetLinearVelocity())));n.SetLinearVelocity(new i(n.GetLinearVelocity().x+s.x*t,n.GetLinearVelocity().y+s.y*t))}}}}}(),function(){var t=Box2D.Common.b2Settings,e=Box2D.Common.Math.b2Mat22,i=Box2D.Common.Math.b2Mat33,o=Box2D.Common.Math.b2Math,n=Box2D.Common.Math.b2Vec2,s=Box2D.Common.Math.b2Vec3,r=Box2D.Dynamics.Joints.b2DistanceJoint,a=Box2D.Dynamics.Joints.b2DistanceJointDef,l=Box2D.Dynamics.Joints.b2FrictionJoint,c=Box2D.Dynamics.Joints.b2FrictionJointDef,m=Box2D.Dynamics.Joints.b2GearJoint,u=Box2D.Dynamics.Joints.b2GearJointDef,h=Box2D.Dynamics.Joints.b2Jacobian,p=Box2D.Dynamics.Joints.b2Joint,_=Box2D.Dynamics.Joints.b2JointDef,y=Box2D.Dynamics.Joints.b2JointEdge,f=Box2D.Dynamics.Joints.b2LineJoint,d=Box2D.Dynamics.Joints.b2LineJointDef,x=Box2D.Dynamics.Joints.b2MouseJoint,b=Box2D.Dynamics.Joints.b2MouseJointDef,g=Box2D.Dynamics.Joints.b2PrismaticJoint,v=Box2D.Dynamics.Joints.b2PrismaticJointDef,w=Box2D.Dynamics.Joints.b2PulleyJoint,C=Box2D.Dynamics.Joints.b2PulleyJointDef,B=Box2D.Dynamics.Joints.b2RevoluteJoint,D=Box2D.Dynamics.Joints.b2RevoluteJointDef,S=Box2D.Dynamics.Joints.b2WeldJoint,A=Box2D.Dynamics.Joints.b2WeldJointDef;Box2D.inherit(r,Box2D.Dynamics.Joints.b2Joint),r.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,r.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new n,this.m_localAnchor2=new n,this.m_u=new n},r.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},r.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},r.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},r.prototype.GetReactionTorque=function(){return 0},r.prototype.GetLength=function(){return this.m_length},r.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},r.prototype.GetFrequency=function(){return this.m_frequencyHz},r.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},r.prototype.GetDampingRatio=function(){return this.m_dampingRatio},r.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},r.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=this.m_gamma=this.m_impulse=0},r.prototype.InitVelocityConstraints=function(e){var i,o=0,n=this.m_bodyA,s=this.m_bodyB;i=n.m_xf.R;var r=this.m_localAnchor1.x-n.m_sweep.localCenter.x,a=this.m_localAnchor1.y-n.m_sweep.localCenter.y;o=i.col1.x*r+i.col2.x*a,a=i.col1.y*r+i.col2.y*a,r=o,i=s.m_xf.R;var l=this.m_localAnchor2.x-s.m_sweep.localCenter.x,c=this.m_localAnchor2.y-s.m_sweep.localCenter.y;o=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=o,this.m_u.x=s.m_sweep.c.x+l-n.m_sweep.c.x-r,this.m_u.y=s.m_sweep.c.y+c-n.m_sweep.c.y-a,o=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y),o>t.b2_linearSlop?this.m_u.Multiply(1/o):this.m_u.SetZero(),i=r*this.m_u.y-a*this.m_u.x;var m=l*this.m_u.y-c*this.m_u.x;if(i=n.m_invMass+n.m_invI*i*i+s.m_invMass+s.m_invI*m*m,this.m_mass=0!=i?1/i:0,this.m_frequencyHz>0){o-=this.m_length,m=2*Math.PI*this.m_frequencyHz;var u=this.m_mass*m*m;this.m_gamma=e.dt*(2*this.m_mass*this.m_dampingRatio*m+e.dt*u),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=o*e.dt*u*this.m_gamma,this.m_mass=i+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}e.warmStarting?(this.m_impulse*=e.dtRatio,e=this.m_impulse*this.m_u.x,i=this.m_impulse*this.m_u.y,n.m_linearVelocity.x-=n.m_invMass*e,n.m_linearVelocity.y-=n.m_invMass*i,n.m_angularVelocity-=n.m_invI*(r*i-a*e),s.m_linearVelocity.x+=s.m_invMass*e,s.m_linearVelocity.y+=s.m_invMass*i,s.m_angularVelocity+=s.m_invI*(l*i-c*e)):this.m_impulse=0},r.prototype.SolveVelocityConstraints=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var o=this.m_localAnchor1.x-e.m_sweep.localCenter.x,n=this.m_localAnchor1.y-e.m_sweep.localCenter.y,s=t.col1.x*o+t.col2.x*n;n=t.col1.y*o+t.col2.y*n,o=s,t=i.m_xf.R;var r=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;s=t.col1.x*r+t.col2.x*a,a=t.col1.y*r+t.col2.y*a,r=s,s=-this.m_mass*(this.m_u.x*(i.m_linearVelocity.x+-i.m_angularVelocity*a-(e.m_linearVelocity.x+-e.m_angularVelocity*n))+this.m_u.y*(i.m_linearVelocity.y+i.m_angularVelocity*r-(e.m_linearVelocity.y+e.m_angularVelocity*o))+this.m_bias+this.m_gamma*this.m_impulse),this.m_impulse+=s,t=s*this.m_u.x,s*=this.m_u.y,e.m_linearVelocity.x-=e.m_invMass*t,e.m_linearVelocity.y-=e.m_invMass*s,e.m_angularVelocity-=e.m_invI*(o*s-n*t),i.m_linearVelocity.x+=i.m_invMass*t,i.m_linearVelocity.y+=i.m_invMass*s,i.m_angularVelocity+=i.m_invI*(r*s-a*t)},r.prototype.SolvePositionConstraints=function(){var e;if(this.m_frequencyHz>0)return!0;var i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var s=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=e.col1.x*s+e.col2.x*r;r=e.col1.y*s+e.col2.y*r,s=a,e=n.m_xf.R;var l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y;a=e.col1.x*l+e.col2.x*c,c=e.col1.y*l+e.col2.y*c,l=a,a=n.m_sweep.c.x+l-i.m_sweep.c.x-s;var m=n.m_sweep.c.y+c-i.m_sweep.c.y-r;e=Math.sqrt(a*a+m*m),a/=e,m/=e,e-=this.m_length,e=o.Clamp(e,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var u=-this.m_mass*e;return this.m_u.Set(a,m),a=u*this.m_u.x,m=u*this.m_u.y,i.m_sweep.c.x-=i.m_invMass*a,i.m_sweep.c.y-=i.m_invMass*m,i.m_sweep.a-=i.m_invI*(s*m-r*a),n.m_sweep.c.x+=n.m_invMass*a,n.m_sweep.c.y+=n.m_invMass*m,n.m_sweep.a+=n.m_invI*(l*m-c*a),i.SynchronizeTransform(),n.SynchronizeTransform(),o.Abs(e)<t.b2_linearSlop},Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef),a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,a.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new n,this.localAnchorB=new n},a.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_distanceJoint,this.length=1,this.dampingRatio=this.frequencyHz=0},a.prototype.Initialize=function(t,e,i,o){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(o)),t=o.x-i.x,i=o.y-i.y,this.length=Math.sqrt(t*t+i*i),this.dampingRatio=this.frequencyHz=0},Box2D.inherit(l,Box2D.Dynamics.Joints.b2Joint),l.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,l.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new n,this.m_localAnchorB=new n,this.m_linearMass=new e,this.m_linearImpulse=new n},l.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},l.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},l.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},l.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},l.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},l.prototype.GetMaxForce=function(){return this.m_maxForce},l.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},l.prototype.GetMaxTorque=function(){return this.m_maxTorque},l.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},l.prototype.InitVelocityConstraints=function(t){var i,o=0,n=this.m_bodyA,s=this.m_bodyB;i=n.m_xf.R;var r=this.m_localAnchorA.x-n.m_sweep.localCenter.x,a=this.m_localAnchorA.y-n.m_sweep.localCenter.y;o=i.col1.x*r+i.col2.x*a,a=i.col1.y*r+i.col2.y*a,r=o,i=s.m_xf.R;var l=this.m_localAnchorB.x-s.m_sweep.localCenter.x,c=this.m_localAnchorB.y-s.m_sweep.localCenter.y;o=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=o,i=n.m_invMass,o=s.m_invMass;var m=n.m_invI,u=s.m_invI,h=new e;h.col1.x=i+o,h.col2.x=0,h.col1.y=0,h.col2.y=i+o,h.col1.x+=m*a*a,h.col2.x+=-m*r*a,h.col1.y+=-m*r*a,h.col2.y+=m*r*r,h.col1.x+=u*c*c,h.col2.x+=-u*l*c,h.col1.y+=-u*l*c,h.col2.y+=u*l*l,h.GetInverse(this.m_linearMass),this.m_angularMass=m+u,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting?(this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio,t=this.m_linearImpulse,n.m_linearVelocity.x-=i*t.x,n.m_linearVelocity.y-=i*t.y,n.m_angularVelocity-=m*(r*t.y-a*t.x+this.m_angularImpulse),s.m_linearVelocity.x+=o*t.x,s.m_linearVelocity.y+=o*t.y,s.m_angularVelocity+=u*(l*t.y-c*t.x+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0)},l.prototype.SolveVelocityConstraints=function(t){var e,i=0,s=this.m_bodyA,r=this.m_bodyB,a=s.m_linearVelocity,l=s.m_angularVelocity,c=r.m_linearVelocity,m=r.m_angularVelocity,u=s.m_invMass,h=r.m_invMass,p=s.m_invI,_=r.m_invI;e=s.m_xf.R;var y=this.m_localAnchorA.x-s.m_sweep.localCenter.x,f=this.m_localAnchorA.y-s.m_sweep.localCenter.y;i=e.col1.x*y+e.col2.x*f,f=e.col1.y*y+e.col2.y*f,y=i,e=r.m_xf.R;var d=this.m_localAnchorB.x-r.m_sweep.localCenter.x,x=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*d+e.col2.x*x,x=e.col1.y*d+e.col2.y*x,d=i,e=0,i=-this.m_angularMass*(m-l);var b=this.m_angularImpulse;e=t.dt*this.m_maxTorque,this.m_angularImpulse=o.Clamp(this.m_angularImpulse+i,-e,e),i=this.m_angularImpulse-b,l-=p*i,m+=_*i,e=o.MulMV(this.m_linearMass,new n(-(c.x-m*x-a.x+l*f),-(c.y+m*d-a.y-l*y))),i=this.m_linearImpulse.Copy(),this.m_linearImpulse.Add(e),e=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>e*e&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(e)),e=o.SubtractVV(this.m_linearImpulse,i),a.x-=u*e.x,a.y-=u*e.y,l-=p*(y*e.y-f*e.x),c.x+=h*e.x,c.y+=h*e.y,m+=_*(d*e.y-x*e.x),s.m_angularVelocity=l,r.m_angularVelocity=m},l.prototype.SolvePositionConstraints=function(){return!0},Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef),c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,c.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new n,this.localAnchorB=new n},c.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_frictionJoint,this.maxTorque=this.maxForce=0},c.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},Box2D.inherit(m,Box2D.Dynamics.Joints.b2Joint),m.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,m.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new n,this.m_groundAnchor2=new n,this.m_localAnchor1=new n,this.m_localAnchor2=new n,this.m_J=new h},m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},m.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},m.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,o=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,n=e.col1.x*i+e.col2.x*o;return o=e.col1.y*i+e.col2.y*o,i=n,t*(this.m_impulse*this.m_J.angularB-i*this.m_impulse*this.m_J.linearB.y+o*this.m_impulse*this.m_J.linearB.x)},m.prototype.GetRatio=function(){return this.m_ratio},m.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},m.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;var o=0,n=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),e==p.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof B?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),o=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof g?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),o=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),i==p.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof B?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),n=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof g?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),n=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=o+this.m_ratio*n,this.m_impulse=0},m.prototype.InitVelocityConstraints=function(t){var e=this.m_ground1,i=this.m_ground2,o=this.m_bodyA,n=this.m_bodyB,s=0,r=0,a=0,l=0,c=a=0,m=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,m+=o.m_invI):(e=e.m_xf.R,r=this.m_prismatic1.m_localXAxis1,s=e.col1.x*r.x+e.col2.x*r.y,r=e.col1.y*r.x+e.col2.y*r.y,e=o.m_xf.R,a=this.m_localAnchor1.x-o.m_sweep.localCenter.x,l=this.m_localAnchor1.y-o.m_sweep.localCenter.y,c=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=c,a=a*r-l*s,this.m_J.linearA.Set(-s,-r),this.m_J.angularA=-a,m+=o.m_invMass+o.m_invI*a*a),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,m+=this.m_ratio*this.m_ratio*n.m_invI):(e=i.m_xf.R,r=this.m_prismatic2.m_localXAxis1,s=e.col1.x*r.x+e.col2.x*r.y,r=e.col1.y*r.x+e.col2.y*r.y,e=n.m_xf.R,a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y,c=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=c,a=a*r-l*s,this.m_J.linearB.Set(-this.m_ratio*s,-this.m_ratio*r),this.m_J.angularB=-this.m_ratio*a,m+=this.m_ratio*this.m_ratio*(n.m_invMass+n.m_invI*a*a)),this.m_mass=m>0?1/m:0,t.warmStarting?(o.m_linearVelocity.x+=o.m_invMass*this.m_impulse*this.m_J.linearA.x,o.m_linearVelocity.y+=o.m_invMass*this.m_impulse*this.m_J.linearA.y,o.m_angularVelocity+=o.m_invI*this.m_impulse*this.m_J.angularA,n.m_linearVelocity.x+=n.m_invMass*this.m_impulse*this.m_J.linearB.x,n.m_linearVelocity.y+=n.m_invMass*this.m_impulse*this.m_J.linearB.y,n.m_angularVelocity+=n.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0
},m.prototype.SolveVelocityConstraints=function(){var t=this.m_bodyA,e=this.m_bodyB,i=-this.m_mass*this.m_J.Compute(t.m_linearVelocity,t.m_angularVelocity,e.m_linearVelocity,e.m_angularVelocity);this.m_impulse+=i,t.m_linearVelocity.x+=t.m_invMass*i*this.m_J.linearA.x,t.m_linearVelocity.y+=t.m_invMass*i*this.m_J.linearA.y,t.m_angularVelocity+=t.m_invI*i*this.m_J.angularA,e.m_linearVelocity.x+=e.m_invMass*i*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*i*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*i*this.m_J.angularB},m.prototype.SolvePositionConstraints=function(){var e=this.m_bodyA,i=this.m_bodyB,o=0,n=0;return o=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),n=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation(),o=-this.m_mass*(this.m_constant-(o+this.m_ratio*n)),e.m_sweep.c.x+=e.m_invMass*o*this.m_J.linearA.x,e.m_sweep.c.y+=e.m_invMass*o*this.m_J.linearA.y,e.m_sweep.a+=e.m_invI*o*this.m_J.angularA,i.m_sweep.c.x+=i.m_invMass*o*this.m_J.linearB.x,i.m_sweep.c.y+=i.m_invMass*o*this.m_J.linearB.y,i.m_sweep.a+=i.m_invI*o*this.m_J.angularB,e.SynchronizeTransform(),i.SynchronizeTransform(),t.b2_linearSlop>0},Box2D.inherit(u,Box2D.Dynamics.Joints.b2JointDef),u.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,u.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},u.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_gearJoint,this.joint2=this.joint1=null,this.ratio=1},h.b2Jacobian=function(){this.linearA=new n,this.linearB=new n},h.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},h.prototype.Set=function(t,e,i,o){void 0===e&&(e=0),void 0===o&&(o=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=o},h.prototype.Compute=function(t,e,i,o){return void 0===e&&(e=0),void 0===o&&(o=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*o},p.b2Joint=function(){this.m_edgeA=new y,this.m_edgeB=new y,this.m_localCenterA=new n,this.m_localCenterB=new n},p.prototype.GetType=function(){return this.m_type},p.prototype.GetAnchorA=function(){return null},p.prototype.GetAnchorB=function(){return null},p.prototype.GetReactionForce=function(){return null},p.prototype.GetReactionTorque=function(){return 0},p.prototype.GetBodyA=function(){return this.m_bodyA},p.prototype.GetBodyB=function(){return this.m_bodyB},p.prototype.GetNext=function(){return this.m_next},p.prototype.GetUserData=function(){return this.m_userData},p.prototype.SetUserData=function(t){this.m_userData=t},p.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},p.Create=function(t){var e=null;switch(t.type){case p.e_distanceJoint:e=new r(t instanceof a?t:null);break;case p.e_mouseJoint:e=new x(t instanceof b?t:null);break;case p.e_prismaticJoint:e=new g(t instanceof v?t:null);break;case p.e_revoluteJoint:e=new B(t instanceof D?t:null);break;case p.e_pulleyJoint:e=new w(t instanceof C?t:null);break;case p.e_gearJoint:e=new m(t instanceof u?t:null);break;case p.e_lineJoint:e=new f(t instanceof d?t:null);break;case p.e_weldJoint:e=new S(t instanceof A?t:null);break;case p.e_frictionJoint:e=new l(t instanceof c?t:null)}return e},p.Destroy=function(){},p.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_next=this.m_prev=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},p.prototype.InitVelocityConstraints=function(){},p.prototype.SolveVelocityConstraints=function(){},p.prototype.FinalizeVelocityConstraints=function(){},p.prototype.SolvePositionConstraints=function(){return!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),_.b2JointDef=function(){},_.prototype.b2JointDef=function(){this.type=p.e_unknownJoint,this.bodyB=this.bodyA=this.userData=null,this.collideConnected=!1},y.b2JointEdge=function(){},Box2D.inherit(f,Box2D.Dynamics.Joints.b2Joint),f.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,f.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new n,this.m_localAnchor2=new n,this.m_localXAxis1=new n,this.m_localYAxis1=new n,this.m_axis=new n,this.m_perp=new n,this.m_K=new e,this.m_impulse=new n},f.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},f.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},f.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},f.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},f.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),o=e.GetWorldPoint(this.m_localAnchor2);return e=o.x-i.x,i=o.y-i.y,t=t.GetWorldVector(this.m_localXAxis1),t.x*e+t.y*i},f.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var o=this.m_localAnchor1.x-e.m_sweep.localCenter.x,n=this.m_localAnchor1.y-e.m_sweep.localCenter.y,s=t.col1.x*o+t.col2.x*n;n=t.col1.y*o+t.col2.y*n,o=s,t=i.m_xf.R;var r=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;s=t.col1.x*r+t.col2.x*a,a=t.col1.y*r+t.col2.y*a,r=s,t=i.m_sweep.c.x+r-(e.m_sweep.c.x+o),s=i.m_sweep.c.y+a-(e.m_sweep.c.y+n);var l=e.GetWorldVector(this.m_localXAxis1),c=e.m_linearVelocity,m=i.m_linearVelocity;return e=e.m_angularVelocity,i=i.m_angularVelocity,t*-e*l.y+s*e*l.x+(l.x*(m.x+-i*a-c.x- -e*n)+l.y*(m.y+i*r-c.y-e*o))},f.prototype.IsLimitEnabled=function(){return this.m_enableLimit},f.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},f.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},f.prototype.GetUpperLimit=function(){return this.m_upperTranslation},f.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},f.prototype.IsMotorEnabled=function(){return this.m_enableMotor},f.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},f.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},f.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},f.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},f.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},f.prototype.GetMotorForce=function(){return this.m_motorImpulse},f.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorImpulse=this.m_motorMass=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=p.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},f.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,s=this.m_bodyB,r=0;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(s.GetLocalCenter());var a=n.GetTransform();s.GetTransform(),i=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;r=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=r,i=s.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,u=this.m_localAnchor2.y-this.m_localCenterB.y;r=i.col1.x*m+i.col2.x*u,u=i.col1.y*m+i.col2.y*u,m=r,i=s.m_sweep.c.x+m-n.m_sweep.c.x-l,r=s.m_sweep.c.y+u-n.m_sweep.c.y-c,this.m_invMassA=n.m_invMass,this.m_invMassB=s.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=s.m_invI,this.m_axis.SetV(o.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(i+l)*this.m_axis.y-(r+c)*this.m_axis.x,this.m_a2=m*this.m_axis.y-u*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(o.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(i+l)*this.m_perp.y-(r+c)*this.m_perp.x,this.m_s2=m*this.m_perp.y-u*this.m_perp.x,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,m=this.m_invIB,this.m_K.col1.x=a+l+c*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,this.m_K.col1.y=c*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=a+l+c*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2,this.m_enableLimit?(i=this.m_axis.x*i+this.m_axis.y*r,o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=p.e_equalLimits:this.m_lowerTranslation>=i?this.m_limitState!=p.e_atLowerLimit&&(this.m_limitState=p.e_atLowerLimit,this.m_impulse.y=0):i>=this.m_upperTranslation?this.m_limitState!=p.e_atUpperLimit&&(this.m_limitState=p.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=p.e_inactiveLimit,this.m_impulse.y=0)):this.m_limitState=p.e_inactiveLimit,0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting?(this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio,e=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,i=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,r=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,a=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,n.m_linearVelocity.x-=this.m_invMassA*e,n.m_linearVelocity.y-=this.m_invMassA*i,n.m_angularVelocity-=this.m_invIA*r,s.m_linearVelocity.x+=this.m_invMassB*e,s.m_linearVelocity.y+=this.m_invMassB*i,s.m_angularVelocity+=this.m_invIB*a):(this.m_impulse.SetZero(),this.m_motorImpulse=0)},f.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,s=e.m_linearVelocity,r=e.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,c=0,m=0,u=0,h=0;this.m_enableMotor&&this.m_limitState!=p.e_equalLimits&&(h=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(a.x-s.x)+this.m_axis.y*(a.y-s.y)+this.m_a2*l-this.m_a1*r)),c=this.m_motorImpulse,m=t.dt*this.m_maxMotorForce,this.m_motorImpulse=o.Clamp(this.m_motorImpulse+h,-m,m),h=this.m_motorImpulse-c,c=h*this.m_axis.x,m=h*this.m_axis.y,u=h*this.m_a1,h*=this.m_a2,s.x-=this.m_invMassA*c,s.y-=this.m_invMassA*m,r-=this.m_invIA*u,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*m,l+=this.m_invIB*h),m=this.m_perp.x*(a.x-s.x)+this.m_perp.y*(a.y-s.y)+this.m_s2*l-this.m_s1*r,this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit?(u=this.m_axis.x*(a.x-s.x)+this.m_axis.y*(a.y-s.y)+this.m_a2*l-this.m_a1*r,c=this.m_impulse.Copy(),t=this.m_K.Solve(new n,-m,-u),this.m_impulse.Add(t),this.m_limitState==p.e_atLowerLimit?this.m_impulse.y=o.Max(this.m_impulse.y,0):this.m_limitState==p.e_atUpperLimit&&(this.m_impulse.y=o.Min(this.m_impulse.y,0)),m=-m-(this.m_impulse.y-c.y)*this.m_K.col2.x,u=0,u=0!=this.m_K.col1.x?m/this.m_K.col1.x+c.x:c.x,this.m_impulse.x=u,t.x=this.m_impulse.x-c.x,t.y=this.m_impulse.y-c.y,c=t.x*this.m_perp.x+t.y*this.m_axis.x,m=t.x*this.m_perp.y+t.y*this.m_axis.y,u=t.x*this.m_s1+t.y*this.m_a1,h=t.x*this.m_s2+t.y*this.m_a2):(t=0,t=0!=this.m_K.col1.x?-m/this.m_K.col1.x:0,this.m_impulse.x+=t,c=t*this.m_perp.x,m=t*this.m_perp.y,u=t*this.m_s1,h=t*this.m_s2),s.x-=this.m_invMassA*c,s.y-=this.m_invMassA*m,r-=this.m_invIA*u,a.x+=this.m_invMassB*c,a.y+=this.m_invMassB*m,l+=this.m_invIB*h,e.m_linearVelocity.SetV(s),e.m_angularVelocity=r,i.m_linearVelocity.SetV(a),i.m_angularVelocity=l},f.prototype.SolvePositionConstraints=function(){var i,s=this.m_bodyA,r=this.m_bodyB,a=s.m_sweep.c,l=s.m_sweep.a,c=r.m_sweep.c,m=r.m_sweep.a,u=0,h=0,p=0,_=0,y=i=0,f=0;h=!1;var d=0,x=e.FromAngle(l);p=e.FromAngle(m),i=x,f=this.m_localAnchor1.x-this.m_localCenterA.x;var b=this.m_localAnchor1.y-this.m_localCenterA.y;if(u=i.col1.x*f+i.col2.x*b,b=i.col1.y*f+i.col2.y*b,f=u,i=p,p=this.m_localAnchor2.x-this.m_localCenterB.x,_=this.m_localAnchor2.y-this.m_localCenterB.y,u=i.col1.x*p+i.col2.x*_,_=i.col1.y*p+i.col2.y*_,p=u,i=c.x+p-a.x-f,u=c.y+_-a.y-b,this.m_enableLimit){this.m_axis=o.MulMV(x,this.m_localXAxis1),this.m_a1=(i+f)*this.m_axis.y-(u+b)*this.m_axis.x,this.m_a2=p*this.m_axis.y-_*this.m_axis.x;var g=this.m_axis.x*i+this.m_axis.y*u;o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(d=o.Clamp(g,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),y=o.Abs(g),h=!0):this.m_lowerTranslation>=g?(d=o.Clamp(g-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=this.m_lowerTranslation-g,h=!0):g>=this.m_upperTranslation&&(d=o.Clamp(g-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),y=g-this.m_upperTranslation,h=!0)}return this.m_perp=o.MulMV(x,this.m_localYAxis1),this.m_s1=(i+f)*this.m_perp.y-(u+b)*this.m_perp.x,this.m_s2=p*this.m_perp.y-_*this.m_perp.x,x=new n,b=this.m_perp.x*i+this.m_perp.y*u,y=o.Max(y,o.Abs(b)),f=0,h?(h=this.m_invMassA,p=this.m_invMassB,_=this.m_invIA,i=this.m_invIB,this.m_K.col1.x=h+p+_*this.m_s1*this.m_s1+i*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1*this.m_a1+i*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=h+p+_*this.m_a1*this.m_a1+i*this.m_a2*this.m_a2,this.m_K.Solve(x,-b,-d)):(h=this.m_invMassA,p=this.m_invMassB,_=this.m_invIA,i=this.m_invIB,d=h+p+_*this.m_s1*this.m_s1+i*this.m_s2*this.m_s2,h=0,h=0!=d?-b/d:0,x.x=h,x.y=0),d=x.x*this.m_perp.x+x.y*this.m_axis.x,h=x.x*this.m_perp.y+x.y*this.m_axis.y,b=x.x*this.m_s1+x.y*this.m_a1,x=x.x*this.m_s2+x.y*this.m_a2,a.x-=this.m_invMassA*d,a.y-=this.m_invMassA*h,l-=this.m_invIA*b,c.x+=this.m_invMassB*d,c.y+=this.m_invMassB*h,m+=this.m_invIB*x,s.m_sweep.a=l,r.m_sweep.a=m,s.SynchronizeTransform(),r.SynchronizeTransform(),t.b2_linearSlop>=y&&t.b2_angularSlop>=f},Box2D.inherit(d,Box2D.Dynamics.Joints.b2JointDef),d.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,d.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new n,this.localAnchorB=new n,this.localAxisA=new n},d.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.upperTranslation=this.lowerTranslation=0,this.enableMotor=!1,this.motorSpeed=this.maxMotorForce=0},d.prototype.Initialize=function(t,e,i,o){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(o)},Box2D.inherit(x,Box2D.Dynamics.Joints.b2Joint),x.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,x.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.m_localAnchor=new n,this.m_target=new n,this.m_impulse=new n,this.m_mass=new e,this.m_C=new n},x.prototype.GetAnchorA=function(){return this.m_target},x.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},x.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_impulse.x,t*this.m_impulse.y)},x.prototype.GetReactionTorque=function(){return 0},x.prototype.GetTarget=function(){return this.m_target},x.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},x.prototype.GetMaxForce=function(){return this.m_maxForce},x.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},x.prototype.GetFrequency=function(){return this.m_frequencyHz},x.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},x.prototype.GetDampingRatio=function(){return this.m_dampingRatio},x.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},x.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,o=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*o.col1.x+i*o.col1.y,this.m_localAnchor.y=e*o.col2.x+i*o.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_gamma=this.m_beta=0},x.prototype.InitVelocityConstraints=function(t){var e=this.m_bodyB,i=e.GetMass(),o=2*Math.PI*this.m_frequencyHz,n=i*o*o;this.m_gamma=t.dt*(2*i*this.m_dampingRatio*o+t.dt*n),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*n*this.m_gamma,n=e.m_xf.R,i=this.m_localAnchor.x-e.m_sweep.localCenter.x,o=this.m_localAnchor.y-e.m_sweep.localCenter.y;var s=n.col1.x*i+n.col2.x*o;o=n.col1.y*i+n.col2.y*o,i=s,n=e.m_invMass,s=e.m_invI,this.K1.col1.x=n,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=n,this.K2.col1.x=s*o*o,this.K2.col2.x=-s*i*o,this.K2.col1.y=-s*i*o,this.K2.col2.y=s*i*i,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+i-this.m_target.x,this.m_C.y=e.m_sweep.c.y+o-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=n*this.m_impulse.x,e.m_linearVelocity.y+=n*this.m_impulse.y,e.m_angularVelocity+=s*(i*this.m_impulse.y-o*this.m_impulse.x)},x.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyB,o=0,n=0;e=i.m_xf.R;var s=this.m_localAnchor.x-i.m_sweep.localCenter.x,r=this.m_localAnchor.y-i.m_sweep.localCenter.y;o=e.col1.x*s+e.col2.x*r,r=e.col1.y*s+e.col2.y*r,s=o,o=i.m_linearVelocity.x+-i.m_angularVelocity*r;var a=i.m_linearVelocity.y+i.m_angularVelocity*s;e=this.m_mass,o=o+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,n=a+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y,a=-(e.col1.x*o+e.col2.x*n),n=-(e.col1.y*o+e.col2.y*n),e=this.m_impulse.x,o=this.m_impulse.y,this.m_impulse.x+=a,this.m_impulse.y+=n,t=t.dt*this.m_maxForce,this.m_impulse.LengthSquared()>t*t&&this.m_impulse.Multiply(t/this.m_impulse.Length()),a=this.m_impulse.x-e,n=this.m_impulse.y-o,i.m_linearVelocity.x+=i.m_invMass*a,i.m_linearVelocity.y+=i.m_invMass*n,i.m_angularVelocity+=i.m_invI*(s*n-r*a)},x.prototype.SolvePositionConstraints=function(){return!0},Box2D.inherit(b,Box2D.Dynamics.Joints.b2JointDef),b.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,b.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new n},b.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},Box2D.inherit(g,Box2D.Dynamics.Joints.b2Joint),g.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,g.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new n,this.m_localAnchor2=new n,this.m_localXAxis1=new n,this.m_localYAxis1=new n,this.m_axis=new n,this.m_perp=new n,this.m_K=new i,this.m_impulse=new s},g.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},g.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},g.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},g.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},g.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),o=e.GetWorldPoint(this.m_localAnchor2);return e=o.x-i.x,i=o.y-i.y,t=t.GetWorldVector(this.m_localXAxis1),t.x*e+t.y*i},g.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var o=this.m_localAnchor1.x-e.m_sweep.localCenter.x,n=this.m_localAnchor1.y-e.m_sweep.localCenter.y,s=t.col1.x*o+t.col2.x*n;n=t.col1.y*o+t.col2.y*n,o=s,t=i.m_xf.R;var r=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;s=t.col1.x*r+t.col2.x*a,a=t.col1.y*r+t.col2.y*a,r=s,t=i.m_sweep.c.x+r-(e.m_sweep.c.x+o),s=i.m_sweep.c.y+a-(e.m_sweep.c.y+n);var l=e.GetWorldVector(this.m_localXAxis1),c=e.m_linearVelocity,m=i.m_linearVelocity;return e=e.m_angularVelocity,i=i.m_angularVelocity,t*-e*l.y+s*e*l.x+(l.x*(m.x+-i*a-c.x- -e*n)+l.y*(m.y+i*r-c.y-e*o))},g.prototype.IsLimitEnabled=function(){return this.m_enableLimit},g.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},g.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},g.prototype.GetUpperLimit=function(){return this.m_upperTranslation},g.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},g.prototype.IsMotorEnabled=function(){return this.m_enableMotor},g.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},g.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},g.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},g.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},g.prototype.GetMotorForce=function(){return this.m_motorImpulse},g.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=this.m_motorMass=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=p.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},g.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,s=this.m_bodyB,r=0;this.m_localCenterA.SetV(n.GetLocalCenter()),this.m_localCenterB.SetV(s.GetLocalCenter());var a=n.GetTransform();s.GetTransform(),i=n.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,c=this.m_localAnchor1.y-this.m_localCenterA.y;r=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=r,i=s.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,u=this.m_localAnchor2.y-this.m_localCenterB.y;r=i.col1.x*m+i.col2.x*u,u=i.col1.y*m+i.col2.y*u,m=r,i=s.m_sweep.c.x+m-n.m_sweep.c.x-l,r=s.m_sweep.c.y+u-n.m_sweep.c.y-c,this.m_invMassA=n.m_invMass,this.m_invMassB=s.m_invMass,this.m_invIA=n.m_invI,this.m_invIB=s.m_invI,this.m_axis.SetV(o.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(i+l)*this.m_axis.y-(r+c)*this.m_axis.x,this.m_a2=m*this.m_axis.y-u*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(o.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(i+l)*this.m_perp.y-(r+c)*this.m_perp.x,this.m_s2=m*this.m_perp.y-u*this.m_perp.x,a=this.m_invMassA,l=this.m_invMassB,c=this.m_invIA,m=this.m_invIB,this.m_K.col1.x=a+l+c*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,this.m_K.col1.y=c*this.m_s1+m*this.m_s2,this.m_K.col1.z=c*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=c+m,this.m_K.col2.z=c*this.m_a1+m*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=a+l+c*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2,this.m_enableLimit?(i=this.m_axis.x*i+this.m_axis.y*r,o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=p.e_equalLimits:this.m_lowerTranslation>=i?this.m_limitState!=p.e_atLowerLimit&&(this.m_limitState=p.e_atLowerLimit,this.m_impulse.z=0):i>=this.m_upperTranslation?this.m_limitState!=p.e_atUpperLimit&&(this.m_limitState=p.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=p.e_inactiveLimit,this.m_impulse.z=0)):this.m_limitState=p.e_inactiveLimit,0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting?(this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio,e=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,i=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,r=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,a=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,n.m_linearVelocity.x-=this.m_invMassA*e,n.m_linearVelocity.y-=this.m_invMassA*i,n.m_angularVelocity-=this.m_invIA*r,s.m_linearVelocity.x+=this.m_invMassB*e,s.m_linearVelocity.y+=this.m_invMassB*i,s.m_angularVelocity+=this.m_invIB*a):(this.m_impulse.SetZero(),this.m_motorImpulse=0)},g.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,r=e.m_linearVelocity,a=e.m_angularVelocity,l=i.m_linearVelocity,c=i.m_angularVelocity,m=0,u=0,h=0,_=0;this.m_enableMotor&&this.m_limitState!=p.e_equalLimits&&(_=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(l.x-r.x)+this.m_axis.y*(l.y-r.y)+this.m_a2*c-this.m_a1*a)),m=this.m_motorImpulse,t=t.dt*this.m_maxMotorForce,this.m_motorImpulse=o.Clamp(this.m_motorImpulse+_,-t,t),_=this.m_motorImpulse-m,m=_*this.m_axis.x,u=_*this.m_axis.y,h=_*this.m_a1,_*=this.m_a2,r.x-=this.m_invMassA*m,r.y-=this.m_invMassA*u,a-=this.m_invIA*h,l.x+=this.m_invMassB*m,l.y+=this.m_invMassB*u,c+=this.m_invIB*_),h=this.m_perp.x*(l.x-r.x)+this.m_perp.y*(l.y-r.y)+this.m_s2*c-this.m_s1*a,u=c-a,this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit?(t=this.m_axis.x*(l.x-r.x)+this.m_axis.y*(l.y-r.y)+this.m_a2*c-this.m_a1*a,m=this.m_impulse.Copy(),t=this.m_K.Solve33(new s,-h,-u,-t),this.m_impulse.Add(t),this.m_limitState==p.e_atLowerLimit?this.m_impulse.z=o.Max(this.m_impulse.z,0):this.m_limitState==p.e_atUpperLimit&&(this.m_impulse.z=o.Min(this.m_impulse.z,0)),h=-h-(this.m_impulse.z-m.z)*this.m_K.col3.x,u=-u-(this.m_impulse.z-m.z)*this.m_K.col3.y,u=this.m_K.Solve22(new n,h,u),u.x+=m.x,u.y+=m.y,this.m_impulse.x=u.x,this.m_impulse.y=u.y,t.x=this.m_impulse.x-m.x,t.y=this.m_impulse.y-m.y,t.z=this.m_impulse.z-m.z,m=t.x*this.m_perp.x+t.z*this.m_axis.x,u=t.x*this.m_perp.y+t.z*this.m_axis.y,h=t.x*this.m_s1+t.y+t.z*this.m_a1,_=t.x*this.m_s2+t.y+t.z*this.m_a2):(t=this.m_K.Solve22(new n,-h,-u),this.m_impulse.x+=t.x,this.m_impulse.y+=t.y,m=t.x*this.m_perp.x,u=t.x*this.m_perp.y,h=t.x*this.m_s1+t.y,_=t.x*this.m_s2+t.y),r.x-=this.m_invMassA*m,r.y-=this.m_invMassA*u,a-=this.m_invIA*h,l.x+=this.m_invMassB*m,l.y+=this.m_invMassB*u,c+=this.m_invIB*_,e.m_linearVelocity.SetV(r),e.m_angularVelocity=a,i.m_linearVelocity.SetV(l),i.m_angularVelocity=c},g.prototype.SolvePositionConstraints=function(){var i,r=this.m_bodyA,a=this.m_bodyB,l=r.m_sweep.c,c=r.m_sweep.a,m=a.m_sweep.c,u=a.m_sweep.a,h=0,p=0,_=0,y=h=i=0,f=0;p=!1;var d=0,x=e.FromAngle(c),b=e.FromAngle(u);i=x,f=this.m_localAnchor1.x-this.m_localCenterA.x;var g=this.m_localAnchor1.y-this.m_localCenterA.y;if(h=i.col1.x*f+i.col2.x*g,g=i.col1.y*f+i.col2.y*g,f=h,i=b,b=this.m_localAnchor2.x-this.m_localCenterB.x,_=this.m_localAnchor2.y-this.m_localCenterB.y,h=i.col1.x*b+i.col2.x*_,_=i.col1.y*b+i.col2.y*_,b=h,i=m.x+b-l.x-f,h=m.y+_-l.y-g,this.m_enableLimit){this.m_axis=o.MulMV(x,this.m_localXAxis1),this.m_a1=(i+f)*this.m_axis.y-(h+g)*this.m_axis.x,this.m_a2=b*this.m_axis.y-_*this.m_axis.x;var v=this.m_axis.x*i+this.m_axis.y*h;o.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(d=o.Clamp(v,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),y=o.Abs(v),p=!0):this.m_lowerTranslation>=v?(d=o.Clamp(v-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=this.m_lowerTranslation-v,p=!0):v>=this.m_upperTranslation&&(d=o.Clamp(v-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),y=v-this.m_upperTranslation,p=!0)}return this.m_perp=o.MulMV(x,this.m_localYAxis1),this.m_s1=(i+f)*this.m_perp.y-(h+g)*this.m_perp.x,this.m_s2=b*this.m_perp.y-_*this.m_perp.x,x=new s,g=this.m_perp.x*i+this.m_perp.y*h,b=u-c-this.m_refAngle,y=o.Max(y,o.Abs(g)),f=o.Abs(b),p?(p=this.m_invMassA,_=this.m_invMassB,i=this.m_invIA,h=this.m_invIB,this.m_K.col1.x=p+_+i*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2,this.m_K.col1.y=i*this.m_s1+h*this.m_s2,this.m_K.col1.z=i*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=i+h,this.m_K.col2.z=i*this.m_a1+h*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=p+_+i*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2,this.m_K.Solve33(x,-g,-b,-d)):(p=this.m_invMassA,_=this.m_invMassB,i=this.m_invIA,h=this.m_invIB,d=i*this.m_s1+h*this.m_s2,v=i+h,this.m_K.col1.Set(p+_+i*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2,d,0),this.m_K.col2.Set(d,v,0),d=this.m_K.Solve22(new n,-g,-b),x.x=d.x,x.y=d.y,x.z=0),d=x.x*this.m_perp.x+x.z*this.m_axis.x,p=x.x*this.m_perp.y+x.z*this.m_axis.y,g=x.x*this.m_s1+x.y+x.z*this.m_a1,x=x.x*this.m_s2+x.y+x.z*this.m_a2,l.x-=this.m_invMassA*d,l.y-=this.m_invMassA*p,c-=this.m_invIA*g,m.x+=this.m_invMassB*d,m.y+=this.m_invMassB*p,u+=this.m_invIB*x,r.m_sweep.a=c,a.m_sweep.a=u,r.SynchronizeTransform(),a.SynchronizeTransform(),t.b2_linearSlop>=y&&t.b2_angularSlop>=f},Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef),v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,v.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new n,this.localAnchorB=new n,this.localAxisA=new n},v.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.upperTranslation=this.lowerTranslation=0,this.enableMotor=!1,this.motorSpeed=this.maxMotorForce=0},v.prototype.Initialize=function(t,e,i,o){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(o),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(w,Box2D.Dynamics.Joints.b2Joint),w.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,w.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new n,this.m_groundAnchor2=new n,this.m_localAnchor1=new n,this.m_localAnchor2=new n,this.m_u1=new n,this.m_u2=new n},w.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},w.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},w.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},w.prototype.GetReactionTorque=function(){return 0},w.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},w.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},w.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=t.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x);return t=t.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y),Math.sqrt(e*e+t*t)},w.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=t.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x);
return t=t.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y),Math.sqrt(e*e+t*t)},w.prototype.GetRatio=function(){return this.m_ratio},w.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t),this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=o.Min(t.maxLengthA,this.m_constant-this.m_ratio*w.b2_minPulleyLength),this.m_maxLength2=o.Min(t.maxLengthB,(this.m_constant-w.b2_minPulleyLength)/this.m_ratio),this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0},w.prototype.InitVelocityConstraints=function(e){var i,o=this.m_bodyA,n=this.m_bodyB;i=o.m_xf.R;var s=this.m_localAnchor1.x-o.m_sweep.localCenter.x,r=this.m_localAnchor1.y-o.m_sweep.localCenter.y,a=i.col1.x*s+i.col2.x*r;r=i.col1.y*s+i.col2.y*r,s=a,i=n.m_xf.R;var l=this.m_localAnchor2.x-n.m_sweep.localCenter.x,c=this.m_localAnchor2.y-n.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*c,c=i.col1.y*l+i.col2.y*c,l=a,i=n.m_sweep.c.x+l,a=n.m_sweep.c.y+c;var m=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,u=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(o.m_sweep.c.x+s-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),o.m_sweep.c.y+r-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y)),this.m_u2.Set(i-m,a-u),i=this.m_u1.Length(),a=this.m_u2.Length(),i>t.b2_linearSlop?this.m_u1.Multiply(1/i):this.m_u1.SetZero(),a>t.b2_linearSlop?this.m_u2.Multiply(1/a):this.m_u2.SetZero(),this.m_constant-i-this.m_ratio*a>0?(this.m_state=p.e_inactiveLimit,this.m_impulse=0):this.m_state=p.e_atUpperLimit,this.m_maxLength1>i?(this.m_limitState1=p.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=p.e_atUpperLimit,this.m_maxLength2>a?(this.m_limitState2=p.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=p.e_atUpperLimit,i=s*this.m_u1.y-r*this.m_u1.x,a=l*this.m_u2.y-c*this.m_u2.x,this.m_limitMass1=o.m_invMass+o.m_invI*i*i,this.m_limitMass2=n.m_invMass+n.m_invI*a*a,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,e.warmStarting?(this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio,e=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,i=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,a=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,m=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,o.m_linearVelocity.x+=o.m_invMass*e,o.m_linearVelocity.y+=o.m_invMass*i,o.m_angularVelocity+=o.m_invI*(s*i-r*e),n.m_linearVelocity.x+=n.m_invMass*a,n.m_linearVelocity.y+=n.m_invMass*m,n.m_angularVelocity+=n.m_invI*(l*m-c*a)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0},w.prototype.SolveVelocityConstraints=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,s=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*s;s=t.col1.y*n+t.col2.y*s,n=r,t=i.m_xf.R;var a=this.m_localAnchor2.x-i.m_sweep.localCenter.x,l=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*a+t.col2.x*l,l=t.col1.y*a+t.col2.y*l,a=r;var c=r=t=0,m=0;t=m=t=m=c=r=t=0,this.m_state==p.e_atUpperLimit&&(t=e.m_linearVelocity.x+-e.m_angularVelocity*s,r=e.m_linearVelocity.y+e.m_angularVelocity*n,c=i.m_linearVelocity.x+-i.m_angularVelocity*l,m=i.m_linearVelocity.y+i.m_angularVelocity*a,t=-(this.m_u1.x*t+this.m_u1.y*r)-this.m_ratio*(this.m_u2.x*c+this.m_u2.y*m),m=this.m_pulleyMass*-t,t=this.m_impulse,this.m_impulse=o.Max(0,this.m_impulse+m),m=this.m_impulse-t,t=-m*this.m_u1.x,r=-m*this.m_u1.y,c=-this.m_ratio*m*this.m_u2.x,m=-this.m_ratio*m*this.m_u2.y,e.m_linearVelocity.x+=e.m_invMass*t,e.m_linearVelocity.y+=e.m_invMass*r,e.m_angularVelocity+=e.m_invI*(n*r-s*t),i.m_linearVelocity.x+=i.m_invMass*c,i.m_linearVelocity.y+=i.m_invMass*m,i.m_angularVelocity+=i.m_invI*(a*m-l*c)),this.m_limitState1==p.e_atUpperLimit&&(t=e.m_linearVelocity.x+-e.m_angularVelocity*s,r=e.m_linearVelocity.y+e.m_angularVelocity*n,t=-(this.m_u1.x*t+this.m_u1.y*r),m=-this.m_limitMass1*t,t=this.m_limitImpulse1,this.m_limitImpulse1=o.Max(0,this.m_limitImpulse1+m),m=this.m_limitImpulse1-t,t=-m*this.m_u1.x,r=-m*this.m_u1.y,e.m_linearVelocity.x+=e.m_invMass*t,e.m_linearVelocity.y+=e.m_invMass*r,e.m_angularVelocity+=e.m_invI*(n*r-s*t)),this.m_limitState2==p.e_atUpperLimit&&(c=i.m_linearVelocity.x+-i.m_angularVelocity*l,m=i.m_linearVelocity.y+i.m_angularVelocity*a,t=-(this.m_u2.x*c+this.m_u2.y*m),m=-this.m_limitMass2*t,t=this.m_limitImpulse2,this.m_limitImpulse2=o.Max(0,this.m_limitImpulse2+m),m=this.m_limitImpulse2-t,c=-m*this.m_u2.x,m=-m*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*c,i.m_linearVelocity.y+=i.m_invMass*m,i.m_angularVelocity+=i.m_invI*(a*m-l*c))},w.prototype.SolvePositionConstraints=function(){var e,i=this.m_bodyA,n=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,r=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,a=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,l=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,c=0,m=0,u=0,h=0,_=e=0,y=0,f=0,d=_=f=e=_=e=0;return this.m_state==p.e_atUpperLimit&&(e=i.m_xf.R,c=this.m_localAnchor1.x-i.m_sweep.localCenter.x,m=this.m_localAnchor1.y-i.m_sweep.localCenter.y,_=e.col1.x*c+e.col2.x*m,m=e.col1.y*c+e.col2.y*m,c=_,e=n.m_xf.R,u=this.m_localAnchor2.x-n.m_sweep.localCenter.x,h=this.m_localAnchor2.y-n.m_sweep.localCenter.y,_=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=_,e=i.m_sweep.c.x+c,_=i.m_sweep.c.y+m,y=n.m_sweep.c.x+u,f=n.m_sweep.c.y+h,this.m_u1.Set(e-s,_-r),this.m_u2.Set(y-a,f-l),e=this.m_u1.Length(),_=this.m_u2.Length(),e>t.b2_linearSlop?this.m_u1.Multiply(1/e):this.m_u1.SetZero(),_>t.b2_linearSlop?this.m_u2.Multiply(1/_):this.m_u2.SetZero(),e=this.m_constant-e-this.m_ratio*_,d=o.Max(d,-e),e=o.Clamp(e+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),f=-this.m_pulleyMass*e,e=-f*this.m_u1.x,_=-f*this.m_u1.y,y=-this.m_ratio*f*this.m_u2.x,f=-this.m_ratio*f*this.m_u2.y,i.m_sweep.c.x+=i.m_invMass*e,i.m_sweep.c.y+=i.m_invMass*_,i.m_sweep.a+=i.m_invI*(c*_-m*e),n.m_sweep.c.x+=n.m_invMass*y,n.m_sweep.c.y+=n.m_invMass*f,n.m_sweep.a+=n.m_invI*(u*f-h*y),i.SynchronizeTransform(),n.SynchronizeTransform()),this.m_limitState1==p.e_atUpperLimit&&(e=i.m_xf.R,c=this.m_localAnchor1.x-i.m_sweep.localCenter.x,m=this.m_localAnchor1.y-i.m_sweep.localCenter.y,_=e.col1.x*c+e.col2.x*m,m=e.col1.y*c+e.col2.y*m,c=_,e=i.m_sweep.c.x+c,_=i.m_sweep.c.y+m,this.m_u1.Set(e-s,_-r),e=this.m_u1.Length(),e>t.b2_linearSlop?(this.m_u1.x*=1/e,this.m_u1.y*=1/e):this.m_u1.SetZero(),e=this.m_maxLength1-e,d=o.Max(d,-e),e=o.Clamp(e+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),f=-this.m_limitMass1*e,e=-f*this.m_u1.x,_=-f*this.m_u1.y,i.m_sweep.c.x+=i.m_invMass*e,i.m_sweep.c.y+=i.m_invMass*_,i.m_sweep.a+=i.m_invI*(c*_-m*e),i.SynchronizeTransform()),this.m_limitState2==p.e_atUpperLimit&&(e=n.m_xf.R,u=this.m_localAnchor2.x-n.m_sweep.localCenter.x,h=this.m_localAnchor2.y-n.m_sweep.localCenter.y,_=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=_,y=n.m_sweep.c.x+u,f=n.m_sweep.c.y+h,this.m_u2.Set(y-a,f-l),_=this.m_u2.Length(),_>t.b2_linearSlop?(this.m_u2.x*=1/_,this.m_u2.y*=1/_):this.m_u2.SetZero(),e=this.m_maxLength2-_,d=o.Max(d,-e),e=o.Clamp(e+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),f=-this.m_limitMass2*e,y=-f*this.m_u2.x,f=-f*this.m_u2.y,n.m_sweep.c.x+=n.m_invMass*y,n.m_sweep.c.y+=n.m_invMass*f,n.m_sweep.a+=n.m_invI*(u*f-h*y),n.SynchronizeTransform()),t.b2_linearSlop>d},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(C,Box2D.Dynamics.Joints.b2JointDef),C.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,C.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new n,this.groundAnchorB=new n,this.localAnchorA=new n,this.localAnchorB=new n},C.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0,this.ratio=1,this.collideConnected=!0},C.prototype.Initialize=function(t,e,i,o,n,s,r){void 0===r&&(r=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(o),this.localAnchorA=this.bodyA.GetLocalPoint(n),this.localAnchorB=this.bodyB.GetLocalPoint(s),t=n.x-i.x,i=n.y-i.y,this.lengthA=Math.sqrt(t*t+i*i),i=s.x-o.x,o=s.y-o.y,this.lengthB=Math.sqrt(i*i+o*o),this.ratio=r,r=this.lengthA+this.ratio*this.lengthB,this.maxLengthA=r-this.ratio*w.b2_minPulleyLength,this.maxLengthB=(r-w.b2_minPulleyLength)/this.ratio},Box2D.inherit(B,Box2D.Dynamics.Joints.b2Joint),B.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,B.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.K3=new e,this.impulse3=new s,this.impulse2=new n,this.reduced=new n,this.m_localAnchor1=new n,this.m_localAnchor2=new n,this.m_impulse=new s,this.m_mass=new i},B.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},B.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},B.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_impulse.x,t*this.m_impulse.y)},B.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},B.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},B.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},B.prototype.IsLimitEnabled=function(){return this.m_enableLimit},B.prototype.EnableLimit=function(t){this.m_enableLimit=t},B.prototype.GetLowerLimit=function(){return this.m_lowerAngle},B.prototype.GetUpperLimit=function(){return this.m_upperAngle},B.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},B.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},B.prototype.EnableMotor=function(t){this.m_enableMotor=t},B.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},B.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},B.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},B.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},B.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=p.e_inactiveLimit},B.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,s=this.m_bodyB,r=0;i=n.m_xf.R;var a=this.m_localAnchor1.x-n.m_sweep.localCenter.x,l=this.m_localAnchor1.y-n.m_sweep.localCenter.y;r=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=r,i=s.m_xf.R;var c=this.m_localAnchor2.x-s.m_sweep.localCenter.x,m=this.m_localAnchor2.y-s.m_sweep.localCenter.y;r=i.col1.x*c+i.col2.x*m,m=i.col1.y*c+i.col2.y*m,c=r,i=n.m_invMass,r=s.m_invMass;var u=n.m_invI,h=s.m_invI;if(this.m_mass.col1.x=i+r+l*l*u+m*m*h,this.m_mass.col2.x=-l*a*u-m*c*h,this.m_mass.col3.x=-l*u-m*h,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=i+r+a*a*u+c*c*h,this.m_mass.col3.y=a*u+c*h,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=u+h,this.m_motorMass=1/(u+h),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var _=s.m_sweep.a-n.m_sweep.a-this.m_referenceAngle;o.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=p.e_equalLimits:this.m_lowerAngle>=_?(this.m_limitState!=p.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=p.e_atLowerLimit):_>=this.m_upperAngle?(this.m_limitState!=p.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=p.e_atUpperLimit):(this.m_limitState=p.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=p.e_inactiveLimit;e.warmStarting?(this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio,e=this.m_impulse.x,_=this.m_impulse.y,n.m_linearVelocity.x-=i*e,n.m_linearVelocity.y-=i*_,n.m_angularVelocity-=u*(a*_-l*e+this.m_motorImpulse+this.m_impulse.z),s.m_linearVelocity.x+=r*e,s.m_linearVelocity.y+=r*_,s.m_angularVelocity+=h*(c*_-m*e+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=0)},B.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=0,s=n=0,r=0,a=0,l=0,c=e.m_linearVelocity,m=e.m_angularVelocity,u=i.m_linearVelocity,h=i.m_angularVelocity,_=e.m_invMass,y=i.m_invMass,f=e.m_invI,d=i.m_invI;if(this.m_enableMotor&&this.m_limitState!=p.e_equalLimits&&(s=this.m_motorMass*-(h-m-this.m_motorSpeed),r=this.m_motorImpulse,a=t.dt*this.m_maxMotorTorque,this.m_motorImpulse=o.Clamp(this.m_motorImpulse+s,-a,a),s=this.m_motorImpulse-r,m-=f*s,h+=d*s),this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit){t=e.m_xf.R,s=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,n=t.col1.x*s+t.col2.x*r,r=t.col1.y*s+t.col2.y*r,s=n,t=i.m_xf.R,a=this.m_localAnchor2.x-i.m_sweep.localCenter.x,l=this.m_localAnchor2.y-i.m_sweep.localCenter.y,n=t.col1.x*a+t.col2.x*l,l=t.col1.y*a+t.col2.y*l,a=n,t=u.x+-h*l-c.x- -m*r;var x=u.y+h*a-c.y-m*s;this.m_mass.Solve33(this.impulse3,-t,-x,-(h-m)),this.m_limitState==p.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==p.e_atLowerLimit?(n=this.m_impulse.z+this.impulse3.z,0>n&&(this.m_mass.Solve22(this.reduced,-t,-x),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==p.e_atUpperLimit&&(n=this.m_impulse.z+this.impulse3.z,n>0&&(this.m_mass.Solve22(this.reduced,-t,-x),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)),c.x-=_*this.impulse3.x,c.y-=_*this.impulse3.y,m-=f*(s*this.impulse3.y-r*this.impulse3.x+this.impulse3.z),u.x+=y*this.impulse3.x,u.y+=y*this.impulse3.y,h+=d*(a*this.impulse3.y-l*this.impulse3.x+this.impulse3.z)}else t=e.m_xf.R,s=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,n=t.col1.x*s+t.col2.x*r,r=t.col1.y*s+t.col2.y*r,s=n,t=i.m_xf.R,a=this.m_localAnchor2.x-i.m_sweep.localCenter.x,l=this.m_localAnchor2.y-i.m_sweep.localCenter.y,n=t.col1.x*a+t.col2.x*l,l=t.col1.y*a+t.col2.y*l,a=n,this.m_mass.Solve22(this.impulse2,-(u.x+-h*l-c.x- -m*r),-(u.y+h*a-c.y-m*s)),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,c.x-=_*this.impulse2.x,c.y-=_*this.impulse2.y,m-=f*(s*this.impulse2.y-r*this.impulse2.x),u.x+=y*this.impulse2.x,u.y+=y*this.impulse2.y,h+=d*(a*this.impulse2.y-l*this.impulse2.x);e.m_linearVelocity.SetV(c),e.m_angularVelocity=m,i.m_linearVelocity.SetV(u),i.m_angularVelocity=h},B.prototype.SolvePositionConstraints=function(){var e,i=0,n=this.m_bodyA,s=this.m_bodyB,r=0,a=e=0,l=0,c=0;if(this.m_enableLimit&&this.m_limitState!=p.e_inactiveLimit){i=s.m_sweep.a-n.m_sweep.a-this.m_referenceAngle;var m=0;this.m_limitState==p.e_equalLimits?(i=o.Clamp(i-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),m=-this.m_motorMass*i,r=o.Abs(i)):this.m_limitState==p.e_atLowerLimit?(i-=this.m_lowerAngle,r=-i,i=o.Clamp(i+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),m=-this.m_motorMass*i):this.m_limitState==p.e_atUpperLimit&&(r=i-=this.m_upperAngle,i=o.Clamp(i-t.b2_angularSlop,0,t.b2_maxAngularCorrection),m=-this.m_motorMass*i),n.m_sweep.a-=n.m_invI*m,s.m_sweep.a+=s.m_invI*m,n.SynchronizeTransform(),s.SynchronizeTransform()}e=n.m_xf.R,m=this.m_localAnchor1.x-n.m_sweep.localCenter.x,i=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=e.col1.x*m+e.col2.x*i,i=e.col1.y*m+e.col2.y*i,m=a,e=s.m_xf.R;var u=this.m_localAnchor2.x-s.m_sweep.localCenter.x,h=this.m_localAnchor2.y-s.m_sweep.localCenter.y;a=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=a,l=s.m_sweep.c.x+u-n.m_sweep.c.x-m,c=s.m_sweep.c.y+h-n.m_sweep.c.y-i;var _=l*l+c*c;e=Math.sqrt(_),a=n.m_invMass;var y=s.m_invMass,f=n.m_invI,d=s.m_invI,x=10*t.b2_linearSlop;return _>x*x&&(_=1/(a+y),l=_*-l,c=_*-c,n.m_sweep.c.x-=.5*a*l,n.m_sweep.c.y-=.5*a*c,s.m_sweep.c.x+=.5*y*l,s.m_sweep.c.y+=.5*y*c,l=s.m_sweep.c.x+u-n.m_sweep.c.x-m,c=s.m_sweep.c.y+h-n.m_sweep.c.y-i),this.K1.col1.x=a+y,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=a+y,this.K2.col1.x=f*i*i,this.K2.col2.x=-f*m*i,this.K2.col1.y=-f*m*i,this.K2.col2.y=f*m*m,this.K3.col1.x=d*h*h,this.K3.col2.x=-d*u*h,this.K3.col1.y=-d*u*h,this.K3.col2.y=d*u*u,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(B.tImpulse,-l,-c),l=B.tImpulse.x,c=B.tImpulse.y,n.m_sweep.c.x-=n.m_invMass*l,n.m_sweep.c.y-=n.m_invMass*c,n.m_sweep.a-=n.m_invI*(m*c-i*l),s.m_sweep.c.x+=s.m_invMass*l,s.m_sweep.c.y+=s.m_invMass*c,s.m_sweep.a+=s.m_invI*(u*c-h*l),n.SynchronizeTransform(),s.SynchronizeTransform(),t.b2_linearSlop>=e&&t.b2_angularSlop>=r},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new n}),Box2D.inherit(D,Box2D.Dynamics.Joints.b2JointDef),D.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,D.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new n,this.localAnchorB=new n},D.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0,this.enableMotor=this.enableLimit=!1},D.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(S,Box2D.Dynamics.Joints.b2Joint),S.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,S.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new n,this.m_localAnchorB=new n,this.m_impulse=new s,this.m_mass=new i},S.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},S.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},S.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new n(t*this.m_impulse.x,t*this.m_impulse.y)},S.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},S.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},S.prototype.InitVelocityConstraints=function(t){var e,i=0,o=this.m_bodyA,n=this.m_bodyB;e=o.m_xf.R;var s=this.m_localAnchorA.x-o.m_sweep.localCenter.x,r=this.m_localAnchorA.y-o.m_sweep.localCenter.y;i=e.col1.x*s+e.col2.x*r,r=e.col1.y*s+e.col2.y*r,s=i,e=n.m_xf.R;var a=this.m_localAnchorB.x-n.m_sweep.localCenter.x,l=this.m_localAnchorB.y-n.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i,e=o.m_invMass,i=n.m_invMass;var c=o.m_invI,m=n.m_invI;this.m_mass.col1.x=e+i+r*r*c+l*l*m,this.m_mass.col2.x=-r*s*c-l*a*m,this.m_mass.col3.x=-r*c-l*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=e+i+s*s*c+a*a*m,this.m_mass.col3.y=s*c+a*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=c+m,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,o.m_linearVelocity.x-=e*this.m_impulse.x,o.m_linearVelocity.y-=e*this.m_impulse.y,o.m_angularVelocity-=c*(s*this.m_impulse.y-r*this.m_impulse.x+this.m_impulse.z),n.m_linearVelocity.x+=i*this.m_impulse.x,n.m_linearVelocity.y+=i*this.m_impulse.y,n.m_angularVelocity+=m*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},S.prototype.SolveVelocityConstraints=function(){var t,e=0,i=this.m_bodyA,o=this.m_bodyB,n=i.m_linearVelocity,r=i.m_angularVelocity,a=o.m_linearVelocity,l=o.m_angularVelocity,c=i.m_invMass,m=o.m_invMass,u=i.m_invI,h=o.m_invI;t=i.m_xf.R;var p=this.m_localAnchorA.x-i.m_sweep.localCenter.x,_=this.m_localAnchorA.y-i.m_sweep.localCenter.y;e=t.col1.x*p+t.col2.x*_,_=t.col1.y*p+t.col2.y*_,p=e,t=o.m_xf.R;var y=this.m_localAnchorB.x-o.m_sweep.localCenter.x,f=this.m_localAnchorB.y-o.m_sweep.localCenter.y;e=t.col1.x*y+t.col2.x*f,f=t.col1.y*y+t.col2.y*f,y=e,t=a.x-l*f-n.x+r*_,e=a.y+l*y-n.y-r*p;var d=l-r,x=new s;this.m_mass.Solve33(x,-t,-e,-d),this.m_impulse.Add(x),n.x-=c*x.x,n.y-=c*x.y,r-=u*(p*x.y-_*x.x+x.z),a.x+=m*x.x,a.y+=m*x.y,l+=h*(y*x.y-f*x.x+x.z),i.m_angularVelocity=r,o.m_angularVelocity=l},S.prototype.SolvePositionConstraints=function(){var e,i=0,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var a=this.m_localAnchorA.x-n.m_sweep.localCenter.x,l=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i,e=r.m_xf.R;var c=this.m_localAnchorB.x-r.m_sweep.localCenter.x,m=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*c+e.col2.x*m,m=e.col1.y*c+e.col2.y*m,c=i,e=n.m_invMass,i=r.m_invMass;var u=n.m_invI,h=r.m_invI,p=r.m_sweep.c.x+c-n.m_sweep.c.x-a,_=r.m_sweep.c.y+m-n.m_sweep.c.y-l,y=r.m_sweep.a-n.m_sweep.a-this.m_referenceAngle,f=10*t.b2_linearSlop,d=Math.sqrt(p*p+_*_),x=o.Abs(y);return d>f&&(u*=1,h*=1),this.m_mass.col1.x=e+i+l*l*u+m*m*h,this.m_mass.col2.x=-l*a*u-m*c*h,this.m_mass.col3.x=-l*u-m*h,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=e+i+a*a*u+c*c*h,this.m_mass.col3.y=a*u+c*h,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=u+h,f=new s,this.m_mass.Solve33(f,-p,-_,-y),n.m_sweep.c.x-=e*f.x,n.m_sweep.c.y-=e*f.y,n.m_sweep.a-=u*(a*f.y-l*f.x+f.z),r.m_sweep.c.x+=i*f.x,r.m_sweep.c.y+=i*f.y,r.m_sweep.a+=h*(c*f.y-m*f.x+f.z),n.SynchronizeTransform(),r.SynchronizeTransform(),t.b2_linearSlop>=d&&t.b2_angularSlop>=x},Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef),A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,A.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new n,this.localAnchorB=new n},A.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=p.e_weldJoint,this.referenceAngle=0},A.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var t=Box2D.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},t.prototype.b2DebugDraw=function(){this.m_drawFlags=0},t.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_ctx=t},t.prototype.GetSprite=function(){return this.m_ctx},t.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){if(e){var o=this.m_ctx,n=this.m_drawScale;for(o.beginPath(),o.strokeStyle=this._color(i.color,this.m_alpha),o.moveTo(t[0].x*n,t[0].y*n),i=1;e>i;i++)o.lineTo(t[i].x*n,t[i].y*n);o.lineTo(t[0].x*n,t[0].y*n),o.closePath(),o.stroke()}},t.prototype.DrawSolidPolygon=function(t,e,i){if(e){var o=this.m_ctx,n=this.m_drawScale;for(o.beginPath(),o.strokeStyle=this._color(i.color,this.m_alpha),o.fillStyle=this._color(i.color,this.m_fillAlpha),o.moveTo(t[0].x*n,t[0].y*n),i=1;e>i;i++)o.lineTo(t[i].x*n,t[i].y*n);o.lineTo(t[0].x*n,t[0].y*n),o.closePath(),o.fill(),o.stroke()}},t.prototype.DrawCircle=function(t,e,i){if(e){var o=this.m_ctx,n=this.m_drawScale;o.beginPath(),o.strokeStyle=this._color(i.color,this.m_alpha),o.arc(t.x*n,t.y*n,e*n,0,2*Math.PI,!0),o.closePath(),o.stroke()}},t.prototype.DrawSolidCircle=function(t,e,i,o){if(e){var n=this.m_ctx,s=this.m_drawScale,r=t.x*s,a=t.y*s;n.moveTo(0,0),n.beginPath(),n.strokeStyle=this._color(o.color,this.m_alpha),n.fillStyle=this._color(o.color,this.m_fillAlpha),n.arc(r,a,e*s,0,2*Math.PI,!0),n.moveTo(r,a),n.lineTo((t.x+i.x*e)*s,(t.y+i.y*e)*s),n.closePath(),n.fill(),n.stroke()}},t.prototype.DrawSegment=function(t,e,i){var o=this.m_ctx,n=this.m_drawScale;o.strokeStyle=this._color(i.color,this.m_alpha),o.beginPath(),o.moveTo(t.x*n,t.y*n),o.lineTo(e.x*n,e.y*n),o.closePath(),o.stroke()},t.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}();var i;for(i=0;Box2D.postDefs.length>i;++i)Box2D.postDefs[i]();delete Box2D.postDefs,/*
 jCanvas v6.0
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
function(t,e,i,o,n,s,r,a,l){function c(){}function m(t){return t?R(F,t):m.prefs=F=c.prototype=R({},k),this}function u(t,e){t.fillStyle=e.fillStyle,t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.rounded?(t.lineCap="round",t.lineJoin="round"):(t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.miterLimit=e.miterLimit),t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.globalAlpha=e.opacity,t.globalCompositeOperation=e.compositing}function h(t){return t&&t.getContext?t.getContext("2d"):a}function p(t,e){e.closed&&t.closePath(),t.fill(),"transparent"!==e.fillStyle&&(t.shadowColor="transparent"),t.stroke(),e.closed||t.closePath(),e._toRad&&t.restore(),e.mask&&(e.autosave&&t.save(),t.clip())}function _(t,e){e.translateX||e.translateY||!e.x&&!e.y||(e.translateX=e.x,e.translateY=e.y),e.translate&&(e.translateX=e.translateY=e.translate),t.translate(e.translateX,e.translateY)}function y(t,e){1!==e.scale&&(e.scaleX=e.scaleY=e.scale),t.translate(e.x,e.y),t.scale(e.scaleX,e.scaleY),t.translate(-e.x,-e.y)}function f(t,e){e._toRad=e.inDegrees?N/180:1,e.rotate=e.rotate||e.angle,t.translate(e.x,e.y),t.rotate(e.rotate*e._toRad),t.translate(-e.x,-e.y)}function d(t,e,i,o,n){i._toRad=i.inDegrees?N/180:1,e.save(),n=n||o,!t&&!i.fromCenter&&(i.x+=o/2,i.y+=n/2),(i.rotate||i.angle)&&f(e,i),(1!==i.scale||1!==i.scaleX||1!==i.scaleY)&&y(e,i),(i.translate||i.translateX||i.translateY)&&_(e,i)}function x(e){var i;return M===e?i=V:((i=t.data(e,"jCanvas"))||(i=t.data(e,"jCanvas",{layers:[],intersects:[],drag:{},event:{}})),M=e,V=i),i}function b(e,i,o){o&&o.visible&&(o.method===t.fn.draw?o.fn.call(e[0],i):o.method&&o.method.call(e,o))}function g(e,i,o){var n,r,a,u,h="function"==typeof i,i=i||{};if(i.layer&&!i._layer){if(n=t(e),r=n.getLayers(),h&&(i={method:t.fn.draw,fn:i}),i=R(new c,i),!h){i.method=t.fn[i.method]||o,u=x(e);for(a in m.events)m.events.hasOwnProperty(a)&&i[a]&&(m.events[a](n,u),i._event=s);if(i.draggable){for(i._event=s,e=["mousedown","mousemove","mouseup"],o=0;e.length>o;o+=1)a=e[o],m.events[a](n,u);u.mouseout||(n.bind("mouseout.jCanvas",function(){u.drag={},n.drawLayers()}),u.mouseout=s)}}i.layer=s,i._layer=s,i.index===l&&(i.index=r.length),r.splice(i.index,0,i)}}function v(t){var e;for(e=0;z.length>e;e+=1)t[z[e]]=t["_"+z[e]]}function w(t){var e;for(e=0;z.length>e;e+=1)t["_"+z[e]]=t[z[e]],q[z[e]]=1}function C(i){var o,s,r=[],a=1;return i.match(/^#?[a-z0-9]+$/i)&&("transparent"===i&&(i="rgba(0,0,0,0)"),s=e.head,o=s.style.color,s.style.color=i,i=t.css(s,"color"),s.style.color=o),i.match(/^rgb/i)&&(r=i.match(/[0-9]+/gi),i.match(/%/gi)&&(a=2.55),r[0]*=a,r[1]*=a,r[2]*=a,r[3]=r[3]!==l?n(r[3]):1),r}function B(t){var e,i=3;for("object"!=typeof t.start&&(t.start=C(t.start),t.end=C(t.end)),t.now=[],(1!==t.start[3]||1!==t.end[3])&&(i=4),e=0;i>e;e+=1)t.now[e]=t.start[e]+(t.end[e]-t.start[e])*t.pos,3>e&&(t.now[e]=P(t.now[e]));1!==t.start[3]||1!==t.end[3]?t.now="rgba("+t.now.join(",")+")":(t.now.slice(0,3),t.now="rgb("+t.now.join(",")+")"),t.elem.nodeName?t.elem.style[t.prop]=t.now:t.elem[t.prop]=t.now}function D(t){m.events[t]=function(e,i){var o="mouseover"===t||"mouseout"===t?"mousemove":t,n=i.event;i[o]||(e.bind(o+".jCanvas",function(t){n.x=t.offsetX,n.y=t.offsetY,n.type=o,e.drawLayers(s),t.preventDefault()}),i[o]=s)}}function S(t,e,i){var t=x(t),o=t.event,e=e.isPointInPath(o.x,o.y);i.mouseX=o.x,i.mouseY=o.y,!e&&i._hovered&&!i._fired&&(i._mousedout=s),e&&t.intersects.push(i)}function A(e,i,o){var s,r=/\b(\d*\.?\d*)\w\w\b/gi;I===o.text&&T===o.font?(o.width=G,o.height=L):(o.width=i.measureText(o.text).width,i=e.style.fontSize,(s=o.font.match(r))&&(e.style.fontSize=o.font.match(r)[0]),o.height=n(t.css(e,"fontSize")),e.style.fontSize=i)}var M,V,I,T,G,L,k,F,R=t.extend,P=o.round,N=o.PI,J=o.sin,E=o.cos,j=t.event.fix;L=G=T=I=V=M=void 0;var z,q;t.fn.jCanvas=m,m.version="6.0",m.events={},k={angle:0,align:"center",autosave:s,baseline:"middle",bringToFront:r,ccw:r,closed:r,compositing:"source-over",cornerRadius:0,cropFromCenter:s,draggable:!1,each:a,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:s,height:a,inDegrees:s,load:a,mask:r,method:a,miterLimit:10,opacity:1,projection:0,r1:a,r2:a,radius:0,repeat:"repeat",rotate:0,rounded:r,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:a,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:a,sx:a,sy:a,text:"",translate:0,translateX:0,translateY:0,visible:s,width:a,x:0,y:0},m(),m.extend=function(e){return k=R(k,e.props),m(),e.name&&(t.fn[e.name]=function(t){var i,o,n=R(new c,t);for(i=0;this.length>i;i+=1)t=this[i],(o=h(t))&&(u(o,n),e.fn.call(t,o,n));return this}),t.fn[e.name]},t.fn.getLayers=function(){var t=this[0];return t&&t.getContext?x(t).layers:[]},t.fn.getLayer=function(t){var e,i=this.getLayers();if(!t||!t.layer){if("string"==typeof t)for(e=0;i.length>e;e+=1)if(i[e].name===t){t=e;break}t=i[t||0]}return t},t.fn.setLayer=function(e,i){var o,n;for(e||(i=e,e=0),o=0;this.length>o;o+=1)n=t(this[o]).getLayer(e),R(n,i);return this},t.fn.removeLayer=function(e){var i,o,n,s,r=typeof e;for(i=0;this.length>i;i+=1){if(o=t(this[i]).getLayers(),"string"===r){for(s=0;o.length>s;s+=1)if(o[s].name===e){n=s;break}}else n="number"===r?e:"";o[n]&&o.splice(n,1)}return this},t.fn.removeLayers=function(){var e,i;for(i=0;this.length>i;i+=1)e=t(this[i]).getLayers(),e.length=0;return this},t.fn.getLayerGroup=function(t){var e,i=this.getLayers(),o=[];if(t!==l)for(e=0;i.length>e;e+=1)i[e].group===t&&o.push(i[e]);return o},t.fn.setLayerGroup=function(e,i){var o,n,s;for(o=0;this.length>o;o+=1)for(n=t(this[o]).getLayers(),s=0;n.length>s;s+=1)n[s].group===e&&R(n[s],i);return this},t.fn.removeLayerGroup=function(e){var i,o,n;if(e!==l)for(i=0;this.length>i;i+=1)for(o=t(this[i]).getLayers(),n=0;o.length>n;n+=1)o[n].group===e&&(o.splice(n,1),n-=1);return this},t.fn.drawLayer=function(e){var i,o,n,s;for(i=0;this.length>i;i+=1)n=t(this[i]),o=h(this[i]),s=n.getLayer(e),b(n,o,s);return this},t.fn.drawLayers=function(e){var i,o,n,a,l,c,m;for(o=0;this.length>o;o+=1)if(i=t(this[o]),n=h(this[o])){for(n.clearRect(0,0,this[o].width,this[o].height),M===this[o]?m=V:(m=x(this[o]),M=this[o],V=m),a=m.layers,c=0;a.length>c;c+=1)l=a[c],l.index=c,e&&(l._fired=r),b(i,n,l),l._mousedout&&(l._mousedout=r,l._fired=s,l._hovered=r,l.mouseout&&l.mouseout.call(this[o],l));l=m.intersects[m.intersects.length-1]||{},i=m.event,i=i.type,c=l[i],n=m.drag,l._event&&(!l.mouseover&&!l.mouseout||l._hovered||l._fired||(l._fired=s,l._hovered=s,l.mouseover&&l.mouseover.call(this[o],l)),c&&!l._fired&&(l._fired=s,c.call(this[o],l)),l.draggable&&"mousedown"===i&&(l.bringToFront&&(a.splice(l.index,1),l.index=a.push(l)),n.layer=l,n.dragging=s,n.startX=l.x,n.startY=l.y,n.endX=l.mouseX,n.endY=l.mouseY,l.dragstart&&l.dragstart.call(this[o],l))),n.layer&&(n.dragging&&"mouseup"===i&&(n.layer.dragstop&&n.layer.dragstop.call(this[o],n.layer),m.drag={}),n.dragging&&"mousemove"===i)&&(n.layer.x=n.layer.mouseX-(n.endX-n.startX),n.layer.y=n.layer.mouseY-(n.endY-n.startY),n.layer.drag&&n.layer.drag.call(this[o],n.layer))}return m.intersects=[],this},t.fn.addLayer=function(t){var e,i,t=t||{};for(e=0;this.length>e;e+=1)(i=h(this[e]))&&(t.layer=s,g(this[e],t));return this},z=["width","height","opacity"],q={},t.fn.animateLayer=function(){function e(t,e){return function(){v(e),t.drawLayers(),r[4]&&r[4].call(t[0],e)}}function i(t,e){return function(i,o){v(e),t.drawLayers(),r[5]&&r[5].call(t[0],i,o,e)}}var o,n,s,r=[].slice.call(arguments,0);for("object"==typeof r[0]&&!r[0].layer&&r.unshift(0),"object"==typeof r[2]?(r.splice(2,0,r[2].duration||a),r.splice(3,0,r[3].easing||a),r.splice(4,0,r[4].complete||a),r.splice(5,0,r[5].step||a)):(r[2]===l?(r.splice(2,0,a),r.splice(3,0,a),r.splice(4,0,a)):"function"==typeof r[2]&&(r.splice(2,0,a),r.splice(3,0,a)),r[3]===l?(r[3]=a,r.splice(4,0,a)):"function"==typeof r[3]&&r.splice(3,0,a)),n=0;this.length>n;n+=1)o=t(this[n]),(s=h(this[n]))&&(s=o.getLayer(r[0]))&&s.method!==t.fn.draw&&(w(s),w(r[1]),s.style=q,t(s).animate(r[1],{duration:r[2],easing:t.easing[r[3]]?r[3]:a,complete:e(o,s),step:i(o,s)}));return this},t.fn.animateLayerGroup=function(e){var i,o,n,s,r=[].slice.call(arguments,0);for(o=0;this.length>o;o+=1)for(i=t(this[o]),n=i.getLayerGroup(e),s=0;n.length>s;s+=1)i.animateLayer.apply(i,[n[s]].concat(r.slice(1)))},t.fn.delayLayer=function(e,i){var o,n,i=i||0;for(o=0;this.length>o;o+=1)n=t(this[o]).getLayer(e),t(n).delay(i);return this},t.fn.delayLayerGroup=function(e,i){var o,n,s,r,i=i||0;for(n=0;this.length>n;n+=1)for(o=t(this[n]),s=o.getLayerGroup(e),r=0;s.length>r;r+=1)o.delayLayer.call(o,e,i)},t.fn.stopLayer=function(e,i){var o,n;for(o=0;this.length>o;o+=1)n=t(this[o]).getLayer(e),t(n).stop(i);return this},t.fn.stopLayerGroup=function(e,i){var o,n,s,r;for(n=0;this.length>n;n+=1)for(o=t(this[n]),s=o.getLayerGroup(e),r=0;s.length>r;r+=1)o.stopLayer.call(o,e,i)},function(e){var i;for(i=0;e.length>i;i+=1)t.fx.step[e[i]]=B}("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" ")),D("click"),D("dblclick"),D("mousedown"),D("mouseup"),D("mousemove"),D("mouseover"),D("mouseout"),t.event.fix=function(e){var i,e=j.call(t.event,e);return e.pageX!==l&&e.offsetX===l&&(i=t(e.target).offset())&&(e.offsetX=e.pageX-i.left,e.offsetY=e.pageY-i.top),e},t.fn.draw=function O(t){var e,i,t=t||{};for("function"==typeof t&&(t={fn:t}),e=0;this.length>e;e+=1)(i=h(this[e]))&&t.fn&&(g(this[e],t,O),t.fn.call(this[e],i));return this},t.fn.clearCanvas=function(t){for(var e,i=R(new c,t),t=0;this.length>t;t+=1)(e=h(this[t]))&&(d(t,e,i,i.width,i.height),i.x&&i.y&&i.width&&i.height?e.clearRect(i.x-i.width/2,i.y-i.height/2,i.width,i.height):e.clearRect(0,0,this[t].width,this[t].height));return this},t.fn.saveCanvas=function(){var t,e;for(t=0;this.length>t;t+=1)(e=h(this[t]))&&e.save();return this},t.fn.restoreCanvas=function(){var t,e;for(t=0;this.length>t;t+=1)(e=h(this[t]))&&e.restore();return this},t.fn.translateCanvas=function(t){for(var e,i=R(new c,t),t=0;this.length>t;t+=1)(e=h(this[t]))&&(i.autosave&&e.save(),_(e,i));return this},t.fn.scaleCanvas=function(t){for(var e,i=R(new c,t),t=0;this.length>t;t+=1)(e=h(this[t]))&&(i.autosave&&e.save(),y(e,i));return this},t.fn.rotateCanvas=function(t){for(var e,i=R(new c,t),t=0;this.length>t;t+=1)(e=h(this[t]))&&(i.autosave&&e.save(),f(e,i));return this},t.fn.drawRect=function W(t){var e,i,o,n,a,l,m,_=R(new c,t);for(e=0;this.length>e;e+=1)(i=h(this[e]))&&(g(this[e],t,W),u(i,_),d(e,i,_,_.width,_.height),i.beginPath(),o=_.x-_.width/2,n=_.y-_.height/2,(m=_.cornerRadius)?(_.closed=s,a=_.x+_.width/2,l=_.y+_.height/2,0>a-o-2*m&&(m=(a-o)/2),0>l-n-2*m&&(m=(l-n)/2),i.moveTo(o+m,n),i.lineTo(a-m,n),i.arc(a-m,n+m,m,3*N/2,2*N,r),i.lineTo(a,l-m),i.arc(a-m,l-m,m,0,N/2,r),i.lineTo(o+m,l),i.arc(o+m,l-m,m,N/2,N,r),i.lineTo(o,n+m),i.arc(o+m,n+m,m,N,3*N/2,r)):i.rect(o,n,_.width,_.height),_._event&&S(this[e],i,t),p(i,_));return this},t.fn.drawArc=function H(t){var e,i,o=R(new c,t),t=t||{};for(!o.inDegrees&&360===o.end&&(t.end=o.end=2*N),e=0;this.length>e;e+=1)(i=h(this[e]))&&(g(this[e],t,H),u(i,o),d(e,i,o,2*o.radius),i.beginPath(),i.arc(o.x,o.y,o.radius,o.start*o._toRad-N/2,o.end*o._toRad-N/2,o.ccw),o._event&&S(this[e],i,t),p(i,o));return this},t.fn.drawEllipse=function U(t){var e,i,o=R(new c,t),n=4*o.width/3,r=o.height;for(o.closed=s,e=0;this.length>e;e+=1)(i=h(this[e]))&&(g(this[e],t,U),u(i,o),d(e,i,o,o.width,o.height),i.beginPath(),i.moveTo(o.x,o.y-r/2),i.bezierCurveTo(o.x-n/2,o.y-r/2,o.x-n/2,o.y+r/2,o.x,o.y+r/2),i.bezierCurveTo(o.x+n/2,o.y+r/2,o.x+n/2,o.y-r/2,o.x,o.y-r/2),o._event&&S(this[e],i,t),p(i,o));return this},t.fn.drawPolygon=function X(t){var e,i,o,n,r,a=R(new c,t),l=2*N/a.sides,m=N/a.sides,_=m+N/2,y=a.radius*E(l/2);for(a.closed=s,e=0;this.length>e;e+=1)if(i=h(this[e])){for(g(this[e],t,X),u(i,a),d(e,i,a,2*a.radius),i.beginPath(),r=0;a.sides>r;r+=1)o=a.x+P(a.radius*E(_)),n=a.y+P(a.radius*J(_)),i.lineTo(o,n),a.projection&&(o=a.x+P((y+y*a.projection)*E(_+m)),n=a.y+P((y+y*a.projection)*J(_+m)),i.lineTo(o,n)),_+=l;a._event&&S(this[e],i,t),p(i,a)}return this},t.fn.drawLine=function K(t){var e,i,o,n,r,a=R(new c,t);for(e=0;this.length>e;e+=1)if(i=h(this[e])){for(g(this[e],t,K),u(i,a),d(e,i,a,0),o=1,i.beginPath();s&&(n=a["x"+o],r=a["y"+o],n!==l&&r!==l);)i.lineTo(n,r),o+=1;a._event&&S(this[e],i,t),p(i,a)}return this},t.fn.drawQuad=function $(t){var e,i,o,n,r,a,m,_=R(new c,t);for(e=0;this.length>e;e+=1)if(i=h(this[e])){for(g(this[e],t,$),u(i,_),d(e,i,_,0),o=2,i.beginPath(),i.moveTo(_.x1,_.y1);s&&(n=_["x"+o],r=_["y"+o],a=_["cx"+(o-1)],m=_["cy"+(o-1)],n!==l&&r!==l&&a!==l&&m!==l);)i.quadraticCurveTo(a,m,n,r),o+=1;_._event&&S(this[e],i,t),p(i,_)}return this},t.fn.drawBezier=function Y(t){var e,i,o,n,r,a,m,_,y,f,x=R(new c,t);for(e=0;this.length>e;e+=1)if(i=h(this[e])){for(g(this[e],t,Y),u(i,x),d(e,i,x,0),o=2,n=1,i.beginPath(),i.moveTo(x.x1,x.y1);s&&(r=x["x"+o],a=x["y"+o],m=x["cx"+n],_=x["cy"+n],y=x["cx"+(n+1)],f=x["cy"+(n+1)],r!==l&&a!==l&&m!==l&&_!==l&&y!==l&&f!==l);)i.bezierCurveTo(m,_,y,f,r,a),o+=1,n+=2;x._event&&S(this[e],i,t),p(i,x)}return this},t.fn.drawText=function Z(e){var i,o,n=R(new c,e);for(i=0;this.length>i;i+=1)t(this[i]),(o=h(this[i]))&&(g(this[i],e,Z),u(o,n),o.textBaseline=n.baseline,o.textAlign=n.align,o.font=n.font,A(this[i],o,n),d(i,o,n,n.width,n.height),o.fillText(n.text,n.x,n.y),"transparent"!==n.fillStyle&&(o.shadowColor="transparent"),o.strokeText(n.text,n.x,n.y),n._event?(o.beginPath(),o.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),o.restore(),S(this[i],o,e),o.closePath()):o.restore());return I=n.text,T=n.font,G=n.width,L=n.height,this},t.fn.measureText=function(t){var e;return e=t&&"object"!=typeof t?this.getLayer(t):R(new c,t),(t=h(this[0]))&&A(this[0],t,e),e},t.fn.drawImage=function Q(t){function e(e,i,o){return function(){i||(m=r.width/r.height,_.width===a&&_.sWidth===a&&(t.width=_.width=_.sWidth=r.width),_.height===a&&_.sHeight===a&&(t.height=_.height=_.sHeight=r.height),_.width===a&&_.sWidth!==a&&(_.width=_.sWidth),_.height===a&&_.sHeight!==a&&(_.height=_.sHeight),_.sWidth===a&&_.width!==a&&(t.sWidth=_.sWidth=r.width),_.sHeight===a&&_.height!==a&&(t.sHeight=_.sHeight=r.height),_.sx===a&&(_.sx=_.cropFromCenter?r.width/2:0),_.sy===a&&(_.sy=_.cropFromCenter?r.height/2:0),_.cropFromCenter||(_.sx+=_.sWidth/2,_.sy+=_.sHeight/2),_.sx+_.sWidth/2>r.width&&(_.sx=r.width-_.sWidth/2),0>_.sx-_.sWidth/2&&(_.sx=_.sWidth/2),0>_.sy-_.sHeight/2&&(_.sy=_.sHeight/2),_.sy+_.sHeight/2>r.height&&(_.sy=r.height-_.sHeight/2),_.width!==a&&_.height===a?t.height=_.height=_.width/m:_.width===a&&_.height!==a?t.width=_.width=_.height*m:_.width===a&&_.height===a&&(t.width=_.width=r.width,t.height=_.height=r.height)),d(i,o,_,_.width,_.height),o.drawImage(r,_.sx-_.sWidth/2,_.sy-_.sHeight/2,_.sWidth,_.sHeight,_.x-_.width/2,_.y-_.height/2,_.width,_.height),_._event?(o.beginPath(),o.rect(_.x-_.width/2,_.y-_.height/2,_.width,_.height),o.restore(),S(p[i],o,t),o.closePath()):o.restore(),_.load&&_.load.call(e,t)}}var o,n,s,r,l,m,p=this,_=R(new c,t);for(l=_.source.getContext,_.source.src||l?(r=_.source,_.width=r.width,_.height=r.height):_.source&&(r=new i,r.src=_.source),n=0;p.length>n;n+=1)o=p[n],(s=h(p[n]))&&(g(p[n],t,Q),u(s,_),r&&(r.complete||l?e(o,n,s)():r.onload=e(o,n,s)));return p},t.fn.createPattern=t.fn.pattern=function(t){function o(){r=n.createPattern(s,m.repeat),m.load&&m.load.call(l[0],r)}var n,s,r,l=this,m=R(new c,t);return(n=h(l[0]))?"function"==typeof m.source?(s=e.createElement("canvas"),s.width=m.width,s.height=m.height,t=h(s),m.source.call(s,t),o()):(t=m.source.getContext,m.source.src||t?s=m.source:(s=new i,s.src=m.source),s.complete||t?o():s.onload=o):r=a,r},t.fn.createGradient=t.fn.gradient=function(t){var e,i,o,n,s,r,m,u,t=R(new c,t),p=[];if(e=h(this[0])){for(t.x1=t.x1||0,t.y1=t.y1||0,t.x2=t.x2||0,t.y2=t.y2||0,e=t.r1!==a||t.r2!==a?e.createRadialGradient(t.x1,t.y1,t.r1,t.x2,t.y2,t.r2):e.createLinearGradient(t.x1,t.y1,t.x2,t.y2),s=1;t["c"+s]!==l;s+=1)t["s"+s]!==l?p.push(t["s"+s]):p.push(a);for(i=p.length,p[0]===a&&(p[0]=0),p[i-1]===a&&(p[i-1]=1),s=0;i>s;s+=1){if(p[s]!==a){for(m=1,u=0,o=p[s],r=s+1;i>r;r+=1){if(p[r]!==a){n=p[r];break}m+=1}o>n&&(p[r]=p[s])}else p[s]===a&&(u+=1,p[s]=o+u*((n-o)/m));e.addColorStop(p[s],t["c"+(s+1)])}}else e=a;return e},t.fn.setPixels=function te(t){var e,i,o,n,s,r,a,l=R(new c,t),m={};for(i=0;this.length>i;i+=1)if(e=this[i],o=h(e)){if(g(this[i],t,te),d(i,o,l,l.width,l.height),l.x&&l.y&&l.width&&l.height||(l.width=e.width,l.height=e.height,l.x=l.width/2,l.y=l.height/2),n=o.getImageData(l.x-l.width/2,l.y-l.height/2,l.width,l.height),s=n.data,a=s.length,m=[],l.each)for(r=0;a>r;r+=4)m.r=s[r],m.g=s[r+1],m.b=s[r+2],m.a=s[r+3],l.each.call(e,m),s[r]=m.r,s[r+1]=m.g,s[r+2]=m.b,s[r+3]=m.a;o.putImageData(n,l.x-l.width/2,l.y-l.height/2),o.restore()}return this},t.fn.getCanvasImage=function(t,e){var i=this[0];return i&&i.toDataURL?i.toDataURL("image/"+t,e):a},t.support.canvas=e.createElement("canvas").getContext!==l,m.defaults=k,t.jCanvas=m}(jQuery,document,Image,Math,parseFloat,!0,!1,null),String.prototype.getBytes=function(){for(var t=[],e=0;this.length>e;e++){var i=this.charCodeAt(e),o=[];do o.push(255&i),i>>=8;while(i>0);t=t.concat(o.reverse())}return t},RC4.prototype._swap=function(t,e){var i=this.s[t];this.s[t]=this.s[e],this.s[e]=i},RC4.prototype.mix=function(t){for(var e=t.getBytes(),i=0,o=0;this.s.length>o;o++)i+=this.s[o]+e[o%e.length],i%=256,this._swap(o,i)},RC4.prototype.next=function(){return this.i=(this.i+1)%256,this.j=(this.j+this.s[this.i])%256,this._swap(this.i,this.j),this.s[(this.s[this.i]+this.s[this.j])%256]},RNG.prototype.nextByte=function(){return this._state.next()},RNG.prototype.uniform=function(){for(var t=7,e=0,i=0;t>i;i++)e*=256,e+=this.nextByte();return e/(Math.pow(2,8*t)-1)},RNG.prototype.random=function(t,e){return null==t?this.uniform():(null==e&&(e=t,t=0),t+Math.floor(this.uniform()*(e-t)))},RNG.prototype.normal=function(){if(null!==this._normal){var t=this._normal;return this._normal=null,t}var e=this.uniform()||Math.pow(2,-53),i=this.uniform();return this._normal=Math.sqrt(-2*Math.log(e))*Math.sin(2*Math.PI*i),Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*i)},RNG.prototype.exponential=function(){return-Math.log(this.uniform()||Math.pow(2,-53))},RNG.prototype.poisson=function(t){var e=Math.exp(-(t||1)),i=0,o=1;do i++,o*=this.uniform();while(o>e);return i-1},RNG.prototype.gamma=function(t){var e=(1>t?1+t:t)-1/3,i=1/Math.sqrt(9*e);do{do var o=this.normal(),n=Math.pow(i*o+1,3);while(0>=n);var s=this.uniform(),r=Math.pow(o,2)}while(s>=1-.0331*r*r&&Math.log(s)>=.5*r+e*(1-n+Math.log(n)));return 1>t?e*n*Math.exp(this.exponential()/-t):e*n},RNG.roller=function(t,e){var i=t.split(/(\d+)?d(\d+)([+-]\d+)?/).slice(1),o=parseFloat(i[0])||1,n=parseFloat(i[1]),s=parseFloat(i[2])||0;return e=e||new RNG,function(){for(var t=o+s,i=0;o>i;i++)t+=e.random(n);return t}},RNG.$=new RNG;var drawutils=function(){var t=null,e=null,i=function(e,i,o,n){t.strokeStyle=n,t.beginPath(),t.arc(e,i,o,0,2*Math.PI),t.stroke()},o=function(e,i,o,n,s,r){t.strokeStyle=r,t.fillStyle=s,t.beginPath(),t.arc(e,i,n,0,2*Math.PI),t.fill(),t.stroke()},n=function(t,i,o,n,s){e.drawRect({fillStyle:s,x:t,y:i,width:o,height:n,cornerRadius:0})},s=function(t,i,o,n,s){e.drawRect({strokeStyle:s,x:t,y:i,width:o,height:n,cornerRadius:0})},r=function(){t=$("#canvas")[0].getContext("2d"),e=$("#canvas")},a=function(){e.clearCanvas()};return{drawCircle:i,drawRect:n,drawEmptyRect:s,drawRobot:o,clearCanvas:a,init:r}}(),mathutils=function(){var t=function(t,e,i,o){var n=t-i,s=e-o;return Math.sqrt(n*n+s*s)};return{lineDistance:t}}();window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();var phys={vec2:Box2D.Common.Math.b2Vec2,AABB:Box2D.Collision.b2AABB,bodyDef:Box2D.Dynamics.b2BodyDef,body:Box2D.Dynamics.b2Body,fixtureDef:Box2D.Dynamics.b2FixtureDef,world:Box2D.Dynamics.b2World,massData:Box2D.Collision.Shapes.b2MassData,polyShape:Box2D.Collision.Shapes.b2PolygonShape,circleShape:Box2D.Collision.Shapes.b2CircleShape,mouseJointDef:Box2D.Dynamics.Joints.b2MouseJointDef},baseTask={taskName:"base task",setupTask:function(){},setupController:function(){},evaluateCompletion:function(){return!1},draw:function(){},update:function(){},_runtime:0,_startTime:null,init:function(t){this._options=t,drawutils.init(),this.setupTask(this._options),this.setupController(this._options),this._startTime=new Date,this._runtime=0,requestAnimFrame(this._update)},_update:function(){return this.update(this._options),this.draw(this._options),this.evaluateCompletion(this._options)?(alert("Task complete. Time to finish was "+this._runtime+" seconds."),$.ajax({type:"POST",url:"/result",dataType:"json",async:!1,data:{task:this.taskName,runtime:this._runtime,participant:"web"}}),void 0):(requestAnimFrame(this._update),this._runtime=((new Date).getTime()-this._startTime)/1e3,void 0)}},app=function(){var t=[],e=function(e){t.push(e)},i=function(e){return(task=_.find(t,function(t){return t.taskName===e}))?(task.init(),void 0):(alert("Unable to find task "+e),void 0)};return{init:i,registerTask:e}}(),mazePositioningTask=_.extend({},baseTask,{taskName:"maze_positioning",_numrobots:8,_robots:[],_blocks:[],_goals:[],_impulse:1,_impulseV:new phys.vec2(0,0),_world:new phys.world(new phys.vec2(0,0),!0),_zeroReferencePoint:new phys.vec2(0,0),_myGoalsX:[8,7,9],_myGoalsY:[6,7,7],setupTask:function(){var t=new phys.fixtureDef;t.density=1,t.friction=.5,t.restitution=.2;var e=new phys.bodyDef;e.userData="obstacle",e.type=phys.body.b2_staticBody,t.shape=new phys.polyShape,t.shape.SetAsBox(20,.22),e.position.Set(10,20),this._world.CreateBody(e).CreateFixture(t),e.position.Set(10,0),this._world.CreateBody(e).CreateFixture(t),e.position.Set(25,6.66),this._world.CreateBody(e).CreateFixture(t),e.position.Set(-5,13.33),this._world.CreateBody(e).CreateFixture(t),t.shape.SetAsBox(.2,14),e.position.Set(0,13),this._world.CreateBody(e).CreateFixture(t),e.position.Set(20,13),this._world.CreateBody(e).CreateFixture(t),e.type=phys.body.b2_dynamicBody,e.userData="workpiece",e.position.Set(10,16.5),t.shape.SetAsBox(.5,.5),this._blocks.push(this._world.CreateBody(e)),this._blocks[0].CreateFixture(t),this._goals.push({x:16,y:3.5,w:5,h:5});var i=2,o=16;this._robots=[],e.type=phys.body.b2_dynamicBody,e.userData="robot",t.density=1,t.friction=.5,t.restitution=.2,t.shape=new phys.circleShape(.5);for(var n=0;this._numrobots>n;++n)e.position.x=n%4+i,e.position.y=Math.floor(n/4)+o,this._robots[n]=this._world.CreateBody(e),this._robots[n].CreateFixture(t),this._robots[n].m_angularDamping=1,this._robots[n].m_linearDamping=1},setupController:function(){var t=this;document.addEventListener("keydown",function(e){switch(e.keyCode){case 37:t._impulseV.x=-t._impulse;break;case 39:t._impulseV.x=t._impulse;break;case 38:t._impulseV.y=-t._impulse;break;case 40:t._impulseV.y=t._impulse;break;case 65:t._impulseV.x=-t._impulse;break;case 68:t._impulseV.x=t._impulse;break;case 87:t._impulseV.y=-t._impulse;break;case 83:t._impulseV.y=t._impulse}},!1),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:t._impulseV.x=0;break;case 39:t._impulseV.x=0;break;case 38:t._impulseV.y=0;break;case 40:t._impulseV.y=0;break;case 65:t._impulseV.x=0;break;case 68:t._impulseV.x=0;break;case 87:t._impulseV.y=0;break;case 83:t._impulseV.y=0}},!1)},evaluateCompletion:function(){return!1},draw:function(){drawutils.clearCanvas();var t=this;for(_.each(t._goals,function(t){drawutils.drawEmptyRect(30*t.x,30*t.y,30*t.w,30*t.h,"green")}),b=this._world.GetBodyList();b;b=b.GetNext()){var e=b.GetAngle()*(180/Math.PI);for(f=b.GetFixtureList();f;f=f.GetNext())if("robot"==b.GetUserData()){var i=f.GetShape().GetRadius(),o=b.GetPosition();drawutils.drawRobot(30*o.x,30*o.y,e,30*i,"blue","blue")}else if("workpiece"==b.GetUserData()){var n=f.GetShape().GetVertices()[1].x-f.GetShape().GetVertices()[0].x,s=f.GetShape().GetVertices()[2].y-f.GetShape().GetVertices()[1].y,o=b.GetPosition(),r="green";drawutils.drawRect(30*o.x,30*o.y,30*n,30*s,r)}else{var n=f.GetShape().GetVertices()[1].x-f.GetShape().GetVertices()[0].x,s=f.GetShape().GetVertices()[2].y-f.GetShape().GetVertices()[1].y,o=b.GetPosition(),r="orange";"obstacle"==b.GetUserData()&&(r="red"),drawutils.drawRect(30*o.x,30*o.y,30*n,30*s,r)}}string="Time = "+this._runtime,$("#cc").html(string)},update:function(){var t=this;_.each(t._robots,function(e){e.ApplyForce(t._impulseV,e.GetWorldPoint(t._zeroReferencePoint))}),this._world.Step(1/60,10,10),this._world.ClearForces()}});for(var m in mazePositioningTask)"function"==typeof mazePositioningTask[m]&&(mazePositioningTask[m]=_.bind(mazePositioningTask[m],mazePositioningTask));app.registerTask(mazePositioningTask);var pyramidBuildingTask=_.extend({},baseTask,{taskName:"pyramid_building",_numrobots:8,_robots:[],_blocks:[],_goals:[],_impulse:1,_impulseV:new phys.vec2(0,0),_world:new phys.world(new phys.vec2(0,0),!0),_zeroReferencePoint:new phys.vec2(0,0),setupTask:function(){var t=new phys.fixtureDef;t.density=1,t.friction=.5,t.restitution=.2;var e=new phys.bodyDef;e.userData="obstacle",e.type=phys.body.b2_staticBody,t.shape=new phys.polyShape,t.shape.SetAsBox(20,.22),e.position.Set(10,20),this._world.CreateBody(e).CreateFixture(t),e.position.Set(10,0),this._world.CreateBody(e).CreateFixture(t),t.shape.SetAsBox(4,.2),e.position.Set(10,10),this._world.CreateBody(e).CreateFixture(t),t.shape.SetAsBox(.2,14),e.position.Set(0,13),this._world.CreateBody(e).CreateFixture(t),e.position.Set(20,13),this._world.CreateBody(e).CreateFixture(t),this._blocks=[],e.type=phys.body.b2_dynamicBody,e.userData="workpiece",t.shape=new phys.polyShape,t.shape.SetAsBox(.5,.5),t.density=1,t.friction=.5,t.restitution=.2;for(var i=0;6>i;++i)e.position.x=4.5+2*i,e.position.y=15,this._blocks[i]=this._world.CreateBody(e),this._blocks[i].CreateFixture(t),this._blocks[i].m_angularDamping=1,this._blocks[i].m_linearDamping=1;var o=8,n=4;this._robots=[],e.type=phys.body.b2_dynamicBody,e.userData="robot",t.density=1,t.friction=.5,t.restitution=.2,t.shape=new phys.circleShape(.5);for(var i=0;this._numrobots>i;++i)e.position.x=1.2*(i%4)+o,e.position.y=1.2*Math.floor(i/4)+n,this._robots[i]=this._world.CreateBody(e),this._robots[i].CreateFixture(t),this._robots[i].m_angularDamping=1,this._robots[i].m_linearDamping=1;this._goals.push({x:10,y:7.2,w:.6,h:.6}),this._goals.push({x:9.5,y:8.2,w:.6,h:.6}),this._goals.push({x:10.5,y:8.2,w:.6,h:.6}),this._goals.push({x:9,y:9.2,w:.6,h:.6}),this._goals.push({x:10,y:9.2,w:.6,h:.6}),this._goals.push({x:11,y:9.2,w:.6,h:.6})},setupController:function(){var t=this;document.addEventListener("keydown",function(e){switch(e.keyCode){case 37:t._impulseV.x=-t._impulse;break;case 39:t._impulseV.x=t._impulse;break;case 38:t._impulseV.y=-t._impulse;break;case 40:t._impulseV.y=t._impulse;break;case 65:t._impulseV.x=-t._impulse;break;case 68:t._impulseV.x=t._impulse;break;case 87:t._impulseV.y=-t._impulse;break;case 83:t._impulseV.y=t._impulse}},!1),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:t._impulseV.x=0;break;case 39:t._impulseV.x=0;break;case 38:t._impulseV.y=0;break;case 40:t._impulseV.y=0;break;case 65:t._impulseV.x=0;break;case 68:t._impulseV.x=0;break;case 87:t._impulseV.y=0;break;case 83:t._impulseV.y=0}},!1)},evaluateCompletion:function(){return!1},draw:function(){drawutils.clearCanvas();var t=this;for(_.each(t._goals,function(t){drawutils.drawEmptyRect(30*t.x,30*t.y,30*t.w,30*t.h,"green")}),b=this._world.GetBodyList();b;b=b.GetNext()){var e=b.GetAngle()*(180/Math.PI);for(f=b.GetFixtureList();f;f=f.GetNext())if("robot"==b.GetUserData()){var i=f.GetShape().GetRadius(),o=b.GetPosition();drawutils.drawRobot(30*o.x,30*o.y,e,30*i,"blue","blue")}else if("workpiece"==b.GetUserData()){var n=f.GetShape().GetVertices()[1].x-f.GetShape().GetVertices()[0].x,s=f.GetShape().GetVertices()[2].y-f.GetShape().GetVertices()[1].y,o=b.GetPosition(),r="green";drawutils.drawRect(30*o.x,30*o.y,30*n,30*s,r)}else{var n=f.GetShape().GetVertices()[1].x-f.GetShape().GetVertices()[0].x,s=f.GetShape().GetVertices()[2].y-f.GetShape().GetVertices()[1].y,o=b.GetPosition(),r="orange";"obstacle"==b.GetUserData()&&(r="red"),drawutils.drawRect(30*o.x,30*o.y,30*n,30*s,r)}}string="Time = "+this._runtime,$("#cc").html(string)},update:function(){var t=this;_.each(t._robots,function(e){e.ApplyForce(t._impulseV,e.GetWorldPoint(t._zeroReferencePoint))}),this._world.Step(1/60,10,10),this._world.ClearForces()}});for(var m in pyramidBuildingTask)"function"==typeof pyramidBuildingTask[m]&&(pyramidBuildingTask[m]=_.bind(pyramidBuildingTask[m],pyramidBuildingTask));app.registerTask(pyramidBuildingTask);var positionRobotsTask=_.extend({},baseTask,{taskName:"robot_positioning",_numrobots:8,_robots:[],_impulse:1,_impulseV:new phys.vec2(0,0),_world:new phys.world(new phys.vec2(0,0),!0),_zeroReferencePoint:new phys.vec2(0,0),_myGoalsX:[8,7,9],_myGoalsY:[6,7,7],setupTask:function(){var t=new phys.fixtureDef;t.density=1,t.friction=.5,t.restitution=.2;var e=new phys.bodyDef;e.userData="obstacle",e.type=phys.body.b2_staticBody,t.shape=new phys.polyShape,t.shape.SetAsBox(20,2),e.position.Set(10,21.8),this._world.CreateBody(e).CreateFixture(t),e.position.Set(10,-1.8),this._world.CreateBody(e).CreateFixture(t),t.shape.SetAsBox(2,14),e.position.Set(-1.8,13),this._world.CreateBody(e).CreateFixture(t),e.position.Set(21.8,13),this._world.CreateBody(e).CreateFixture(t),e.position.Set(10,10),t.shape.SetAsBox(.5,.5),this._world.CreateBody(e).CreateFixture(t),this._robots=[],e.type=phys.body.b2_dynamicBody,e.userData="robot",t.density=1,t.friction=.5,t.restitution=.2,t.shape=new phys.circleShape(.5);for(var i=0;this._numrobots>i;++i)e.position.x=10*Math.random(),e.position.y=10*Math.random(),this._robots[i]=this._world.CreateBody(e),this._robots[i].CreateFixture(t),this._robots[i].m_angularDamping=1,this._robots[i].m_linearDamping=1},setupController:function(){var t=this;document.addEventListener("keydown",function(e){switch(e.keyCode){case 37:t._impulseV.x=-t._impulse;break;case 39:t._impulseV.x=t._impulse;break;case 38:t._impulseV.y=-t._impulse;break;case 40:t._impulseV.y=t._impulse;break;case 65:t._impulseV.x=-t._impulse;break;case 68:t._impulseV.x=t._impulse;break;case 87:t._impulseV.y=-t._impulse;break;case 83:t._impulseV.y=t._impulse}},!1),document.addEventListener("keyup",function(e){switch(e.keyCode){case 37:t._impulseV.x=0;break;case 39:t._impulseV.x=0;break;case 38:t._impulseV.y=0;break;case 40:t._impulseV.y=0;break;case 65:t._impulseV.x=0;break;case 68:t._impulseV.x=0;break;case 87:t._impulseV.y=0;break;case 83:t._impulseV.y=0}},!1)},evaluateCompletion:function(){var t=this._countRobots(),e=this._myGoalsX.length;return t==e},draw:function(){drawutils.clearCanvas();for(var t,e=this,i=0,o=0;this._myGoalsX.length>o;o++)t="rgb(0, 255, 0)",_.each(e._robots,function(n){var s=n.GetPosition();.5>mathutils.lineDistance(e._myGoalsX[o],e._myGoalsY[o],s.x,s.y)&&(t="rgb(255, 0, 0)",i++)}),drawutils.drawCircle(30*this._myGoalsX[o],30*this._myGoalsY[o],15,t);for(b=this._world.GetBodyList();b;b=b.GetNext()){var n=b.GetAngle()*(180/Math.PI);for(f=b.GetFixtureList();f;f=f.GetNext())if("robot"==b.GetUserData()){var s=f.GetShape().GetRadius(),r=b.GetPosition();drawutils.drawRobot(30*r.x,30*r.y,n,30*s,"blue","blue")}else{var a=f.GetShape().GetVertices()[1].x-f.GetShape().GetVertices()[0].x,l=f.GetShape().GetVertices()[2].y-f.GetShape().GetVertices()[1].y,r=b.GetPosition(),c="orange";"obstacle"==b.GetUserData()&&(c="red"),drawutils.drawRect(30*r.x,30*r.y,30*a,30*l,c)}}string="Time = "+this._runtime,$("#cc").html(string)},update:function(){var t=this;_.each(t._robots,function(e){e.ApplyForce(t._impulseV,e.GetWorldPoint(t._zeroReferencePoint))}),this._world.Step(1/60,10,10),this._world.ClearForces()},_countRobots:function(){for(var t=0,e=this,i=0;this._myGoalsX.length>i;i++)_.each(e._robots,function(o){var n=o.GetPosition();.5>mathutils.lineDistance(e._myGoalsX[i],e._myGoalsY[i],n.x,n.y)&&t++});return t}});for(var m in positionRobotsTask)"function"==typeof positionRobotsTask[m]&&(positionRobotsTask[m]=_.bind(positionRobotsTask[m],positionRobotsTask));app.registerTask(positionRobotsTask);